\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{formulabox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ§® #1 (ìˆ˜í•™ì  ì›ë¦¬)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Sequence Models: \\ Attention Mechanism}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-9.] Deep Learning Fundamentals \& CNNs \textit{- Completed}
    \item[\textbf{Chapter 10.}] \textbf{Sequence Models (Current Part)}
    \begin{itemize}
        \item 10.1-10.10 RNN, LSTM, Word2Vec, BLEU \textit{- Completed}
        \item \textbf{10.11 Attention Mechanism}
        \begin{itemize}
            \item The Bottleneck Problem in Seq2Seq
            \item Dynamic Context Vector ($c^{\langle t \rangle}$)
            \item Alignment Scores \& Attention Weights ($\alpha$)
            \item Implementation: Bahdanau Attention
        \end{itemize}
    \end{itemize}
    \item[Chapter 11.] Transformer Network \textit{- Next Part}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ì— ë°°ìš´ Seq2Seq ëª¨ë¸ì€ í˜ì‹ ì ì´ì—ˆì§€ë§Œ, ë¬¸ì¥ì´ ê¸¸ì–´ì§€ë©´ ì„±ëŠ¥ì´ ê¸‰ê²©íˆ ë–¨ì–´ì§€ëŠ” \textbf{'ë³‘ëª©(Bottleneck)'} í˜„ìƒì„ ê²ªì—ˆìŠµë‹ˆë‹¤. ì¸ì½”ë”ê°€ 100ë‹¨ì–´ì§œë¦¬ ê¸´ ë¬¸ì¥ì„ ê³ ì •ëœ í¬ê¸°ì˜ ë²¡í„° í•˜ë‚˜ì— ì–µì§€ë¡œ ì••ì¶•í•´ì•¼ í–ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ìƒê°í•´ ë´…ì‹œë‹¤. ì—¬ëŸ¬ë¶„ì´ ê¸´ ë¬¸ì¥ì„ ë²ˆì—­í•  ë•Œ, ë¬¸ì¥ ì „ì²´ë¥¼ í•œ ë²ˆ ì½ê³  ì™¸ìš´ ë‹¤ìŒ ëˆˆì„ ê°ê³  ë²ˆì—­í•©ë‹ˆê¹Œ? ì•„ë‹™ë‹ˆë‹¤. \textbf{"ì§€ê¸ˆ ë²ˆì—­í•˜ë ¤ëŠ” ë‹¨ì–´ì™€ ê´€ë ¨ëœ ì›ë¬¸ ë¶€ë¶„ì„ ê·¸ë•Œê·¸ë•Œ ë‹¤ì‹œ ì³ë‹¤ë³´ë©´ì„œ(Attend)"} ë²ˆì—­í•©ë‹ˆë‹¤. ì´ ê³¼ì •ì„ êµ¬í˜„í•œ ê²ƒì´ ë°”ë¡œ \textbf{ì–´í…ì…˜(Attention)}ì…ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ ê¸´ ì‹œí€€ìŠ¤ ì •ë³´ ì†ì‹¤ì„ í•´ê²°í•˜ê³  ì„±ëŠ¥ì„ ê·¹ëŒ€í™”í•˜ëŠ” ì–´í…ì…˜ ë©”ì»¤ë‹ˆì¦˜ì„ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ë™ì  ë¬¸ë§¥:} ë§¤ íƒ€ì„ ìŠ¤í…ë§ˆë‹¤ ë‹¤ë¥´ê²Œ ê³„ì‚°ë˜ëŠ” \textbf{ë¬¸ë§¥ ë²¡í„° $c^{\langle t \rangle}$}ì˜ ê°œë…ì„ ì´í•´í•©ë‹ˆë‹¤.
    \item \textbf{ê°€ì¤‘ì¹˜:} ì¸ì½”ë”ì˜ íŠ¹ì • ë‹¨ì–´ì— ì–¼ë§ˆë‚˜ ì§‘ì¤‘í• ì§€ ë‚˜íƒ€ë‚´ëŠ” \textbf{ì–´í…ì…˜ ê°€ì¤‘ì¹˜($\alpha$)}ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
    \item \textbf{êµ¬ì¡°:} ì¸ì½”ë”ì˜ ëª¨ë“  ì€ë‹‰ ìƒíƒœë¥¼ ê°€ì¤‘ í•©(Weighted Sum)í•˜ì—¬ ì •ë³´ë¥¼ ì·¨í•©í•˜ëŠ” ì›ë¦¬ë¥¼ ë°°ì›ë‹ˆë‹¤.
    \item \textbf{í•™ìŠµ:} ê°€ì¤‘ì¹˜ë¥¼ ê²°ì •í•˜ëŠ” ì •ë ¬ ëª¨ë¸(Alignment Model)ë„ ì—­ì „íŒŒë¡œ í•¨ê»˜ í•™ìŠµë¨ì„ íŒŒì•…í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ì˜ë¯¸} & \textbf{ë¹„ìœ } \\ \hline
\textbf{Attention Weight} & $\alpha^{\langle t, t' \rangle}$: $t$ë²ˆì§¸ ì¶œë ¥ ì‹œ $t'$ë²ˆì§¸ ì…ë ¥ì˜ ì¤‘ìš”ë„. & ë‹ë³´ê¸°ë¡œ ë¹„ì¶”ëŠ” ë¹›ì˜ ì„¸ê¸°. \\ \hline
\textbf{Context Vector} & $c^{\langle t \rangle}$: ì¸ì½”ë” ìƒíƒœë“¤ì˜ ê°€ì¤‘ í‰ê· . & ë²ˆì—­ ì¤‘ì¸ ë‹¨ì–´ì˜ ì—°ê´€ ì°¸ê³  ìë£Œ. \\ \hline
\textbf{Alignment Score} & ë‹¨ì–´ ê°„ì˜ ìœ ì‚¬ë„/ê´€ë ¨ì„± ì ìˆ˜. & ë‘ ë‹¨ì–´ê°€ ì–¼ë§ˆë‚˜ 'ì°°ë–¡ê¶í•©'ì¸ê°€. \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: í•„ìš”í•œ ê³³ë§Œ ì³ë‹¤ë³´ê¸°}

\subsection{1. The Intuition (ì§ê´€)}


ê¸°ì¡´ Seq2SeqëŠ” ì¸ì½”ë”ì˜ \textbf{ë§ˆì§€ë§‰ ì •ë³´} í•˜ë‚˜ë§Œ ë””ì½”ë”ì—ê²Œ ë˜ì ¸ì¤ë‹ˆë‹¤. ë°˜ë©´, ì–´í…ì…˜ ëª¨ë¸ì€ ë””ì½”ë”ê°€ ë‹¨ì–´ë¥¼ ìƒì„±í•  ë•Œë§ˆë‹¤ ì¸ì½”ë”ì˜ \textbf{ëª¨ë“  ì€ë‹‰ ìƒíƒœ}($a^{\langle 1 \rangle}, a^{\langle 2 \rangle}, \dots$)ë¥¼ ë‹¤ ì°¸ê³ í•©ë‹ˆë‹¤. ë‹¨, ì¤‘ìš”í•œ ê²ƒì€ ì§„í•˜ê²Œ(ë†’ì€ ê°€ì¤‘ì¹˜), ì•ˆ ì¤‘ìš”í•œ ê²ƒì€ íë¦¬ê²Œ ë´…ë‹ˆë‹¤.

\begin{analogybox}{ë²ˆì—­ê°€ì˜ íë”ê±°ë¦¬ê¸°}
\begin{itemize}
    \item \textbf{ê¸°ì¡´:} ë¬¸ì¥ì„ í•œ ë²ˆ ì½ê³  ì±…ì„ ë®ì€ ë’¤ ì•”ê¸°í•´ì„œ ë²ˆì—­í•¨. (ë³‘ëª© ë°œìƒ)
    \item \textbf{ì–´í…ì…˜:} ë²ˆì—­ë¬¸ì„ ì“°ë©´ì„œ ì›ë¬¸ì—ì„œ ì§€ê¸ˆ ë‹¨ì–´ì™€ ê´€ë ¨ëœ ë¶€ë¶„(ì˜ˆ: ì£¼ì–´, ëª©ì ì–´)ì„ ê³„ì† \textbf{íë”íë”} ë‹¤ì‹œ ë³´ë©° ë²ˆì—­í•¨.
\end{itemize}
\end{analogybox}

\subsection{2. The Architecture: Context Vector $c^{\langle t \rangle}$}
ë¬¸ë§¥ ë²¡í„° $c^{\langle t \rangle}$ëŠ” ì¸ì½”ë”ì˜ ëª¨ë“  ì€ë‹‰ ìƒíƒœ $a^{\langle t' \rangle}$ì˜ \textbf{ê°€ì¤‘ í‰ê· }ì…ë‹ˆë‹¤.

\begin{formulabox}{Context Vector ê³µì‹}
$$ c^{\langle t \rangle} = \sum_{t'} \alpha^{\langle t, t' \rangle} a^{\langle t' \rangle} $$
\begin{itemize}
    \item $\alpha^{\langle t, t' \rangle}$: ë””ì½”ë” $t$ ì‹œì ì— ì¸ì½”ë” $t'$ ì‹œì ì„ ë³´ëŠ” ë¹„ì¤‘.
    \item $\sum_{t'} \alpha^{\langle t, t' \rangle} = 1$ (í™•ë¥ ê°’).
\end{itemize}
\end{formulabox}

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Deep Dive: Computing Attention (ìˆ˜í•™ì  ì›ë¦¬)}

ê·¸ë ‡ë‹¤ë©´ ê°€ì¥ ì¤‘ìš”í•œ $\alpha$ (ê°€ì¤‘ì¹˜)ëŠ” ëˆ„ê°€ ì •í• ê¹Œìš”? ì‚¬ëŒì´ ì •í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼, ì´ì¡°ì°¨ \textbf{ì‘ì€ ì‹ ê²½ë§(Alignment Model)}ì´ í•™ìŠµí•©ë‹ˆë‹¤.

\begin{enumerate}
    \item \textbf{Alignment Score ($e^{\langle t, t' \rangle}$):} ë””ì½”ë”ì˜ ì´ì „ ìƒíƒœ $s^{\langle t-1 \rangle}$ì™€ ì¸ì½”ë” ìƒíƒœ $a^{\langle t' \rangle}$ê°€ ì–¼ë§ˆë‚˜ ì–´ìš¸ë¦¬ëŠ”ì§€ ì ìˆ˜ë¥¼ ë§¤ê¹ë‹ˆë‹¤.
    $$ e^{\langle t, t' \rangle} = \text{dense\_layer}([s^{\langle t-1 \rangle}, a^{\langle t' \rangle}]) $$
    
    \item \textbf{Softmax (Weights):} ì ìˆ˜ë¥¼ í™•ë¥ ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
    $$ \alpha^{\langle t, t' \rangle} = \frac{\exp(e^{\langle t, t' \rangle})}{\sum_{k=1}^{T_x} \exp(e^{\langle t, k \rangle})} $$
\end{enumerate}



% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: Bahdanau Attention}

TensorFlow/Kerasì˜ ì„œë¸Œí´ë˜ì‹± ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•œ ì˜ˆì‹œì…ë‹ˆë‹¤.

\begin{lstlisting}[language=Python, caption=Bahdanau Attention Layer, breaklines=true]
import tensorflow as tf
from tensorflow.keras.layers import Layer, Dense

class BahdanauAttention(Layer):
    def __init__(self, units):
        super().__init__()
        self.W1 = Dense(units) # Decoder state weight
        self.W2 = Dense(units) # Encoder state weight
        self.V = Dense(1)      # Score weight

    def call(self, query, values):
        # query: ë””ì½”ë” ì€ë‹‰ ìƒíƒœ (Batch, hidden)
        # values: ì¸ì½”ë” ì€ë‹‰ ìƒíƒœë“¤ (Batch, Tx, hidden)
        
        query_with_time = tf.expand_dims(query, 1)
        
        # 1. ì ìˆ˜ ê³„ì‚° (Additive Attention)
        score = self.V(tf.nn.tanh(self.W1(query_with_time) + self.W2(values)))
        
        # 2. ê°€ì¤‘ì¹˜ ê³„ì‚° (Softmax)
        attention_weights = tf.nn.softmax(score, axis=1)
        
        # 3. ë¬¸ë§¥ ë²¡í„° ê³„ì‚° (Weighted Sum)
        context_vector = attention_weights * values
        context_vector = tf.reduce_sum(context_vector, axis=1)
        
        return context_vector, attention_weights
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\textbf{Q. ì–´í…ì…˜ì„ ì“°ë©´ ëª¨ë¸ì´ ë¬´ê±°ì›Œì§€ì§€ ì•Šë‚˜ìš”?} \\
\textbf{A.} ë„¤, ì¸ì½”ë”ì˜ ëª¨ë“  íƒ€ì„ ìŠ¤í…ì„ ë§¤ë²ˆ ì—°ì‚°í•´ì•¼ í•˜ë¯€ë¡œ $T_x \times T_y$ì˜ ì—°ì‚°ëŸ‰ì´ ì¶”ê°€ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì„±ëŠ¥ í–¥ìƒ í­ì´ ì›Œë‚™ ì»¤ì„œ ê°ìˆ˜í•  ë§Œí•œ ë¹„ìš©ì…ë‹ˆë‹¤.

\textbf{Q. ì–´í…ì…˜ì€ ë²ˆì—­ ë§ê³  ì–´ë””ì— ì“°ì´ë‚˜ìš”?} \\
\textbf{A.} \textbf{ì´ë¯¸ì§€ ìº¡ì…”ë‹}ì—ì„œë„ ì“°ì…ë‹ˆë‹¤. ë‹¨ì–´ë¥¼ ìƒì„±í•  ë•Œë§ˆë‹¤ ì´ë¯¸ì§€ì˜ íŠ¹ì • êµ¬ì—­ì„ ì³ë‹¤ë³´ëŠ” ì‹ì´ì£ .

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ì–´í…ì…˜ì€ RNNì˜ í•œê³„ë¥¼ ë¶€ìˆ˜ê³  ì„±ëŠ¥ì„ ê·¹ëŒ€í™”í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì‚¬ëŒë“¤ì€ ê¹¨ë‹¬ì•˜ìŠµë‹ˆë‹¤.
\textbf{"ì–´í…ì…˜ì´ ì´ë ‡ê²Œ ê°•ë ¥í•˜ë‹¤ë©´, êµ³ì´ ëŠë¦° ìˆœì°¨ ë°©ì‹(RNN)ì„ ì¨ì•¼ í• ê¹Œ? ê·¸ëƒ¥ ì–´í…ì…˜ë§Œ ì“°ë©´ ì•ˆ ë˜ë‚˜?"}

ì—¬ê¸°ì„œ ë”¥ëŸ¬ë‹ ì—­ì‚¬ë¥¼ ë°”ê¾¼ ë…¼ë¬¸, \textbf{"Attention Is All You Need"}ê°€ ë“±ì¥í•©ë‹ˆë‹¤.
ë‹¤ìŒ ì‹œê°„, RNNê³¼ CNNì„ ëª¨ë‘ ë²„ë¦¬ê³  ì˜¤ì§ ì–´í…ì…˜ë§Œìœ¼ë¡œ ë¬´ì¥í•œ í˜„ëŒ€ AIì˜ ì‹¬ì¥, \textbf{[Transformer Network]}ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{Problem:} Seq2Seq ì¸ì½”ë”ì˜ ê³ ì • í¬ê¸° ë²¡í„° ë³‘ëª© í˜„ìƒ.
    \item \textbf{Solution:} ë””ì½”ë”ê°€ ë§¤ ìˆœê°„ ì¸ì½”ë”ì˜ ëª¨ë“  ë¶€ë¶„ì„ ì—°ê´€ì„±ì— ë”°ë¼ ì°¸ê³ í•œë‹¤.
    \item \textbf{Formula:} $c^{\langle t \rangle} = \sum \alpha^{\langle t, t' \rangle} a^{\langle t' \rangle}$ (ê°€ì¤‘ í‰ê· ).
    \item \textbf{Benefit:} ê¸´ ë¬¸ì¥ ë²ˆì—­ ì„±ëŠ¥ ë¹„ì•½ì  ìƒìŠ¹ + ì‹œê°ì  í•´ì„ ê°€ëŠ¥.
\end{enumerate}
\end{summarybox}

\end{document}