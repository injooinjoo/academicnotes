\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{formulabox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ§® #1 (í•µì‹¬ ìˆ˜ì‹)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Sequence Models: \\ BLEU Score (Evaluation Metric)}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-9.] Deep Learning Fundamentals \& CNNs \textit{- Completed}
    \item[\textbf{Chapter 10.}] \textbf{Sequence Models (Current Part)}
    \begin{itemize}
        \item 10.1-10.9 RNN, Seq2Seq, Beam Search \textit{- Completed}
        \item \textbf{10.10 BLEU Score}
        \begin{itemize}
            \item The Multiple Reference Problem
            \item Modified Precision (Clipping)
            \item N-grams (Unigram, Bigram, Trigram)
            \item Brevity Penalty (Length Normalization)
        \end{itemize}
    \end{itemize}
    \item[Chapter 11.] Attention Mechanism \textit{- Next Part}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ì— ë¹” ì„œì¹˜ë¡œ ìµœì ì˜ ë¬¸ì¥ì„ ìƒì„±í•˜ëŠ” ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ê·¼ë³¸ì ì¸ ì§ˆë¬¸ì´ ë‚¨ìŠµë‹ˆë‹¤.
\textbf{"ë²ˆì—­ì´ ì˜ ëëŠ”ì§€ ì»´í“¨í„°ê°€ ì–´ë–»ê²Œ ì±„ì í• ê¹Œ?"}
ì´ë¯¸ì§€ ë¶„ë¥˜ëŠ” ì •ë‹µì´ í•˜ë‚˜(ê³ ì–‘ì´)ì§€ë§Œ, ë²ˆì—­ì€ ì •ë‹µì´ ì—¬ëŸ¬ ê°œì…ë‹ˆë‹¤. ("ë‚˜ëŠ” í•™êµì— ê°„ë‹¤", "í•™êµì— ê°€ëŠ” ì¤‘ì´ë‹¤" ë“±)
ì‚¬ëŒì´ ì¼ì¼ì´ ì±„ì í•˜ê¸°ì—” ë„ˆë¬´ ë¹„ìŒ‰ë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ IBMì´ ì œì•ˆí•œ ìë™í™”ëœ ì ìˆ˜, \textbf{BLEU Score}ë¥¼ ë°°ì›ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ ê¸°ê³„ ë²ˆì—­ í‰ê°€ì˜ í‘œì¤€ì¸ BLEU Scoreì˜ ì›ë¦¬ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ë‹¤ì¤‘ ì •ë‹µ:} ì—¬ëŸ¬ ê°œì˜ ì°¸ê³  ë¬¸ì¥(Reference)ì„ ê¸°ì¤€ìœ¼ë¡œ í‰ê°€í•©ë‹ˆë‹¤.
    \item \textbf{ì •ë°€ë„:} ë‹¨ìˆœ ì¼ì¹˜ê°€ ì•„ë‹Œ \textbf{í´ë¦¬í•‘ëœ ì •ë°€ë„(Clipped Precision)}ë¥¼ ì‚¬ìš©í•´ "the the the" ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.
    \item \textbf{N-gram:} ë‹¨ì–´ ë¬¶ìŒì„ ë¹„êµí•˜ì—¬ ë¬¸ë§¥ê³¼ ì–´ìˆœì˜ ì •í™•ì„±ì„ í‰ê°€í•©ë‹ˆë‹¤.
    \item \textbf{í˜ë„í‹°:} ë„ˆë¬´ ì§§ì€ ë¬¸ì¥ì— í˜ë„í‹°(BP)ë¥¼ ì£¼ì–´ ê¼¼ìˆ˜ë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ì˜ë¯¸} & \textbf{ì—­í• } \\ \hline
\textbf{Reference} & ì •ë‹µ ë¬¸ì¥(ë“¤). & ì±„ì  ê¸°ì¤€. (ì‚¬ëŒì´ ë²ˆì—­í•œ ê²ƒ) \\ \hline
\textbf{Candidate} & ëª¨ë¸ì´ ìƒì„±í•œ ë¬¸ì¥. & ì±„ì  ëŒ€ìƒ. \\ \hline
\textbf{Modified Precision} & ë¹ˆë„ìˆ˜ ì œí•œ ì •ë°€ë„. & ì¤‘ë³µ ë‹¨ì–´ ë‚¨ë°œ ë°©ì§€. \\ \hline
\textbf{Brevity Penalty} & ê¸¸ì´ ë¶ˆì´ìµ. & ì •ë³´ ëˆ„ë½(ì§§ì€ ë¬¸ì¥) ë°©ì§€. \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ì •ë°€ë„ì˜ í•¨ì •}

\subsection{1. The Problem with Standard Precision}


\textbf{Candidate:} "the the the the the" (5ë‹¨ì–´)
\textbf{Reference:} "The cat is on the mat."
\begin{itemize}
    \item \textbf{ë‹¨ìˆœ ì •ë°€ë„:} 5ê°œ ëª¨ë‘ ì •ë‹µì— ìˆìŒ("the"). $\rightarrow$ 5/5 = 100ì ? (ë§ë„ ì•ˆ ë¨)
    \item \textbf{í•´ê²°ì±… (Clipping):} ì •ë‹µ ë¬¸ì¥ì— "the"ê°€ ìµœëŒ€ ëª‡ ë²ˆ ë‚˜ì˜¤ëŠ”ì§€ ì…‰ë‹ˆë‹¤. (2ë²ˆ). ë¶„ìë¥¼ 2ë¡œ ì œí•œí•©ë‹ˆë‹¤. $\rightarrow$ 2/5 = 40ì .
\end{itemize}

\subsection{2. N-gram Analysis (ì–´ìˆœ í‰ê°€)}
ë‹¨ì–´ë§Œ ë‹¤ ìˆë‹¤ê³  ë¬¸ì¥ì´ ì•„ë‹™ë‹ˆë‹¤.
"The cat the mat on is" (ë‹¨ì–´ëŠ” ë§ì§€ë§Œ ì—‰í„°ë¦¬)
ì´ë¥¼ ì¡ê¸° ìœ„í•´ \textbf{N-gram(ë‹¨ì–´ ë¬¶ìŒ)}ì„ ë´…ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{Unigram (1-gram):} ë‹¨ì–´ ì¡´ì¬ ì—¬ë¶€ (ë‚´ìš© ì¶©ì‹¤ë„).
    \item \textbf{Bigram (2-gram):} "The cat", "cat is" ... (ì–´ìˆœ/ìœ ì°½ì„±).
\end{itemize}

\subsection{3. Brevity Penalty (BP)}
ì •ë°€ë„ ê¸°ë°˜ í‰ê°€ëŠ” \textbf{"ì§§ê²Œ ë§í•˜ë©´ ìœ ë¦¬í•˜ë‹¤"}ëŠ” ì•½ì ì´ ìˆìŠµë‹ˆë‹¤.
\textbf{Cand:} "The cat" (2ë‹¨ì–´ ë‹¤ ë§ìŒ. ì •ë°€ë„ 100%)
í•˜ì§€ë§Œ ì •ë³´ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤. ì˜ˆì¸¡ ë¬¸ì¥ì´ ì •ë‹µë³´ë‹¤ ì§§ìœ¼ë©´ ì ìˆ˜ë¥¼ ê¹ìŠµë‹ˆë‹¤.

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Deep Dive: The Formula}

\begin{formulabox}{BLEU Formula}
$$ \text{BLEU} = BP \times \exp \left( \frac{1}{4} \sum_{n=1}^{4} p_n \right) $$
\begin{itemize}
    \item $p_n$: n-gramì˜ ë³´ì •ëœ ì •ë°€ë„.
    \item $BP$: Brevity Penalty (ê¸¸ì´ í˜ë„í‹°).
    \item $\exp(\dots)$: ê¸°í•˜ í‰ê· (Geometric Mean)ì„ êµ¬í•˜ëŠ” ë°©ì‹.
\end{itemize}
\end{formulabox}

% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: NLTK Library}

íŒŒì´ì¬ NLTK ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì‰½ê²Œ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

\begin{lstlisting}[language=Python, caption=BLEU Score Calculation, breaklines=true]
from nltk.translate.bleu_score import sentence_bleu

# 1. ë°ì´í„° ì¤€ë¹„
# ReferenceëŠ” ì—¬ëŸ¬ ê°œì¼ ìˆ˜ ìˆìŒ (ë¦¬ìŠ¤íŠ¸ì˜ ë¦¬ìŠ¤íŠ¸)
references = [
    ['the', 'cat', 'is', 'on', 'the', 'mat'],       # Ref 1
    ['there', 'is', 'a', 'cat', 'on', 'the', 'mat'] # Ref 2
]

# CandidateëŠ” í•˜ë‚˜ì˜ ë¦¬ìŠ¤íŠ¸
candidate = ['the', 'cat', 'is', 'on', 'the', 'mat']

# 2. BLEU ê³„ì‚°
# weights: 1-gram ~ 4-gram ê°€ì¤‘ì¹˜ (ë³´í†µ ê· ë“±í•˜ê²Œ 0.25)
score = sentence_bleu(references, candidate, weights=(0.25, 0.25, 0.25, 0.25))

print(f"BLEU Score: {score:.4f}")
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\textbf{Q. BLEU ì ìˆ˜ê°€ ë†’ìœ¼ë©´ ì™„ë²½í•œ ë²ˆì—­ì¸ê°€ìš”?} \\
\textbf{A.} \textbf{ì•„ë‹ˆìš”.} BLEUëŠ” ë‹¨ì–´ ì¼ì¹˜ë„ë§Œ ë´…ë‹ˆë‹¤. ì˜ë¯¸ëŠ” í†µí•˜ëŠ”ë° ë‹¨ì–´ê°€ ë‹¤ë¥¸ ì˜ì—­(Paraphrasing)ì´ë‚˜, ë¯¸ë¬˜í•œ ë‰˜ì•™ìŠ¤ ì°¨ì´ëŠ” ì¡ì•„ë‚´ì§€ ëª»í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ "ìµœì†Œí•œ ì´ ì •ë„ëŠ” í•œë‹¤"ëŠ” ì§€í‘œë¡œëŠ” ê°€ì¥ í›Œë¥­í•©ë‹ˆë‹¤.

\textbf{Q. ë§Œì•½ 4-gramì´ í•˜ë‚˜ë„ ì•ˆ ë§ìœ¼ë©´ìš”?} \\
\textbf{A.} $p_4 = 0$ì´ ë˜ë©´ ê¸°í•˜ í‰ê·  íŠ¹ì„±ìƒ ì „ì²´ ì ìˆ˜ê°€ 0ì´ ë˜ì–´ë²„ë¦½ë‹ˆë‹¤. ì´ë¥¼ ë§‰ê¸° ìœ„í•´ ì•„ì£¼ ì‘ì€ ê°’($\epsilon$)ì„ ë”í•´ì£¼ëŠ” \textbf{Smoothing} ê¸°ë²•ì„ ì”ë‹ˆë‹¤.

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ìš°ë¦¬ëŠ” ë¹” ì„œì¹˜ë¡œ ë¬¸ì¥ì„ ë§Œë“¤ê³ , BLEUë¡œ í‰ê°€ê¹Œì§€ í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ Seq2Seqì—ëŠ” ì—¬ì „íˆ \textbf{"ê¸´ ë¬¸ì¥ì˜ ë³‘ëª© í˜„ìƒ"}ì´ë¼ëŠ” ê±°ëŒ€í•œ ë²½ì´ ë‚¨ì•„ ìˆìŠµë‹ˆë‹¤.
ì¸ì½”ë”ê°€ 100ë‹¨ì–´ë¥¼ ë²¡í„° í•˜ë‚˜ì— ì••ì¶•í•˜ëŠ” ê²ƒì€ ë¬´ë¦¬ì…ë‹ˆë‹¤.

\textbf{"ë²ˆì—­í•  ë•Œ ë¬¸ì¥ ì „ì²´ë¥¼ ì™¸ìš°ì§€ ì•Šê³ , í•„ìš”í•œ ë‹¨ì–´ë§Œ ê·¸ë•Œê·¸ë•Œ ë‹¤ì‹œ ë³´ë©´ì„œ(Attend) ë²ˆì—­í•  ìˆ˜ëŠ” ì—†ì„ê¹Œ?"}
ë‹¤ìŒ ì‹œê°„, ë”¥ëŸ¬ë‹ ì—­ì‚¬ìƒ ê°€ì¥ ìœ„ëŒ€í•œ ë°œëª… ì¤‘ í•˜ë‚˜ì¸ \textbf{[Attention Mechanism]}ì„ í†µí•´ ì´ ë²½ì„ ë¶€ìˆ˜ê² ìŠµë‹ˆë‹¤. ì´ê²ƒì´ ë°”ë¡œ Transformerì™€ GPTë¡œ ê°€ëŠ” ë§ˆì§€ë§‰ ì—´ì‡ ì…ë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{Modified Precision:} ì •ë‹µì— ë“±ì¥í•˜ëŠ” íšŸìˆ˜ë§Œí¼ë§Œ ì¸ì •í•˜ì—¬ ì¤‘ë³µ ê¼¼ìˆ˜ë¥¼ ë§‰ëŠ”ë‹¤.
    \item \textbf{N-gram:} 1~4ë‹¨ì–´ ë¬¶ìŒì„ ë¹„êµí•˜ì—¬ ë¬¸ë§¥ê³¼ ìœ ì°½ì„±ì„ í‰ê°€í•œë‹¤.
    \item \textbf{BP:} ë¬¸ì¥ì´ ì§§ìœ¼ë©´ ì ìˆ˜ë¥¼ ê¹ì•„ ì •ë³´ ëˆ„ë½ì„ ë°©ì§€í•œë‹¤.
    \item \textbf{Standard:} ê¸°ê³„ ë²ˆì—­ ì„±ëŠ¥ í‰ê°€ì˜ ì—…ê³„ í‘œì¤€ì´ë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}