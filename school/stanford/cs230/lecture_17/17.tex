\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{mathbox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ§® #1 (ìˆ˜í•™ì  ì›ë¦¬)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Optimization Algorithms: \\ Momentum \& RMSprop}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-4.] Neural Networks Basics \textit{- Completed}
    \item[\textbf{Chapter 5.}] \textbf{Practical Aspects of Deep Learning (Current Unit)}
    \begin{itemize}
        \item 5.1-5.5 Regularization \& Data Setup \textit{- Completed}
        \item 5.6 Mini-batch Gradient Descent \textit{- Completed}
        \item \textbf{5.7 Optimization Algorithms (Momentum \& RMSprop)}
        \begin{itemize}
            \item Exponential Weighted Moving Average (The Trend)
            \item Momentum (Physics: Velocity)
            \item RMSprop (Adaptive Learning Rate)
            \item Implementation
        \end{itemize}
        \item 5.8 Adam Optimizer \textit{- Upcoming}
    \end{itemize}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ì— ìš°ë¦¬ëŠ” ë°ì´í„°ë¥¼ ì‘ì€ ë©ì–´ë¦¬ë¡œ ìª¼ê°œ í•™ìŠµí•˜ëŠ” \textbf{ë¯¸ë‹ˆ ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•}ì„ ë°°ì› ìŠµë‹ˆë‹¤. ì†ë„ëŠ” ë¹¨ë¼ì¡Œì§€ë§Œ, ê·¸ë˜í”„ë¥¼ ë³´ë©´ ì—¬ì „íˆ ìµœì ì ì„ í–¥í•´ ê³§ë°”ë¡œ ê°€ì§€ ëª»í•˜ê³  \textbf{ì§€ê·¸ì¬ê·¸(Zigzag)ë¡œ ì§„ë™(Oscillation)}í•˜ë©° ë‚´ë ¤ê°‘ë‹ˆë‹¤.
ì´ ì§„ë™ì„ ì¤„ì´ê³ , ìµœì í•´ë¥¼ í–¥í•´ \textbf{'ê°€ì†ë„(Acceleration)'}ë¥¼ ë¶™ì¼ ìˆ˜ëŠ” ì—†ì„ê¹Œìš”? ë¬¼ë¦¬í•™ì˜ ê´€ì„±ì„ ì´ìš©í•œ \textbf{Momentum}ê³¼, ë³´í­ì„ ìë™ìœ¼ë¡œ ì¡°ì ˆí•˜ëŠ” \textbf{RMSprop}ì´ ê·¸ í•´ë‹µì…ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ ë‹¨ìˆœí•œ ê²½ì‚¬ í•˜ê°•ë²•ì„ ë„˜ì–´ì„  \textbf{ê³ ê¸‰ ìµœì í™” ì•Œê³ ë¦¬ì¦˜} ë‘ ê°€ì§€ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ê¸°ì´ˆ:} ì‹œê³„ì—´ ë°ì´í„°ì˜ íŠ¸ë Œë“œë¥¼ ì¶”ì¶œí•˜ëŠ” \textbf{ì§€ìˆ˜ ê°€ì¤‘ ì´ë™ í‰ê· (EWMA)}ì„ ì´í•´í•©ë‹ˆë‹¤.
    \item \textbf{Momentum:} ê³¼ê±°ì˜ ê¸°ìš¸ê¸°ë¥¼ ëˆ„ì í•˜ì—¬ ê´€ì„±ì„ ë§Œë“œëŠ” ì›ë¦¬ë¥¼ ë°°ì›ë‹ˆë‹¤.
    \item \textbf{RMSprop:} ê¸°ìš¸ê¸°ì˜ í¬ê¸°(ì œê³±)ì— ë”°ë¼ í•™ìŠµ ë³´í­ì„ ì¡°ì ˆí•˜ëŠ” ì ì‘í˜• ì•Œê³ ë¦¬ì¦˜ì„ ìµí™ë‹ˆë‹¤.
    \item \textbf{êµ¬í˜„:} ë‘ ì•Œê³ ë¦¬ì¦˜ì˜ ìˆ˜ì‹ì„ Python ì½”ë“œë¡œ ì˜®ê¸°ê³  í•˜ì´í¼íŒŒë¼ë¯¸í„°($\beta$)ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ê¸°í˜¸} & \textbf{ì„¤ëª…} \\ \hline
\textbf{EWMA} & $v_t$ & ì§€ìˆ˜ ê°€ì¤‘ ì´ë™ í‰ê· . ìµœê·¼ ë°ì´í„°ì˜ ê²½í–¥ì„±ì„ ë‚˜íƒ€ëƒ„. \\ \hline
\textbf{Momentum} & $v$ & ê´€ì„±(ì†ë„). ê³¼ê±°ì˜ ì§„í–‰ ë°©í–¥ì„ ìœ ì§€í•˜ë ¤ëŠ” ì„±ì§ˆ. \\ \hline
\textbf{RMSprop} & $S$ & Root Mean Square Prop. ê¸°ìš¸ê¸° ì œê³±ì„ ì´ìš©í•´ ë³´í­ ì¡°ì ˆ. \\ \hline
\textbf{Beta} & $\beta$ & ê³¼ê±° ë°ì´í„°ë¥¼ ì–¼ë§ˆë‚˜ ê¸°ì–µí• ì§€ ê²°ì •í•˜ëŠ” ê³„ìˆ˜ (0.9 ë“±). \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ê°€ì†ì˜ ì›ë¦¬}

\subsection{1. ì§€ìˆ˜ ê°€ì¤‘ ì´ë™ í‰ê·  (Exponentially Weighted Moving Average)}
ì´ ì•Œê³ ë¦¬ì¦˜ë“¤ì˜ ê¸°ì´ˆê°€ ë˜ëŠ” ìˆ˜í•™ì…ë‹ˆë‹¤.
$$ v_t = \beta v_{t-1} + (1 - \beta) \theta_t $$
\begin{itemize}
    \item $\beta = 0.9$: ìµœê·¼ 10ì¼ê°„ì˜ í‰ê·  ($\frac{1}{1-0.9} = 10$)
    \item $\beta = 0.98$: ìµœê·¼ 50ì¼ê°„ì˜ í‰ê·  ($\frac{1}{1-0.98} = 50$)
    \item $\beta$ê°€ í´ìˆ˜ë¡ ê·¸ë˜í”„ê°€ ë¶€ë“œëŸ¬ì›Œì§€ì§€ë§Œ(Smoothing), ë³€í™”ì— ë‘”ê°í•´ì§‘ë‹ˆë‹¤(Latency).
\end{itemize}



\vspace{0.5cm}\hrule\vspace{0.5cm}

\subsection{2. Momentum (ê´€ì„±)}
\textbf{"ê³µì´ ì–¸ë•ì„ êµ´ëŸ¬ ë‚´ë ¤ê°ˆ ë•Œ ì†ë„ê°€ ë¶™ëŠ” ë¬¼ë¦¬ ë²•ì¹™"}

\begin{analogybox}{ì–¼ìŒíŒ ìœ„ì˜ ì‡ êµ¬ìŠ¬}
\begin{itemize}
    \item \textbf{SGD (ì¼ë°˜ ê²½ì‚¬ í•˜ê°•ë²•):} ë§ˆì°°ë ¥ì´ ë¬´í•œëŒ€ì¸ ë°”ë‹¥. í˜(ê¸°ìš¸ê¸°)ì„ ì£¼ë©´ ì›€ì§ì´ê³ , ì•ˆ ì£¼ë©´ ë”± ë©ˆì¶¥ë‹ˆë‹¤. ë°©í–¥ì´ ë°”ë€Œë©´ ì¦‰ì‹œ êº¾ì…ë‹ˆë‹¤ (ì§€ê·¸ì¬ê·¸).
    \item \textbf{Momentum:} ë§ˆì°°ë ¥ì´ ì—†ëŠ” ì–¼ìŒíŒ. í˜ì„ ì£¼ì§€ ì•Šì•„ë„ ê¸°ì¡´ì— ë‚´ë ¤ì˜¤ë˜ \textbf{ì†ë„(Velocity, $v$)} ë•Œë¬¸ì— ê³„ì† ë¯¸ë„ëŸ¬ì ¸ ë‚´ë ¤ê°‘ë‹ˆë‹¤. ì´ ê´€ì„±ì´ ì§„ë™ì„ ìƒì‡„í•˜ê³  ì›…ë©ì´(Local Minima)ë¥¼ ë„˜ê²Œ í•´ì¤ë‹ˆë‹¤.
\end{itemize}
\end{analogybox}

\begin{mathbox}{Update Rule}
1. ì†ë„ ê³„ì‚°: $v = \beta v + (1-\beta) dW$ \\
2. íŒŒë¼ë¯¸í„° ì—…ë°ì´íŠ¸: $W = W - \alpha v$ \\
($\alpha$: í•™ìŠµë¥ , $\beta$: ë³´í†µ 0.9 ì‚¬ìš©)
\end{mathbox}

\vspace{0.5cm}\hrule\vspace{0.5cm}

\subsection{3. RMSprop (Root Mean Square Propagation)}
\textbf{"ê°€íŒŒë¥¸ ê³³ì€ ì²œì²œíˆ, ì™„ë§Œí•œ ê³³ì€ ë¹ ë¥´ê²Œ"}

ì œí”„ë¦¬ íŒíŠ¼ êµìˆ˜ê°€ ì œì•ˆí•œ ë°©ë²•ì…ë‹ˆë‹¤. ê¸°ìš¸ê¸°($dW$)ì˜ í¬ê¸°ë¥¼ ë³´ê³  ë³´í­ì„ ì¡°ì ˆí•©ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ì›ë¦¬:} í•™ìŠµë¥  $\alpha$ë¥¼ $\sqrt{S}$ë¡œ ë‚˜ëˆ ì¤ë‹ˆë‹¤.
    \item \textbf{íš¨ê³¼:} 
    \begin{itemize}
        \item ê¸°ìš¸ê¸°ê°€ í¼($S$ í¼) $\rightarrow$ ë¶„ëª¨ê°€ ì»¤ì§ $\rightarrow$ ì—…ë°ì´íŠ¸ í­ ê°ì†Œ (ì§„ë™ ì–µì œ)
        \item ê¸°ìš¸ê¸°ê°€ ì‘ìŒ($S$ ì‘ìŒ) $\rightarrow$ ë¶„ëª¨ê°€ ì‘ì•„ì§ $\rightarrow$ ì—…ë°ì´íŠ¸ í­ ì¦ê°€ (ê°€ì†)
    \end{itemize}
\end{itemize}

\begin{mathbox}{Update Rule}
1. ì œê³± í‰ê· : $S = \beta_2 S + (1-\beta_2) dW^2$ (ìš”ì†Œë³„ ì œê³±) \\
2. íŒŒë¼ë¯¸í„° ì—…ë°ì´íŠ¸: $W = W - \alpha \frac{dW}{\sqrt{S} + \epsilon}$ \\
($\epsilon$: 0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€ìš©, $10^{-8}$)
\end{mathbox}

% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: Momentum \& RMSprop}

\begin{lstlisting}[language=Python, caption=Optimization Algorithms Implementation, breaklines=true]
import numpy as np

def update_with_momentum(parameters, grads, v, beta, learning_rate):
    """
    v: ì†ë„(Velocity) ë”•ì…”ë„ˆë¦¬ (ì´ˆê¸°ê°’ì€ 0)
    beta: Momentum ê³„ìˆ˜ (ë³´í†µ 0.9)
    """
    L = len(parameters) // 2
    
    for l in range(1, L + 1):
        # 1. ì†ë„(v) ì—…ë°ì´íŠ¸ (ê´€ì„± ëˆ„ì )
        v["dW" + str(l)] = beta * v["dW" + str(l)] + (1 - beta) * grads["dW" + str(l)]
        v["db" + str(l)] = beta * v["db" + str(l)] + (1 - beta) * grads["db" + str(l)]
        
        # 2. íŒŒë¼ë¯¸í„° ì—…ë°ì´íŠ¸ (vë¥¼ ë¹¼ì¤Œ)
        parameters["W" + str(l)] -= learning_rate * v["dW" + str(l)]
        parameters["b" + str(l)] -= learning_rate * v["db" + str(l)]
        
    return parameters, v

def update_with_rmsprop(parameters, grads, s, beta2, learning_rate, epsilon=1e-8):
    """
    s: ì œê³± í‰ê· (Squared Gradient) ë”•ì…”ë„ˆë¦¬
    beta2: RMSprop ê³„ìˆ˜ (ë³´í†µ 0.999)
    """
    L = len(parameters) // 2
    
    for l in range(1, L + 1):
        # 1. ì œê³± í‰ê· (s) ì—…ë°ì´íŠ¸ (ê¸°ìš¸ê¸° ì œê³± ì£¼ì˜!)
        s["dW" + str(l)] = beta2 * s["dW" + str(l)] + (1 - beta2) * np.square(grads["dW" + str(l)])
        s["db" + str(l)] = beta2 * s["db" + str(l)] + (1 - beta2) * np.square(grads["db" + str(l)])
        
        # 2. íŒŒë¼ë¯¸í„° ì—…ë°ì´íŠ¸ (ì ì‘í˜• í•™ìŠµë¥ )
        # ë¶„ëª¨ì— sqrt(s) + epsilon
        parameters["W" + str(l)] -= learning_rate * (grads["dW" + str(l)] / (np.sqrt(s["dW" + str(l)]) + epsilon))
        parameters["b" + str(l)] -= learning_rate * (grads["db" + str(l)] / (np.sqrt(s["db" + str(l)]) + epsilon))
        
    return parameters, s
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\begin{warningbox}{ë³€ìˆ˜ ì´ˆê¸°í™” ì‹¤ìˆ˜}
$v$ì™€ $s$ëŠ” í•™ìŠµ ë£¨í”„(Iteration)ê°€ ëŒ ë•Œë§ˆë‹¤ ì´ˆê¸°í™”í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤! 
ê·¸ëŸ¬ë©´ ê´€ì„±ì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤. ë°˜ë“œì‹œ \textbf{í•™ìŠµ ì‹œì‘ ì „(Epoch 0 ì´ì „)ì— í•œ ë²ˆë§Œ 0ìœ¼ë¡œ ì´ˆê¸°í™”}í•˜ê³ , ê³„ì† ê°’ì„ ëˆ„ì í•´ê°€ì•¼ í•©ë‹ˆë‹¤.
\end{warningbox}

\textbf{Q. $\beta$(Momentum)ì™€ $\beta_2$(RMSprop) ê°’ì€ íŠœë‹í•´ì•¼ í•˜ë‚˜ìš”?} \\
\textbf{A.} ë³´í†µì€ \textbf{ê¸°ë³¸ê°’($\beta=0.9, \beta_2=0.999$)}ì„ ê·¸ëŒ€ë¡œ ì”ë‹ˆë‹¤. ì´ ê°’ë“¤ì´ ê²½í—˜ì ìœ¼ë¡œ ëŒ€ë¶€ë¶„ì˜ ë¬¸ì œì—ì„œ ì˜ ì‘ë™í•©ë‹ˆë‹¤. í•™ìŠµë¥ ($\alpha$) íŠœë‹ì´ í›¨ì”¬ ì¤‘ìš”í•©ë‹ˆë‹¤.

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ìš°ë¦¬ëŠ” ìµœê³ ì˜ ê°€ì† ì—”ì§„ ë‘ ê°œë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{Momentum:} ê´€ì„±ì„ ì´ìš©í•˜ì—¬ ì†ë„ë¥¼ ë†’ì„.
    \item \textbf{RMSprop:} ë³´í­ì„ ì¡°ì ˆí•˜ì—¬ ì§„ë™ì„ ì¤„ì„.
\end{itemize}
"ë‘˜ ë‹¤ ì“°ë©´ ì•ˆ ë˜ë‚˜ìš”?" 
ë‹¹ì—°íˆ ë©ë‹ˆë‹¤. ì´ ë‘˜ì„ ê²°í•©í•œ ê²ƒì´ ë°”ë¡œ \textbf{Adam (Adaptive Moment Estimation)}ì…ë‹ˆë‹¤. í˜„ì¬ ë”¥ëŸ¬ë‹ ì„¸ê³„ë¥¼ ì§€ë°°í•˜ê³  ìˆëŠ” Adam ì•Œê³ ë¦¬ì¦˜ì„ ë‹¤ìŒ ì‹œê°„ì— ì™„ì„±í•˜ê³ , ìµœì í™” ë‹¨ì›ì„ ë§ˆë¬´ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{Momentum:} $v \leftarrow dW$. ê³¼ê±°ì˜ ì†ë„ë¥¼ ìœ ì§€í•˜ì—¬ Local Minima íƒˆì¶œ ë° ê°€ì†.
    \item \textbf{RMSprop:} $S \leftarrow dW^2$. ê¸°ìš¸ê¸°ê°€ í¬ë©´ í•™ìŠµë¥ ì„ ë‚®ì¶° ì§„ë™ì„ ë°©ì§€.
    \item \textbf{Math:} $dW^2$ì€ ìš”ì†Œë³„ ì œê³±ì´ë‹¤. ë‚˜ëˆ—ì…ˆ ì‹œ $\epsilon$ì„ ë”í•´ ì—ëŸ¬ë¥¼ ë°©ì§€í•œë‹¤.
    \item \textbf{Hyperparam:} $\beta=0.9$, $\beta_2=0.999$ê°€ êµ­ë£°(Standard)ì´ë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}