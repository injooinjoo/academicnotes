\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{strategybox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ§­ #1 (ì „ëµ ê°€ì´ë“œ)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Structuring Machine Learning Projects: \\ Transfer Learning \& Multi-task Learning}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-6.] ML Strategy Basics \textit{- Completed}
    \item[\textbf{Chapter 7.}] \textbf{Advanced Learning Strategies (Current Unit)}
    \begin{itemize}
        \item 7.1 Error Analysis \textit{- Completed}
        \item 7.2 Data Mismatch \textit{- Completed}
        \item \textbf{7.3 Transfer Learning \& Multi-task Learning}
        \begin{itemize}
            \item Concept: Standing on the Shoulders of Giants
            \item Fine-tuning Strategies (Freeze vs Unfreeze)
            \item Multi-task Learning (Shared Representation)
            \item Implementation: Keras Code
        \end{itemize}
    \end{itemize}
    \item[Chapter 8.] End-to-End Deep Learning \textit{- Upcoming}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ëŠ” ëª¨ë¸ì„ ë°‘ë°”ë‹¥ë¶€í„°(Scratch) í•™ìŠµì‹œí‚¤ëŠ” ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ í˜„ì‹¤ ì„¸ê³„ì˜ ì—”ì§€ë‹ˆì–´ëŠ” \textbf{"ì•„ë¬´ê²ƒë„ ì—†ëŠ” ìƒíƒœì—ì„œ ì‹œì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."}
ì±…ì„ ì½ì„ ë•Œë§ˆë‹¤ 'ê°€ë‚˜ë‹¤ë¼'ë¶€í„° ë‹¤ì‹œ ë°°ìš°ì§€ ì•Šë“¯, AI ëª¨ë¸ë„ ë‚¨ì´ ì´ë¯¸ í•™ìŠµí•´ë‘” ì§€ì‹(Knowledge)ì„ ë¹Œë ¤ì™€ì„œ ìì‹ ì˜ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì´ \textbf{ì „ì´ í•™ìŠµ(Transfer Learning)}ì´ë©°, í˜„ëŒ€ ë”¥ëŸ¬ë‹ ì„±ê³µì˜ 90\%ëŠ” ì—¬ê¸°ì— ê¸°ì¸í•©ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ 'ë°ì´í„° ë¶€ì¡±'ì„ í•´ê²°í•˜ê³  í•™ìŠµ íš¨ìœ¨ì„ ê·¹ëŒ€í™”í•˜ëŠ” ë‘ ê°€ì§€ íŒ¨ëŸ¬ë‹¤ì„ì„ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{Transfer Learning:} ëŒ€ê·œëª¨ ë°ì´í„°(ImageNet)ë¡œ í•™ìŠµëœ ëª¨ë¸ì„ ê°€ì ¸ì™€ ë‚´ ë¬¸ì œ(X-ray)ì— ì ìš©í•˜ëŠ” ë²•ì„ ë°°ì›ë‹ˆë‹¤.
    \item \textbf{Fine-tuning:} ê°€ì¤‘ì¹˜ë¥¼ ê³ ì •(Freeze)í•˜ê±°ë‚˜ ë¯¸ì„¸ ì¡°ì •(Unfreeze)í•˜ëŠ” ë‹¨ê³„ë³„ ì „ëµì„ ìµí™ë‹ˆë‹¤.
    \item \textbf{Multi-task Learning:} í•˜ë‚˜ì˜ ëª¨ë¸ì´ ì—¬ëŸ¬ ì‘ì—…ì„ ë™ì‹œì— ìˆ˜í–‰í•˜ë©° ì§€ëŠ¥ì„ ë†’ì´ëŠ” ì›ë¦¬ë¥¼ ì´í•´í•©ë‹ˆë‹¤.
    \item \textbf{êµ¬í˜„:} Kerasë¥¼ í™œìš©í•´ Pre-trained Modelì„ ë¡œë“œí•˜ê³  ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ì˜ë¯¸} & \textbf{ë¹„ìœ } \\ \hline
\textbf{Transfer Learning} & ì§€ì‹ ì „ì´ (A $\to$ B) & ì˜ì–´ ì˜í•˜ëŠ” ì‚¬ëŒì´ ë¶ˆì–´ë„ ë¹¨ë¦¬ ë°°ì›€. \\ \hline
\textbf{Pre-trained Model} & ì‚¬ì „ í•™ìŠµëœ ëª¨ë¸ (Source) & ì´ë¯¸ ë°•ì‚¬ í•™ìœ„ë¥¼ ë°›ì€ ì „ë¬¸ê°€. \\ \hline
\textbf{Fine-tuning} & ë¯¸ì„¸ ì¡°ì • & ì „ë¬¸ê°€ì—ê²Œ ìš°ë¦¬ íšŒì‚¬ì˜ ì—…ë¬´ ë§¤ë‰´ì–¼ë§Œ ê°€ë¥´ì¹¨. \\ \hline
\textbf{Multi-task Learning} & ë™ì‹œ í•™ìŠµ (A \& B) & ìˆ˜í•™ê³¼ ë¬¼ë¦¬ë¥¼ ë™ì‹œì— ë°°ìš°ë©´ ì‹œë„ˆì§€ê°€ ë‚¨. \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ì§€ì‹ì˜ ì¬í™œìš©}

\subsection{1. Transfer Learning (ì „ì´ í•™ìŠµ)}


ë°ì´í„°ê°€ í’ë¶€í•œ \textbf{Task A(Source)}ì—ì„œ ë°°ìš´ ì§€ì‹ì„ ë°ì´í„°ê°€ ì ì€ \textbf{Task B(Target)}ë¡œ ì˜®ê¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ì•ë‹¨ (Early Layers):} ì—£ì§€, ê³¡ì„ , ì§ˆê° ë“± ë³´í¸ì ì¸ íŠ¹ì§•ì„ ë°°ì›ë‹ˆë‹¤. (ì¬í™œìš© ê°€ëŠ¥)
    \item \textbf{ë’·ë‹¨ (Later Layers):} êµ¬ì²´ì ì¸ ì‚¬ë¬¼(ê³ ì–‘ì´, ìë™ì°¨)ì„ ë°°ì›ë‹ˆë‹¤. (ìƒˆë¡œ í•™ìŠµ í•„ìš”)
\end{itemize}

\subsection{2. Multi-task Learning (ë‹¤ì¤‘ ì‘ì—… í•™ìŠµ)}


í•˜ë‚˜ì˜ ì‹ ê²½ë§ì´ ì—¬ëŸ¬ ì‘ì—…(Task A, B, C)ì„ ë™ì‹œì— ìˆ˜í–‰í•©ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{Shared Layers:} ëª¨ë“  ì‘ì—…ì— ê³µí†µì ìœ¼ë¡œ í•„ìš”í•œ ì €ìˆ˜ì¤€ íŠ¹ì§•(Low-level features)ì„ ê³µìœ í•©ë‹ˆë‹¤.
    \item \textbf{íš¨ê³¼:} ì„œë¡œ ë‹¤ë¥¸ ì‘ì—…ë“¤ì´ ì¼ì¢…ì˜ ë…¸ì´ì¦ˆ(Regularization) ì—­í• ì„ í•˜ì—¬ ê³¼ëŒ€ì í•©ì„ ë§‰ê³  ì¼ë°˜í™” ì„±ëŠ¥ì„ ë†’ì…ë‹ˆë‹¤.
    \item \textbf{ì˜ˆì‹œ:} ììœ¨ì£¼í–‰ (í‘œì§€íŒ ì¸ì‹ + ì‹ í˜¸ë“± ì¸ì‹ + ë³´í–‰ì ê°ì§€).
\end{itemize}

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Deep Dive: Fine-tuning Strategies}

"ë°ì´í„°ê°€ ì–¼ë§ˆë‚˜ ìˆëŠëƒ"ì— ë”°ë¼ ì „ëµì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤.

\begin{strategybox}{ë°ì´í„° ê·œëª¨ë³„ ì „ëµ}
\begin{enumerate}
    \item \textbf{Small Data (ë°ì´í„° ë§¤ìš° ì ìŒ):}
    \begin{itemize}
        \item \textbf{ì „ëµ:} Backbone ì „ì²´ ê³ ì • (\textbf{Freeze}).
        \item \textbf{í–‰ë™:} ë§ˆì§€ë§‰ ë¶„ë¥˜ê¸°(Head)ë§Œ ë–¼ì–´ë‚´ê³  ìƒˆë¡œ í•™ìŠµì‹œí‚µë‹ˆë‹¤.
    \end{itemize}
    
    \item \textbf{Medium Data (ì ë‹¹í•¨):}
    \begin{itemize}
        \item \textbf{ì „ëµ:} ì•ë‹¨ ì¼ë¶€ ê³ ì •, ë’·ë‹¨ ì¼ë¶€ í•´ì œ (\textbf{Fine-tuning}).
        \item \textbf{í–‰ë™:} ìƒìœ„ ì¸µ(Later Layers)ì˜ ê°€ì¤‘ì¹˜ë¥¼ ë¯¸ì„¸í•˜ê²Œ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
    \end{itemize}
    
    \item \textbf{Big Data (ë°ì´í„° ë§ìŒ):}
    \begin{itemize}
        \item \textbf{ì „ëµ:} ì „ì²´ ì¬í•™ìŠµ (\textbf{Retrain All}).
        \item \textbf{í–‰ë™:} ì‚¬ì „ í•™ìŠµëœ ê°€ì¤‘ì¹˜ë¥¼ ì´ˆê¸°ê°’(Initialization)ìœ¼ë¡œë§Œ ì“°ê³  ì „ì²´ë¥¼ ë‹¤ í•™ìŠµí•©ë‹ˆë‹¤.
    \end{itemize}
\end{enumerate}
\end{strategybox}

% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: Transfer Learning with Keras}

MobileNetV2ë¥¼ ê°€ì ¸ì™€ì„œ ì»¤ìŠ¤í…€ ë¶„ë¥˜ê¸°ë¥¼ ë§Œë“œëŠ” ì½”ë“œì…ë‹ˆë‹¤.

\begin{lstlisting}[language=Python, caption=Transfer Learning Pipeline, breaklines=true]
import tensorflow as tf
from tensorflow.keras import layers, models

def build_transfer_model(input_shape, num_classes):
    # 1. Load Pre-trained Model (MobileNetV2)
    # include_top=False: 1000ê°œ í´ë˜ìŠ¤ ë¶„ë¥˜ê¸°(Head)ëŠ” ë²„ë¦¼
    # weights='imagenet': ImageNetìœ¼ë¡œ í•™ìŠµëœ ê°€ì¤‘ì¹˜ ì‚¬ìš©
    base_model = tf.keras.applications.MobileNetV2(
        input_shape=input_shape,
        include_top=False, 
        weights='imagenet'
    )
    
    # 2. Freeze the Base Model (í•µì‹¬!)
    # ì—­ì „íŒŒ ì‹œ ì´ ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ëŠ” ë³€í•˜ì§€ ì•Šë„ë¡ ì ê¸ˆ
    base_model.trainable = False
    
    # 3. Add Custom Head
    model = models.Sequential([
        base_model,
        layers.GlobalAveragePooling2D(), # íŠ¹ì§•ë§µì„ ë²¡í„°ë¡œ ë³€í™˜
        layers.Dropout(0.2),             # ê³¼ëŒ€ì í•© ë°©ì§€
        layers.Dense(num_classes, activation='softmax') # ë‚´ ë¬¸ì œì— ë§ëŠ” ì¶œë ¥ì¸µ
    ])
    
    return model

# --- ì‹¤í–‰ ë° Fine-tuning ---
if __name__ == "__main__":
    model = build_transfer_model((160, 160, 3), 10)
    
    # 1ë‹¨ê³„: Headë§Œ í•™ìŠµ (BaseëŠ” ê³ ì •)
    model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['acc'])
    # model.fit(...) 
    
    # 2ë‹¨ê³„: Fine-tuning (Baseì˜ ì¼ë¶€ë¥¼ í’ˆ)
    base_model = model.layers[0]
    base_model.trainable = True
    
    # ì•ìª½ 100ê°œ ì¸µì€ ê³„ì† ê³ ì •, ë‚˜ë¨¸ì§€ ë’¤ìª½ë§Œ í•™ìŠµ
    fine_tune_at = 100
    for layer in base_model.layers[:fine_tune_at]:
        layer.trainable = False
        
    # ì¤‘ìš”: ë¯¸ì„¸ ì¡°ì • ì‹œì—ëŠ” í•™ìŠµë¥ ì„ ì•„ì£¼ ë‚®ê²Œ(1/10 ~ 1/100) ì¡ì•„ì•¼ í•¨
    model.compile(optimizer=tf.keras.optimizers.RMSprop(lr=1e-5),
                  loss='categorical_crossentropy', metrics=['acc'])
    # model.fit(...)
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\begin{warningbox}{ì²˜ìŒë¶€í„° Fine-tuningì„ í•˜ë©´ ì•ˆ ë˜ë‚˜ìš”?}
\textbf{ì ˆëŒ€ ì•ˆ ë©ë‹ˆë‹¤.}
ìƒˆë¡œ ë¶™ì¸ Head(ë¶„ë¥˜ê¸°)ëŠ” ëœë¤ ì´ˆê¸°í™” ìƒíƒœë¼ ì—‰ëš±í•œ ì˜¤ì°¨(Gradient)ë¥¼ ë¿œì–´ëƒ…ë‹ˆë‹¤. Base Modelì„ ê³ ì •í•˜ì§€ ì•Šìœ¼ë©´, ì´ í° ì˜¤ì°¨ ë•Œë¬¸ì— ì˜ í•™ìŠµë˜ì–´ ìˆë˜ Base Modelì˜ ê°€ì¤‘ì¹˜ê°€ ë‹¤ ë§ê°€ì ¸ë²„ë¦½ë‹ˆë‹¤ (\textbf{Catastrophic Forgetting}).
ë°˜ë“œì‹œ \textbf{Headë¥¼ ë¨¼ì € í•™ìŠµì‹œì¼œ ì•ˆì •í™”í•œ ë’¤}, Base Modelì„ í’€ì–´ì•¼ í•©ë‹ˆë‹¤.
\end{warningbox}

\textbf{Q. ì…ë ¥ ì´ë¯¸ì§€ í¬ê¸°ê°€ ë‹¬ë¼ë„ ë˜ë‚˜ìš”?} \\
\textbf{A.} CNNì˜ íŠ¹ì„±ìƒ ê°€ëŠ¥ì€ í•˜ì§€ë§Œ, ì„±ëŠ¥ì„ ìœ„í•´ ì‚¬ì „ í•™ìŠµ ëª¨ë¸ì´ ì‚¬ìš©í–ˆë˜ í¬ê¸°(ì˜ˆ: 224x224)ë¡œ ë¦¬ì‚¬ì´ì§•(Resize)í•´ì„œ ë„£ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ì´ê²ƒìœ¼ë¡œ 'ë¨¸ì‹ ëŸ¬ë‹ í”„ë¡œì íŠ¸ êµ¬ì¡°í™” ì „ëµ' íŒŒíŠ¸ë¥¼ ë§ˆì¹©ë‹ˆë‹¤. ì—¬ëŸ¬ë¶„ì€ ì´ì œ ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ì „ëµë¶€í„°, ë‚¨ì˜ ì§€ì‹ì„ ë¹Œë ¤ì˜¤ëŠ” ì „ëµê¹Œì§€ ëª¨ë‘ ê°–ì¶˜ \textbf{ì „ëµê°€}ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.

ë‹¤ìŒ ì±•í„°ë¶€í„°ëŠ” ë”¥ëŸ¬ë‹ì„ ë”ìš± ê¹Šì´ ìˆê²Œ ë§Œë“œëŠ” \textbf{[End-to-End Deep Learning]}ì˜ ê°œë…ê³¼, ì´ê²ƒì´ ì „í†µì ì¸ íŒŒì´í”„ë¼ì¸ ë°©ì‹ê³¼ ì–´ë–»ê²Œ ë‹¤ë¥¸ì§€ ë¹„êµ ë¶„ì„í•˜ë©° ì‹œì‘í•´ ë³´ê² ìŠµë‹ˆë‹¤. ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{Transfer Learning:} ë¹…ë°ì´í„° ëª¨ë¸(Source)ì„ ì†ŒëŸ‰ ë°ì´í„° ë¬¸ì œ(Target)ì— ì¬í™œìš©í•œë‹¤.
    \item \textbf{Freeze:} ì´ˆê¸° í•™ìŠµ ì‹œì—ëŠ” Backboneì„ ê³ ì •í•˜ê³  Headë§Œ í•™ìŠµí•œë‹¤.
    \item \textbf{Fine-tune:} ë°ì´í„°ê°€ ì¶©ë¶„í•˜ë©´ Backboneì˜ ì¼ë¶€ë¥¼ í’€ì–´ ë¯¸ì„¸ ì¡°ì •í•œë‹¤. (Low LR í•„ìˆ˜)
    \item \textbf{Multi-task:} ì—¬ëŸ¬ ì‘ì—…ì„ ë™ì‹œì— ë°°ìš°ë©´ ì¼ë°˜í™” ì„±ëŠ¥ì´ ì¢‹ì•„ì§„ë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}