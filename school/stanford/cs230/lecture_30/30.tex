\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{featurebox}[1]{
    colback=purple!5!white,
    colframe=purple!80!black,
    fonttitle=\bfseries,
    title=ğŸ” #1 (í•µì‹¬ íŠ¹ì§•)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Convolutional Neural Networks: \\ Pooling Layers}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-8.] Deep Learning Strategy \& Architecture \textit{- Completed}
    \item[\textbf{Chapter 9.}] \textbf{Convolutional Neural Networks (Current Part)}
    \begin{itemize}
        \item 9.1 CNN Foundations: Convolution, Padding, Strides \textit{- Completed}
        \item \textbf{9.2 Pooling Layers (Max/Average)}
        \begin{itemize}
            \item Concept: Downsampling \& Invariance
            \item Max Pooling vs Average Pooling
            \item Channel Independence Rule
            \item Implementation
        \end{itemize}
        \item 9.3 CNN Example: LeNet-5 \textit{- Upcoming}
    \end{itemize}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ì— ìš°ë¦¬ëŠ” í•©ì„±ê³±(Conv) ì—°ì‚°ìœ¼ë¡œ ì´ë¯¸ì§€ì˜ íŠ¹ì§•ì„ ì¶”ì¶œí•˜ëŠ” ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ í•©ì„±ê³± ì¸µë§Œ ê³„ì† ìŒ“ìœ¼ë©´ ì—°ì‚°ëŸ‰ì´ ë„ˆë¬´ ë§ì•„ì§€ê³ , ëª¨ë¸ì´ ì´ë¯¸ì§€ì˜ ë¯¸ì„¸í•œ ë³€í™”(1í”½ì…€ ì´ë™ ë“±)ì— ë„ˆë¬´ ë¯¼ê°í•´ì§‘ë‹ˆë‹¤.
ìš°ë¦¬ëŠ” \textbf{"ì¤‘ìš”í•œ íŠ¹ì§•ë§Œ ë‚¨ê¸°ê³ , í¬ê¸°ëŠ” ì¤„ì—¬ì„œ íš¨ìœ¨ì ìœ¼ë¡œ"} ì²˜ë¦¬í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤. ì´ ë‘ ë§ˆë¦¬ í† ë¼ë¥¼ ì¡ëŠ” ê¸°ìˆ ì´ ë°”ë¡œ \textbf{í’€ë§(Pooling)}ì…ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ CNNì˜ í•µì‹¬ êµ¬ì„± ìš”ì†Œì¸ í’€ë§ ì¸µì˜ ì›ë¦¬ì™€ ì¢…ë¥˜ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ë‹¤ìš´ìƒ˜í”Œë§:} ì´ë¯¸ì§€ í¬ê¸°($n_H, n_W$)ë¥¼ ì¤„ì—¬ ê³„ì‚°ëŸ‰ì„ ë‚®ì¶”ëŠ” ì›ë¦¬ë¥¼ ì´í•´í•©ë‹ˆë‹¤.
    \item \textbf{ë¶ˆë³€ì„±:} í’€ë§ì´ ì–´ë–»ê²Œ í‰í–‰ ì´ë™ì— ëŒ€í•œ \textbf{ê°•ê±´í•¨(Invariance)}ì„ ì œê³µí•˜ëŠ”ì§€ ë°°ì›ë‹ˆë‹¤.
    \item \textbf{ë¹„êµ:} ê°€ì¥ ë„ë¦¬ ì“°ì´ëŠ” \textbf{Max Pooling}ê³¼ ê³¼ê±°ì— ì“°ì˜€ë˜ \textbf{Average Pooling}ì„ ë¹„êµí•©ë‹ˆë‹¤.
    \item \textbf{íŠ¹ì§•:} í’€ë§ ì¸µì—ëŠ” \textbf{í•™ìŠµ íŒŒë¼ë¯¸í„°($W, b$)ê°€ ì—†ë‹¤}ëŠ” ì ì„ ëª…ì‹¬í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ì˜ë¯¸} & \textbf{í•µì‹¬ ì—­í• } \\ \hline
\textbf{Max Pooling} & ì˜ì—­ ë‚´ ìµœëŒ“ê°’ ì„ íƒ & ê°€ì¥ ê°•í•œ íŠ¹ì§•ë§Œ ë‚¨ê¹€ (ëŒ€ì„¸). \\ \hline
\textbf{Average Pooling} & ì˜ì—­ ë‚´ í‰ê· ê°’ ê³„ì‚° & ì •ë³´ë¥¼ ë¶€ë“œëŸ½ê²Œ ìš”ì•½í•¨. \\ \hline
\textbf{Invariant} & ë¶ˆë³€ì„± & ì…ë ¥ì´ ì¡°ê¸ˆ ë°”ë€Œì–´ë„ ì¶œë ¥ì€ ë³€í•˜ì§€ ì•ŠìŒ. \\ \hline
\textbf{Hyperparameters} & $f$(í•„í„° í¬ê¸°), $s$(ìŠ¤íŠ¸ë¼ì´ë“œ) & í’€ë§ ë™ì‘ì„ ê²°ì •í•˜ëŠ” ì„¤ì •ê°’. \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ìš”ì•½ì˜ ê¸°ìˆ }

\subsection{1. Max Pooling (ìµœëŒ€ í’€ë§)}


ê°€ì¥ ë„ë¦¬ ì“°ì´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. í•„í„° ì˜ì—­($f \times f$) ë‚´ì—ì„œ \textbf{ê°€ì¥ í° ìˆ«ì í•˜ë‚˜}ë§Œ ê³¨ë¼ëƒ…ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ë™ì‘:} $2 \times 2$ ìœˆë„ìš°ë¡œ ì´ë¯¸ì§€ë¥¼ í›‘ìœ¼ë©° ìµœëŒ“ê°’ì„ ë½‘ìŠµë‹ˆë‹¤.
    \item \textbf{ì˜ë¯¸:} "ì´ êµ¬ì—­ì— ê³ ì–‘ì´ ëˆˆ(íŠ¹ì§•)ì´ ìˆëŠ”ê°€?" $\rightarrow$ \textbf{YES (ë†’ì€ ê°’)}. ì •í™•íˆ ì–´ë””(ì¢Œìƒë‹¨? ìš°í•˜ë‹¨?)ì— ìˆëŠ”ì§€ëŠ” ì¤‘ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¡´ì¬ ìœ ë¬´ë§Œ ê°•ì¡°í•©ë‹ˆë‹¤.
\end{itemize}

\subsection{2. Average Pooling (í‰ê·  í’€ë§)}


í•„í„° ì˜ì—­ ë‚´ì˜ ìˆ«ìë¥¼ ëª¨ë‘ ë”í•´ í‰ê· ì„ ëƒ…ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ì˜ë¯¸:} íŠ¹ì§•ì„ ë¶€ë“œëŸ½ê²Œ(Smoothing) ë§Œë“­ë‹ˆë‹¤.
    \item \textbf{ìš©ë„:} ê³¼ê±°ì—ëŠ” ë§ì´ ì¼ìœ¼ë‚˜ ìµœê·¼ì—ëŠ” ì˜ ì•ˆ ì”ë‹ˆë‹¤. ë‹¨, ëª¨ë¸ì˜ ë§¨ ë§ˆì§€ë§‰ë‹¨(Global Average Pooling)ì—ì„œëŠ” ì—¬ì „íˆ ìœ ìš©í•©ë‹ˆë‹¤.
\end{itemize}

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Deep Dive: Channel Independence}

ì´ ë¶€ë¶„ì´ í•©ì„±ê³±(Convolution)ê³¼ ê°€ì¥ í—·ê°ˆë¦¬ëŠ” ì§€ì ì…ë‹ˆë‹¤.

\begin{featurebox}{ì±„ë„ ë…ë¦½ì„±ì˜ ë²•ì¹™}
\begin{itemize}
    \item \textbf{Convolution:} ì…ë ¥ ì±„ë„(RGB 3ê°œ)ì„ \textbf{ëª¨ë‘ í•©ì³ì„œ(Sum)} í•˜ë‚˜ì˜ ìˆ«ìë¡œ ë§Œë“­ë‹ˆë‹¤. ì±„ë„ ìˆ˜ê°€ ë³€í•©ë‹ˆë‹¤.
    \item \textbf{Pooling:} ê° ì±„ë„ì„ \textbf{ë…ë¦½ì ìœ¼ë¡œ(Independently)} ì²˜ë¦¬í•©ë‹ˆë‹¤.
    \begin{itemize}
        \item ì…ë ¥: $32 \times 32 \times \mathbf{10}$
        \item í’€ë§: $16 \times 16 \times \mathbf{10}$
        \item \textbf{ê²°ê³¼:} ë†’ì´/ë„ˆë¹„ëŠ” ì¤„ì§€ë§Œ, \textbf{ì±„ë„ ìˆ˜(ê¹Šì´)ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€}ë©ë‹ˆë‹¤.
    \end{itemize}
\end{itemize}
\end{featurebox}

\begin{warningbox}{íŒŒë¼ë¯¸í„° ê°œìˆ˜ëŠ” ëª‡ ê°œ?}
í’€ë§ ì¸µì—ëŠ” í•™ìŠµí•´ì•¼ í•  ê°€ì¤‘ì¹˜($W$)ë‚˜ í¸í–¥($b$)ì´ ìˆì„ê¹Œìš”?
\textbf{ì •ë‹µ: 0ê°œì…ë‹ˆë‹¤.}
í’€ë§ì€ ìš°ë¦¬ê°€ ì •í•´ì¤€ ê·œì¹™($f, s$, Max/Avg)ëŒ€ë¡œë§Œ ê³„ì‚°í•˜ëŠ” ê³ ì •ëœ í•¨ìˆ˜ì…ë‹ˆë‹¤. ì—­ì „íŒŒ ë•Œ ì—…ë°ì´íŠ¸ë  ëŒ€ìƒì´ ì—†ìŠµë‹ˆë‹¤.
\end{warningbox}

% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: NumPy Pooling}

ì›ë¦¬ ì´í•´ë¥¼ ìœ„í•´ 4ì¤‘ ë£¨í”„ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ì ‘ êµ¬í˜„í•´ ë´…ë‹ˆë‹¤.

\begin{lstlisting}[language=Python, caption=Max \& Average Pooling Implementation, breaklines=true]
import numpy as np

class Pooling:
    def __init__(self, f=2, s=2, mode='max'):
        self.f = f
        self.s = s
        self.mode = mode

    def forward(self, A_prev):
        """
        A_prev: (m, n_H, n_W, n_C)
        """
        (m, n_H_prev, n_W_prev, n_C_prev) = A_prev.shape
        
        # ì¶œë ¥ í¬ê¸° ê³„ì‚° (ê³µì‹ ì ìš©)
        n_H = int((n_H_prev - self.f) / self.s) + 1
        n_W = int((n_W_prev - self.f) / self.s) + 1
        n_C = n_C_prev # ì±„ë„ ìˆ˜ëŠ” ê·¸ëŒ€ë¡œ!
        
        A = np.zeros((m, n_H, n_W, n_C))
        
        for i in range(m):              # ë°ì´í„° ìƒ˜í”Œ
            for h in range(n_H):        # ì„¸ë¡œ ì´ë™
                for w in range(n_W):    # ê°€ë¡œ ì´ë™
                    for c in range(n_C):# ì±„ë„ (ë…ë¦½ì )
                        
                        # ìœˆë„ìš° ìŠ¬ë¼ì´ì‹±
                        vert_start = h * self.s
                        vert_end   = vert_start + self.f
                        horiz_start= w * self.s
                        horiz_end  = horiz_start + self.f
                        
                        slice_A = A_prev[i, vert_start:vert_end, horiz_start:horiz_end, c]
                        
                        if self.mode == 'max':
                            A[i, h, w, c] = np.max(slice_A)
                        elif self.mode == 'average':
                            A[i, h, w, c] = np.mean(slice_A)
        return A

# --- ì‹¤í–‰ ---
if __name__ == "__main__":
    # 4x4 ì´ë¯¸ì§€, ì±„ë„ 1ê°œ
    img = np.array([[[[1],[3],[2],[1]],
                     [[2],[9],[1],[1]],
                     [[1],[3],[2],[3]],
                     [[5],[6],[1],[2]]]]) # shape (1,4,4,1)
    
    pool = Pooling(f=2, s=2, mode='max')
    out = pool.forward(img)
    
    print("Input:\n", img[0,:,:,0])
    print("Max Pool Output:\n", out[0,:,:,0])
    # ì˜ˆìƒ: [[9, 2], [6, 3]]
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\textbf{Q. í’€ë§ì„ í•˜ë©´ ì •ë³´ê°€ ì‚¬ë¼ì§€ëŠ”ë° ê´œì°®ë‚˜ìš”?} \\
\textbf{A.} ë„¤, ê·¸ê²Œ ëª©ì ì…ë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ë°°ê²½ì´ë‚˜ ë…¸ì´ì¦ˆëŠ” ë²„ë¦¬ê³ , \textbf{"ì—¬ê¸° íŠ¹ì§•ì´ ìˆë‹¤!"(Max Value)}ë¼ëŠ” í•µì‹¬ ì •ë³´ë§Œ ë‚¨ê²¨ì„œ ë‹¤ìŒ ì¸µìœ¼ë¡œ ì „ë‹¬í•˜ëŠ” ê²ƒì´ CNNì˜ ì¶”ìƒí™” ê³¼ì •ì…ë‹ˆë‹¤.

\textbf{Q. $f=3, s=2$ ê°™ì€ ê±´ ì–¸ì œ ì“°ë‚˜ìš”?} \\
\textbf{A.} ë³´í†µì€ $f=2, s=2$ (í¬ê¸° ì ˆë°˜ ì¶•ì†Œ)ê°€ êµ­ë£°ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ê²¹ì¹˜ëŠ” ì˜ì—­ì„ ë‘ê³  ì‹¶ì„ ë•Œ(Overlapping Pooling) $f=3, s=2$ë¥¼ ì“°ê¸°ë„ í•©ë‹ˆë‹¤ (ì˜ˆ: AlexNet).

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ì´ì œ ìš°ë¦¬ëŠ” CNNì„ ë§Œë“œëŠ” 3ëŒ€ ìš”ì†Œì¸ \textbf{Convolution, ReLU(Activation), Pooling}ì„ ëª¨ë‘ ë°°ì› ìŠµë‹ˆë‹¤. ë ˆê³  ë¸”ë¡ì´ ë‹¤ ëª¨ì˜€ìŠµë‹ˆë‹¤.

ì´ì œ ì´ê²ƒë“¤ì„ ì–´ë–»ê²Œ ì¡°ë¦½í•´ì•¼ í• ê¹Œìš”?
ë‹¤ìŒ ì‹œê°„ì—ëŠ” ì´ ë¸”ë¡ë“¤ì„ ê²°í•©í•˜ì—¬ ìˆ«ì í•„ê¸°ì²´(MNIST)ë¥¼ ì¸ì‹í•˜ëŠ” ì „ì„¤ì ì¸ CNN ì•„í‚¤í…ì²˜, \textbf{[LeNet-5 Example]}ì„ í†µí•´ ì²« ë²ˆì§¸ ì™„ì „í•œ CNN ëª¨ë¸ì„ êµ¬ì¶•í•´ë³´ê² ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{Max Pooling:} ì˜ì—­ ë‚´ ìµœëŒ“ê°’ë§Œ ë‚¨ê²¨ íŠ¹ì§•ì„ ê°•ì¡°í•œë‹¤. (ê°€ì¥ ë§ì´ ì”€)
    \item \textbf{Dimension:} ê°€ë¡œ/ì„¸ë¡œëŠ” ì¤„ì–´ë“¤ì§€ë§Œ, \textbf{ì±„ë„ ìˆ˜($n_C$)ëŠ” ìœ ì§€ëœë‹¤.}
    \item \textbf{Parameters:} í•™ìŠµí•  ê°€ì¤‘ì¹˜($W$)ê°€ ì—†ë‹¤. (Parameter-free)
    \item \textbf{Effect:} ì—°ì‚°ëŸ‰ì„ ì¤„ì´ê³ , ì´ë™ ë¶ˆë³€ì„±(Invariance)ì„ ì–»ëŠ”ë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}