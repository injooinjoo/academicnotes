\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{formulabox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ§® #1 (í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Sequence Models: \\ Transformers \& Self-Attention}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-9.] Deep Learning Fundamentals \& CNNs \textit{- Completed}
    \item[\textbf{Chapter 10.}] \textbf{Sequence Models (Current Part)}
    \begin{itemize}
        \item 10.1-10.11 RNN, LSTM, Attention Mechanism \textit{- Completed}
        \item \textbf{10.12 Transformers \& Modern Attention}
        \begin{itemize}
            \item Self-Attention: Understanding Relationships
            \item The Q, K, V Framework (Query, Key, Value)
            \item Multi-Head Attention: Parallel Perspectives
            \item Beyond Transformers: LLM and ViT
        \end{itemize}
    \end{itemize}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ì— ë°°ìš´ 'ì–´í…ì…˜'ì´ RNNì´ë¼ëŠ” ì—”ì§„ì˜ ì„±ëŠ¥ì„ ë†’ì—¬ì£¼ëŠ” ë³´ì¡° ì¥ì¹˜ì˜€ë‹¤ë©´, ì˜¤ëŠ˜ ë°°ìš¸ \textbf{íŠ¸ëœìŠ¤í¬ë¨¸(Transformer)}ëŠ” ê·¸ ì—”ì§„ ìì²´ë¥¼ í†µì§¸ë¡œ ê°ˆì•„ì¹˜ìš´ í˜ëª…ì…ë‹ˆë‹¤. 
êµ¬ê¸€ì˜ 2017ë…„ ë…¼ë¬¸ \textbf{"Attention Is All You Need"}ëŠ” ìˆœì°¨ì  ì²˜ë¦¬(RNN)ë¥¼ ë²„ë¦¬ê³  ì˜¤ì§ ì–´í…ì…˜ë§Œìœ¼ë¡œ ë¬¸ì¥ì„ ì´í•´í•  ìˆ˜ ìˆìŒì„ ì¦ëª…í–ˆìŠµë‹ˆë‹¤. ì´ê²ƒì´ ë°”ë¡œ ChatGPTì™€ ëª¨ë“  ê±°ëŒ€ ì–¸ì–´ ëª¨ë¸(LLM)ì˜ íƒ„ìƒ ì§€ì ì…ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ í˜„ëŒ€ AI ì‹œìŠ¤í…œì˜ ì¤‘ì¶”ì¸ íŠ¸ëœìŠ¤í¬ë¨¸ ì•„í‚¤í…ì²˜ì˜ í•µì‹¬ ì›ë¦¬ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{Self-Attention:} ë¬¸ì¥ ë‚´ ë‹¨ì–´ë“¤ì´ ì„œë¡œ ì–´ë–¤ ê´€ê³„ë¥¼ ë§ºê³  ìˆëŠ”ì§€ ìŠ¤ìŠ¤ë¡œ í•™ìŠµí•˜ëŠ” ì›ë¦¬ë¥¼ ë°°ì›ë‹ˆë‹¤.
    \item \textbf{Q, K, V:} ì •ë³´ ê²€ìƒ‰ì˜ ê´€ì ì—ì„œ ì–´í…ì…˜ì„ ê³„ì‚°í•˜ëŠ” ì„¸ ê°€ì§€ êµ¬ì„± ìš”ì†Œ(Query, Key, Value)ë¥¼ íŒŒì•…í•©ë‹ˆë‹¤.
    \item \textbf{Multi-Head:} ì—¬ëŸ¬ ê°œì˜ ì–´í…ì…˜ì„ ë³‘ë ¬ë¡œ ìˆ˜í–‰í•˜ì—¬ ë‹¤ê°ì ì¸ ë¬¸ë§¥ì„ ì¶”ì¶œí•˜ëŠ” ì´ìœ ë¥¼ í•™ìŠµí•©ë‹ˆë‹¤.
    \item \textbf{ë³‘ë ¬ì„±:} RNNê³¼ ë‹¬ë¦¬ ë¬¸ì¥ ì „ì²´ë¥¼ ë™ì‹œì— ì²˜ë¦¬í•¨ìœ¼ë¡œì¨ ì–»ëŠ” ê³„ì‚° íš¨ìœ¨ì„±ì„ ì´í•´í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology: The QKV Framework}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ì˜ë¯¸} & \textbf{ì—­í• } \\ \hline
\textbf{Query (Q)} & ì§ˆë¬¸ & "ì§€ê¸ˆ ë‚´ê°€ ì°¾ê³  ì‹¶ì€ ì •ë³´ëŠ” ë¬´ì—‡ì¸ê°€?" \\ \hline
\textbf{Key (K)} & ì¸ë±ìŠ¤/ìƒ‰ì¸ & "ë‚´ê°€ ê°€ì§„ ì •ë³´ì˜ í‚¤ì›Œë“œëŠ” ë¬´ì—‡ì¸ê°€?" \\ \hline
\textbf{Value (V)} & ë‚´ìš© & "í‚¤ì›Œë“œì— í•´ë‹¹í•˜ëŠ” ì‹¤ì œ ê°’ì€ ë¬´ì—‡ì¸ê°€?" \\ \hline
\textbf{Scaled Dot-Product} & ìœ ì‚¬ë„ ê³„ì‚° & Qì™€ Kë¥¼ ê³±í•´ ì ìˆ˜ë¥¼ ë‚´ê³  ë£¨íŠ¸ ì°¨ì›ìœ¼ë¡œ ë‚˜ëˆ”. \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ìê¸° ìì‹ ì„ ëŒì•„ë³´ê¸°}

\subsection{1. Self-Attention: ëŒ€ëª…ì‚¬ í•´ê²°}
RNNì€ ë‹¨ì–´ë¥¼ ìˆœì„œëŒ€ë¡œ ì½ì—ˆì§€ë§Œ, íŠ¸ëœìŠ¤í¬ë¨¸ëŠ” ë¬¸ì¥ ì•ˆì˜ ëª¨ë“  ë‹¨ì–´ ìŒ ì‚¬ì´ì˜ ê´€ê³„ë¥¼ \textbf{í•œ ë²ˆì—} ê³„ì‚°í•©ë‹ˆë‹¤.

\begin{analogybox}{"it"ì€ ëˆ„êµ¬ì¸ê°€?}
\textbf{"The animal didn't cross the street because it was too tired."} \\
Self-Attentionì€ "it"ì´ë¼ëŠ” ë‹¨ì–´ë¥¼ ì²˜ë¦¬í•  ë•Œ ë¬¸ì¥ì˜ ëª¨ë“  ë‹¨ì–´ë¥¼ í›‘ìŠµë‹ˆë‹¤.
ëª¨ë¸ì€ "animal"ê³¼ì˜ ì–´í…ì…˜ ì ìˆ˜ë¥¼ ê°€ì¥ ë†’ê²Œ ì£¼ì–´, \textbf{"it = animal"}ì„ì„ ìŠ¤ìŠ¤ë¡œ ê¹¨ë‹«ê²Œ ë©ë‹ˆë‹¤.
\end{analogybox}



\subsection{2. Multi-Head Attention}
í•˜ë‚˜ì˜ ì–´í…ì…˜ë§Œìœ¼ë¡œëŠ” ë³µì¡í•œ ë¬¸ë§¥ì„ ë‹¤ ë‹´ê¸° ì–´ë µìŠµë‹ˆë‹¤. íŠ¸ëœìŠ¤í¬ë¨¸ëŠ” ì—¬ëŸ¬ ê°œì˜ 'í—¤ë“œ'ë¥¼ ë³‘ë ¬ë¡œ ìš´ì˜í•©ë‹ˆë‹¤.

\begin{itemize}
    \item \textbf{Head 1:} ì£¼ì–´ì™€ ë™ì‚¬ì˜ ê´€ê³„ì— ì§‘ì¤‘
    \item \textbf{Head 2:} í˜•ìš©ì‚¬ì™€ ëª…ì‚¬ì˜ ê´€ê³„ì— ì§‘ì¤‘
    \item \textbf{Head 3:} ëŒ€ëª…ì‚¬ì™€ ì„ í–‰ì‚¬ì˜ ê´€ê³„ì— ì§‘ì¤‘
\end{itemize}
ì´ ë‹¤ì–‘í•œ ê´€ì ë“¤ì„ ë‚˜ì¤‘ì— í•˜ë‚˜ë¡œ í•©ì³(\textbf{Concatenate}) í’ë¶€í•œ ì´í•´ë ¥ì„ ê°–ê²Œ ë©ë‹ˆë‹¤.

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Deep Dive: The Attention Math}

íŠ¸ëœìŠ¤í¬ë¨¸ì˜ ì‹¬ì¥ì¸ Scaled Dot-Product Attentionì˜ ìˆ˜ì‹ì…ë‹ˆë‹¤.

\begin{formulabox}{Scaled Dot-Product Attention}
$$ \text{Attention}(Q, K, V) = \text{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right)V $$
\begin{itemize}
    \item $QK^T$: Queryì™€ Key ì‚¬ì´ì˜ ìœ ì‚¬ë„ ì ìˆ˜.
    \item $\sqrt{d_k}$: ì°¨ì›ì´ ì»¤ì§ˆ ë•Œ ì ìˆ˜ê°€ ë„ˆë¬´ ì»¤ì ¸ Softmax ê¸°ìš¸ê¸°ê°€ ì†Œì‹¤ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ëŠ” \textbf{Scaling} ê³„ìˆ˜.
    \item $V$: ìµœì¢…ì ìœ¼ë¡œ ê°€ì¤‘ì¹˜ë¥¼ ê³±í•´ ì •ë³´ë¥¼ ì·¨í•©í•  ì‹¤ì œ ê°’.
\end{itemize}
\end{formulabox}



% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: Conceptual Logic}

TensorFlowë¥¼ ì´ìš©í•œ ì–´í…ì…˜ì˜ í•µì‹¬ ë¡œì§ì…ë‹ˆë‹¤.

\begin{lstlisting}[language=Python, caption=Scaled Dot-Product Attention, breaklines=true]
import tensorflow as tf

def scaled_dot_product_attention(q, k, v, mask=None):
    # 1. ìœ ì‚¬ë„ Score ê³„ì‚°
    matmul_qk = tf.matmul(q, k, transpose_b=True)

    # 2. Scaling (ë£¨íŠ¸ ì°¨ì›ë§Œí¼ ë‚˜ëˆ„ê¸°)
    dk = tf.cast(tf.shape(k)[-1], tf.float32)
    scaled_logits = matmul_qk / tf.math.sqrt(dk)

    # 3. Softmaxë¥¼ í†µí•´ ê°€ì¤‘ì¹˜ ê²°ì •
    attention_weights = tf.nn.softmax(scaled_logits, axis=-1)

    # 4. Valueë¥¼ ê°€ì¤‘ í•©í•˜ì—¬ ìµœì¢… ì¶œë ¥
    output = tf.matmul(attention_weights, v)

    return output, attention_weights
\end{lstlisting}

% --- 8. í˜„ëŒ€ì  íŠ¸ë Œë“œ ---
\section{Modern Trends: Beyond Transformers}

íŠ¸ëœìŠ¤í¬ë¨¸ ì´í›„ AIì˜ íŒ¨ëŸ¬ë‹¤ì„ì€ í¬ê²Œ í™•ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.

\begin{itemize}
    \item \textbf{LLM (ê±°ëŒ€ ì–¸ì–´ ëª¨ë¸):} GPT, Llama ë“± íŠ¸ëœìŠ¤í¬ë¨¸ ë¸”ë¡ì„ ìˆ˜ë°± ê°œ ìŒ“ì•„ ì¸ê°„ ìˆ˜ì¤€ì˜ ì¶”ë¡ ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
    \item \textbf{ViT (Vision Transformer):} ì´ë¯¸ì§€ë„ íŒ¨ì¹˜ë¡œ ë‚˜ëˆ„ì–´ ì–´í…ì…˜ì„ ì ìš©í•©ë‹ˆë‹¤. ì´ì œ ì»´í“¨í„° ë¹„ì „ì—ì„œë„ íŠ¸ëœìŠ¤í¬ë¨¸ê°€ ëŒ€ì„¸ì…ë‹ˆë‹¤.
    \item \textbf{Efficiency:} ë¬¸ì¥ì´ ê¸¸ì–´ì§ˆ ë•Œ ê³„ì‚°ëŸ‰ì´ $N^2$ìœ¼ë¡œ í­ë°œí•˜ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ FlashAttention ë“±ì´ í™œë°œíˆ ì—°êµ¬ë©ë‹ˆë‹¤.
\end{itemize}



% --- 9. ìš”ì•½ ë° ë§ˆë¬´ë¦¬ ---
\section*{ğŸ Course Conclusion}
\begin{summarybox}{ìµœì¢… ìš”ì•½}
\begin{enumerate}
    \item \textbf{Self-Attention:} ë‹¨ì–´ ê°„ì˜ ìœ ê¸°ì  ê´€ê³„ë¥¼ í•œ ë²ˆì— íŒŒì•…í•˜ëŠ” í˜ì‹ ì  ë°©ì‹.
    \item \textbf{No More RNN:} ë³‘ë ¬ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•´ì ¸ ëª¨ë¸ì˜ ê±°ëŒ€í™”ê°€ ê°€ëŠ¥í•´ì§.
    \item \textbf{Versatility:} í…ìŠ¤íŠ¸ë¥¼ ë„˜ì–´ ì´ë¯¸ì§€, ì˜¤ë””ì˜¤ ë“± ëª¨ë“  ë„ë©”ì¸ìœ¼ë¡œ í™•ì¥ ì¤‘.
\end{enumerate}
\end{summarybox}

ì¶•í•˜í•©ë‹ˆë‹¤! Seq2Seqì—ì„œ ì‹œì‘í•´ ì–´í…ì…˜ì„ ê±°ì³, ì„¸ìƒì„ ë°”ê¾¸ê³  ìˆëŠ” íŠ¸ëœìŠ¤í¬ë¨¸ì˜ ì›ë¦¬ê¹Œì§€ ëª¨ë‘ ë§ˆìŠ¤í„°í•˜ì…¨ìŠµë‹ˆë‹¤. ì—¬ëŸ¬ë¶„ì€ ì´ì œ í˜„ëŒ€ ë”¥ëŸ¬ë‹ì˜ ì •ì ì— ì„œ ìˆìŠµë‹ˆë‹¤.

\end{document}