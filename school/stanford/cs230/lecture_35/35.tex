\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{formulabox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ§® #1 (ìˆ˜í•™ì  ì •ì˜)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Convolutional Neural Networks: \\ YOLO Algorithm (Object Detection)}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-8.] Deep Learning Strategy \& Architecture \textit{- Completed}
    \item[\textbf{Chapter 9.}] \textbf{Convolutional Neural Networks (Current Part)}
    \begin{itemize}
        \item 9.1-9.6 CNN Basics \& Sliding Windows \textit{- Completed}
        \item \textbf{9.7 YOLO Algorithm (You Only Look Once)}
        \begin{itemize}
            \item The Grid System \& Bounding Box Regression
            \item IoU (Intersection over Union) Metric
            \item Non-max Suppression (Removing Duplicates)
            \item Anchor Boxes (Handling Overlap)
        \end{itemize}
    \end{itemize}
    \item[Chapter 10.] Sequence Models (RNN) \textit{- Next Part}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ì— ë°°ìš´ ìŠ¬ë¼ì´ë”© ìœˆë„ìš°ëŠ” í•©ì„±ê³± êµ¬í˜„ìœ¼ë¡œ ì†ë„ëŠ” ë¹¨ë¼ì¡Œì§€ë§Œ, ì—¬ì „íˆ \textbf{"ë°•ìŠ¤ ìœ„ì¹˜ê°€ ë¶€ì •í™•í•˜ë‹¤"}ëŠ” í•œê³„ê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ìœˆë„ìš°ê°€ ê³ ì •ëœ ê°„ê²©ìœ¼ë¡œë§Œ ì›€ì§ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
"ê°ì²´ì˜ ì¤‘ì‹¬ì„ ì°¾ê³ , ê·¸ ì¤‘ì‹¬ì„ ê¸°ì¤€ìœ¼ë¡œ ë°•ìŠ¤ í¬ê¸°ë¥¼ ì˜ˆì¸¡í•˜ë©´ ì–´ë–¨ê¹Œ?"
ì´ ì•„ì´ë””ì–´ë¡œ íƒ„ìƒí•œ ê²ƒì´ \textbf{YOLO}ì…ë‹ˆë‹¤. ì´ë¦„ì²˜ëŸ¼ ì´ë¯¸ì§€ë¥¼ ë‹¨ í•œ ë²ˆë§Œ ë³´ê³ (Look Once), ëª¨ë“  ê°ì²´ì˜ ìœ„ì¹˜ì™€ ì¢…ë¥˜ë¥¼ ë™ì‹œì— ì°¾ì•„ë‚´ëŠ” í˜ì‹ ì ì¸ ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ ì‹¤ì‹œê°„ ê°ì²´ íƒì§€ì˜ í‘œì¤€ì¸ YOLO ì•Œê³ ë¦¬ì¦˜ì˜ ì›ë¦¬ë¥¼ ì™„ë²½íˆ ì´í•´í•©ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ê·¸ë¦¬ë“œ:} ì´ë¯¸ì§€ë¥¼ ê²©ìë¡œ ë‚˜ëˆ„ê³ , ê°ì²´ ì¤‘ì‹¬ì ì´ ì†í•œ ì…€ì´ ì±…ì„ì„ ì§€ëŠ” êµ¬ì¡°ë¥¼ ë°°ì›ë‹ˆë‹¤.
    \item \textbf{IoU:} ë‘ ë°•ìŠ¤ê°€ ì–¼ë§ˆë‚˜ ê²¹ì¹˜ëŠ”ì§€ë¥¼ ì¸¡ì •í•˜ëŠ” í‰ê°€ ì§€í‘œë¥¼ ìˆ˜í•™ì ìœ¼ë¡œ ì •ì˜í•©ë‹ˆë‹¤.
    \item \textbf{NMS:} ì¤‘ë³µëœ ë°•ìŠ¤ë¥¼ ì œê±°í•˜ëŠ” ë¹„ìµœëŒ€ ì–µì œ(Non-max Suppression) ì•Œê³ ë¦¬ì¦˜ì„ ìµí™ë‹ˆë‹¤.
    \item \textbf{ì•µì»¤:} ê²¹ì¹œ ë¬¼ì²´ë¥¼ ë¶„ë¦¬í•˜ëŠ” ì•µì»¤ ë°•ìŠ¤(Anchor Box) ê°œë…ì„ íŒŒì•…í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ì•½ì–´} & \textbf{ì„¤ëª…} \\ \hline
\textbf{Grid Cell} & - & ì´ë¯¸ì§€ë¥¼ $S \times S$ë¡œ ë‚˜ëˆˆ ì‘ì€ êµ¬ì—­. \\ \hline
\textbf{IoU} & Intersection over Union & êµì§‘í•© ì˜ì—­ / í•©ì§‘í•© ì˜ì—­. (ì¼ì¹˜ë„) \\ \hline
\textbf{NMS} & Non-max Suppression & ê°€ì¥ í™•ì‹¤í•œ ë°•ìŠ¤ í•˜ë‚˜ë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ëŠ” ì§€ì›€. \\ \hline
\textbf{Anchor Box} & - & ë¯¸ë¦¬ ì •ì˜ëœ ë°•ìŠ¤ ëª¨ì–‘. (ê¸¸ì­‰í•œ ì‚¬ëŒ, ë„“ì€ ì°¨ ë“±) \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ë‹¨ í•œ ë²ˆì˜ ì¶”ë¡ }

\subsection{1. Bounding Box Predictions (ê·¸ë¦¬ë“œ ì‹œìŠ¤í…œ)}


YOLOëŠ” ì´ë¯¸ì§€ë¥¼ $S \times S$ ê·¸ë¦¬ë“œ(ë³´í†µ $19 \times 19$)ë¡œ ë‚˜ëˆ•ë‹ˆë‹¤.
ê° ì…€ì€ ë‹¤ìŒ ë²¡í„° $y$ë¥¼ ì˜ˆì¸¡í•©ë‹ˆë‹¤.
$$ y = [p_c, b_x, b_y, b_h, b_w, c_1, c_2, \dots]^T $$
\begin{itemize}
    \item $p_c$: ê°ì²´ê°€ ìˆì„ í™•ë¥  (Confidence).
    \item $b_x, b_y$: ë°•ìŠ¤ ì¤‘ì‹¬ ì¢Œí‘œ (ì…€ ë‚´ ìƒëŒ€ ìœ„ì¹˜, 0~1).
    \item $b_h, b_w$: ë°•ìŠ¤ ë†’ì´/ë„ˆë¹„ (ì „ì²´ ì´ë¯¸ì§€ ëŒ€ë¹„ ë¹„ìœ¨).
    \item $c_i$: í´ë˜ìŠ¤ í™•ë¥  (ì°¨, ì‚¬ëŒ ë“±).
\end{itemize}

\subsection{2. IoU (Intersection over Union)}


ëª¨ë¸ì´ ì˜ˆì¸¡í•œ ë°•ìŠ¤ê°€ ì •ë‹µê³¼ ì–¼ë§ˆë‚˜ ë¹„ìŠ·í•œì§€ í‰ê°€í•˜ëŠ” ì²™ë„ì…ë‹ˆë‹¤.
\begin{formulabox}{IoU ìˆ˜ì‹}
$$ \text{IoU} = \frac{\text{êµì§‘í•© ì˜ì—­ (Intersection)}}{\text{í•©ì§‘í•© ì˜ì—­ (Union)}} $$
\begin{itemize}
    \item ë³´í†µ $\text{IoU} \ge 0.5$ ì´ë©´ "ì˜¬ë°”ë¥¸ íƒì§€"ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤.
    \item 1ì´ë©´ ì™„ë²½í•˜ê²Œ ì¼ì¹˜, 0ì´ë©´ ì „í˜€ ê²¹ì¹˜ì§€ ì•ŠìŒ.
\end{itemize}
\end{formulabox}

\subsection{3. Anchor Boxes (ê²¹ì¹œ ë¬¼ì²´ í•´ê²°)}
í•œ ì…€ì˜ ì¤‘ì‹¬ì— ì‚¬ëŒê³¼ ì°¨ê°€ ê²¹ì³ ìˆë‹¤ë©´?
ê¸°ì¡´ ë²¡í„°ë¡œëŠ” í•˜ë‚˜ë§Œ ì˜ˆì¸¡ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ë¯¸ë¦¬ ì •ì˜ëœ ëª¨ì–‘(ì•µì»¤)ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
$$ y = [\text{Anchor 1}, \text{Anchor 2}] $$
\begin{itemize}
    \item \textbf{Anchor 1 (ì„¸ë¡œë¡œ ê¸´):} ì‚¬ëŒ ë‹´ë‹¹.
    \item \textbf{Anchor 2 (ê°€ë¡œë¡œ ë„“ì€):} ìë™ì°¨ ë‹´ë‹¹.
\end{itemize}

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Deep Dive: Non-max Suppression (NMS)}

YOLOëŠ” í•˜ë‚˜ì˜ ê°ì²´ì— ëŒ€í•´ ì—¬ëŸ¬ ì…€ì´ "ë‚´ê°€ ì°¾ì•˜ë‹¤!"ë©° ë°•ìŠ¤ë¥¼ ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¤‘ë³µì„ ì œê±°í•´ì•¼ í•©ë‹ˆë‹¤.

\begin{enumerate}
    \item \textbf{Filter:} $p_c < 0.6$ ì¸ ë°•ìŠ¤(í™•ì‹  ì—†ëŠ” ê²ƒ)ëŠ” ëª¨ë‘ ë²„ë¦½ë‹ˆë‹¤.
    \item \textbf{Select:} ë‚¨ì€ ë°•ìŠ¤ ì¤‘ $p_c$ê°€ ê°€ì¥ ë†’ì€ ê²ƒì„ ì„ íƒí•©ë‹ˆë‹¤ (Best Box).
    \item \textbf{Suppress:} ì„ íƒëœ ë°•ìŠ¤ì™€ $\text{IoU} \ge 0.5$ ì¸(ë§ì´ ê²¹ì¹œ) ë‹¤ë¥¸ ë°•ìŠ¤ë“¤ì€ "ê°™ì€ ë¬¼ì²´ë¥¼ ì¤‘ë³µ íƒì§€í•œ ê²ƒ"ìœ¼ë¡œ ë³´ê³  ì§€ì›ë‹ˆë‹¤.
    \item \textbf{Repeat:} ë°•ìŠ¤ê°€ ë‹¤ ì •ë¦¬ë  ë•Œê¹Œì§€ ë°˜ë³µí•©ë‹ˆë‹¤.
\end{enumerate}

% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: IoU Calculation}

IoU ê³„ì‚°ì€ ê°ì²´ íƒì§€ ì„±ëŠ¥ í‰ê°€ì™€ NMS êµ¬í˜„ì˜ í•µì‹¬ì…ë‹ˆë‹¤.

\begin{lstlisting}[language=Python, caption=IoU Calculation Function, breaklines=true]
def calculate_iou(box1, box2):
    """
    box: (x1, y1, x2, y2)ì¢Œí‘œ (ì¢Œìƒë‹¨, ìš°í•˜ë‹¨)
    """
    (b1_x1, b1_y1, b1_x2, b1_y2) = box1
    (b2_x1, b2_y1, b2_x2, b2_y2) = box2
    
    # 1. êµì§‘í•©(Intersection) ì¢Œí‘œ ê³„ì‚°
    xi1 = max(b1_x1, b2_x1)
    yi1 = max(b1_y1, b2_y1)
    xi2 = min(b1_x2, b2_x2)
    yi2 = min(b1_y2, b2_y2)
    
    # ë„“ì´ (ìŒìˆ˜ë©´ 0)
    inter_area = max(0, xi2 - xi1) * max(0, yi2 - yi1)
    
    # 2. í•©ì§‘í•©(Union) ë„“ì´ ê³„ì‚°
    b1_area = (b1_x2 - b1_x1) * (b1_y2 - b1_y1)
    b2_area = (b2_x2 - b2_x1) * (b2_y2 - b2_y1)
    union_area = b1_area + b2_area - inter_area
    
    # 3. IoU
    return inter_area / (union_area + 1e-6)

# --- í…ŒìŠ¤íŠ¸ ---
if __name__ == "__main__":
    box_a = (1, 1, 3, 3) # ë©´ì  4
    box_b = (2, 2, 4, 4) # ë©´ì  4, êµì§‘í•© 1
    # í•©ì§‘í•© = 4 + 4 - 1 = 7
    # IoU = 1/7 = 0.1428...
    
    print(f"IoU: {calculate_iou(box_a, box_b):.4f}")
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\begin{warningbox}{ì¢Œí‘œê³„ ì£¼ì˜}
YOLOì˜ ì¶œë ¥ $b_x, b_y$ëŠ” \textbf{ê·¸ë¦¬ë“œ ì…€ ë‚´ë¶€ì—ì„œì˜ ìƒëŒ€ ìœ„ì¹˜(0~1)}ì…ë‹ˆë‹¤. ì‹¤ì œ ì´ë¯¸ì§€ ìœ„ì— ë°•ìŠ¤ë¥¼ ê·¸ë¦¬ë ¤ë©´, ì…€ì˜ ìœ„ì¹˜(ì¸ë±ìŠ¤)ë¥¼ ë”í•˜ê³  ì´ë¯¸ì§€ í¬ê¸°ë¥¼ ê³±í•´ì£¼ëŠ” ë³€í™˜ ê³¼ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.
\end{warningbox}

\textbf{Q. ì•µì»¤ ë°•ìŠ¤ í¬ê¸°ëŠ” ì–´ë–»ê²Œ ì •í•˜ë‚˜ìš”?} \\
\textbf{A.} ë³´í†µ í›ˆë ¨ ë°ì´í„°ì— ìˆëŠ” ê°ì²´ë“¤ì˜ ì‹¤ì œ ë°•ìŠ¤ í¬ê¸°ë¥¼ ëª¨ì•„ì„œ \textbf{K-Means í´ëŸ¬ìŠ¤í„°ë§}ì„ ëŒë¦½ë‹ˆë‹¤. ê°€ì¥ ë¹ˆë²ˆí•˜ê²Œ ë“±ì¥í•˜ëŠ” ëŒ€í‘œì ì¸ ëª¨ì–‘ 5~9ê°œë¥¼ ì„ ì •í•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤ (YOLO v2ë¶€í„° ì ìš©).

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ì´ê²ƒìœ¼ë¡œ ì»´í“¨í„° ë¹„ì „(CNN) íŒŒíŠ¸ë¥¼ ë§ˆì¹©ë‹ˆë‹¤. ì´ì œ ì—¬ëŸ¬ë¶„ì€ ì •ì§€ëœ ì´ë¯¸ì§€ì—ì„œ ì‚¬ë¬¼ì„ ë¶„ë¥˜í•˜ê³  ìœ„ì¹˜ê¹Œì§€ ì°¾ì•„ë‚´ëŠ” ê¸°ìˆ ì„ ìŠµë“í–ˆìŠµë‹ˆë‹¤.

í•˜ì§€ë§Œ ì„¸ìƒì€ ë©ˆì¶° ìˆì§€ ì•ŠìŠµë‹ˆë‹¤. ìœ íŠœë¸Œ ì˜ìƒ, ìŒì„± ì¸ì‹, ì£¼ê°€ ì˜ˆì¸¡, ë²ˆì—­ ë“±ì€ \textbf{ì‹œê°„ì˜ íë¦„(Sequence)}ì´ ìˆëŠ” ë°ì´í„°ì…ë‹ˆë‹¤.
ë‹¤ìŒ ì‹œê°„ë¶€í„°ëŠ” \textbf{[Part 5. Sequence Models]}ì˜ ì„¸ê³„ë¡œ ë– ë‚©ë‹ˆë‹¤. ì‹œê³„ì—´ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ì‹ ê²½ë§, \textbf{RNN (Recurrent Neural Networks)}ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{YOLO:} ê·¸ë¦¬ë“œ ì…€ë§ˆë‹¤ ë°”ìš´ë”© ë°•ìŠ¤ë¥¼ íšŒê·€(Regression)ë¡œ ì§ì ‘ ì˜ˆì¸¡í•œë‹¤.
    \item \textbf{IoU:} êµì§‘í•©/í•©ì§‘í•©. ë°•ìŠ¤ ìœ„ì¹˜ ì •í™•ë„ì˜ ì²™ë„ì´ì NMSì˜ ê¸°ì¤€.
    \item \textbf{NMS:} ì¤‘ë³µëœ ë°•ìŠ¤ë¥¼ ì œê±°í•˜ì—¬ ê°ì²´ë‹¹ í•˜ë‚˜ì˜ ë°•ìŠ¤ë§Œ ë‚¨ê¸´ë‹¤.
    \item \textbf{Anchor:} ë‹¤ì–‘í•œ ë¹„ìœ¨ì˜ ê°ì²´ë¥¼ ì¡ê¸° ìœ„í•´ ë¯¸ë¦¬ ì •ì˜ëœ ë°•ìŠ¤ ëª¨ì–‘ì„ ì“´ë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}