\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{tipbox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì‹¤ì „ íŒ)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Improving Deep Neural Networks: \\ Data Augmentation \& Early Stopping}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-4.] Neural Networks Basics \textit{- Completed}
    \item[\textbf{Chapter 5.}] \textbf{Practical Aspects of Deep Learning (Current Unit)}
    \begin{itemize}
        \item 5.1-5.3 Regularization (L2, Dropout) \textit{- Completed}
        \item \textbf{5.4 Data Augmentation \& Early Stopping}
        \begin{itemize}
            \item Concept: Free Data \& Time Machine
            \item Augmentation Techniques (Flip, Crop, Rotate)
            \item Early Stopping Mechanism (Patience)
            \item Implementation: On-the-fly Generation
        \end{itemize}
        \item 5.5 Input Normalization \textit{- Upcoming}
    \end{itemize}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ìš°ë¦¬ëŠ” L2 ì •ê·œí™”ì™€ ë“œë¡­ì•„ì›ƒì´ë¼ëŠ” ê°•ë ¥í•œ ìˆ˜í•™ì  ê¸°ë²•ìœ¼ë¡œ ê³¼ëŒ€ì í•©(Overfitting)ì„ ì–µì œí–ˆìŠµë‹ˆë‹¤.
ì˜¤ëŠ˜ì€ ì¡°ê¸ˆ ë” \textbf{'ì‹¤ìš©ì ì´ê³ (Practical)' 'ê²½ì œì ì¸(Economical)'} ì ‘ê·¼ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤.
ë°ì´í„°ë¥¼ ë” ëª¨ìœ¼ëŠ” ê²ƒì€ ë¹„ìŒ‰ë‹ˆë‹¤. í•˜ì§€ë§Œ ê°€ì§€ê³  ìˆëŠ” ë°ì´í„°ë¥¼ ë³€í˜•í•´ì„œ \textbf{'ê³µì§œ ë°ì´í„°'}ë¥¼ ë§Œë“œëŠ” ê¸°ìˆ (Augmentation)ê³¼, í•™ìŠµì„ ê°€ì¥ ì¢‹ì€ íƒ€ì´ë°ì— ë©ˆì¶”ëŠ” \textbf{'íƒ€ì„ë¨¸ì‹ '} ê¸°ìˆ (Early Stopping)ì€ ë¹„ìš© ëŒ€ë¹„ íš¨ê³¼ê°€ ì—„ì²­ë‚©ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ ëª¨ë¸ì˜ ì¼ë°˜í™” ì„±ëŠ¥ì„ ë†’ì´ëŠ” ê°€ì¥ ì§ê´€ì ì´ê³  ê°€ì„±ë¹„ ì¢‹ì€ ë‘ ê°€ì§€ ê¸°ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{Data Augmentation:} ì´ë¯¸ì§€ë¥¼ ë³€í˜•í•˜ì—¬ ë°ì´í„°ì…‹ì„ ë»¥íŠ€ê¸°í•˜ê³ , ëª¨ë¸ì—ê²Œ \textbf{ë¶ˆë³€ì„±(Invariance)}ì„ ê°€ë¥´ì¹©ë‹ˆë‹¤.
    \item \textbf{Early Stopping:} ê³¼ëŒ€ì í•©ì´ ì‹œì‘ë˜ê¸° ì§ì „ì— í•™ìŠµì„ ë©ˆì¶”ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•©ë‹ˆë‹¤.
    \item \textbf{On-the-fly:} ë””ìŠ¤í¬ ìš©ëŸ‰ì„ ì•„ë¼ê¸° ìœ„í•´ í•™ìŠµ ë„ì¤‘ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³€í˜•í•˜ëŠ” íŒŒì´í”„ë¼ì¸ì„ ì´í•´í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ì„¤ëª…} & \textbf{ë¹„ìœ } \\ \hline
\textbf{Data Augmentation} & ì›ë³¸ ë°ì´í„°ë¥¼ ë³€í˜•í•´ ê°€ì§œ ë°ì´í„°ë¥¼ ìƒì„± & ë³µì‚¬ê¸°ë¡œ ë¬¸ì œì§‘ ë³µì‚¬í•˜ê¸° (ê·¼ë° ì•½ê°„ ë¹„ëš¤ê²Œ) \\ \hline
\textbf{Early Stopping} & ì„±ëŠ¥ ì•…í™” ì‹œì ì— í•™ìŠµ ì¤‘ë‹¨ & ë°•ìˆ˜ ì¹  ë•Œ ë– ë‚˜ë¼ \\ \hline
\textbf{Patience} & ì„±ëŠ¥ì´ ì•ˆ ì¢‹ì•„ì ¸ë„ ê¸°ë‹¤ë ¤ì£¼ëŠ” íšŸìˆ˜ & "í•œ ë²ˆë§Œ ë” ê¸°íšŒë¥¼ ì¤„ê²Œ" \\ \hline
\textbf{On-the-fly} & ë¯¸ë¦¬ ì €ì¥í•˜ì§€ ì•Šê³  í•„ìš”í•  ë•Œ ì¦‰ì„ ìƒì„± & ì£¼ë¬¸ ë“¤ì–´ì˜¤ë©´ ìš”ë¦¬í•˜ê¸° (ë¯¸ë¦¬ í•´ë‘ë©´ ìƒí•¨) \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ê³µì§œ ì ì‹¬ì€ ìˆë‹¤}

\subsection{1. Data Augmentation (ë°ì´í„° ì¦ê°•)}
ëª¨ë¸ì—ê²Œ \textbf{"ê³ ì–‘ì´ëŠ” ë’¤ì§‘ì–´ë„, ì–´ë‘ì›Œë„, ì˜ë ¤ë„ ê³ ì–‘ì´ë‹¤"}ë¼ëŠ” ì‚¬ì‹¤ì„ ê°€ë¥´ì¹©ë‹ˆë‹¤.

\begin{itemize}
    \item \textbf{Mirroring (Flipping):} ê±°ìš¸ì²˜ëŸ¼ ì¢Œìš° ë°˜ì „. (ìˆ«ì ì¸ì‹ ë“± ë°©í–¥ì´ ì¤‘ìš”í•œ ë°ì´í„°ì—” ê¸ˆì§€!)
    \item \textbf{Random Cropping:} ì´ë¯¸ì§€ì˜ ì¼ë¶€ë¶„ì„ ë¬´ì‘ìœ„ë¡œ ì˜ë¼ëƒ„.
    \item \textbf{Rotation / Shearing:} íšŒì „ ë° ë¹„í‹€ê¸°.
    \item \textbf{Color Jittering:} ë°ê¸°, ì±„ë„ ë“±ì— ë…¸ì´ì¦ˆ ì¶”ê°€.
\end{itemize}



\begin{tipbox}{On-the-fly Generation (ì‹¤ì‹œê°„ ìƒì„±)}
"êµìˆ˜ë‹˜, ë³€í˜•ëœ ì´ë¯¸ì§€ë¥¼ í•˜ë“œë””ìŠ¤í¬ì— ì €ì¥í•´ë‘ê³  ì¨ì•¼ í•©ë‹ˆê¹Œ?"
\textbf{ì ˆëŒ€ ì•„ë‹™ë‹ˆë‹¤.} 1TBì§œë¦¬ ë°ì´í„°ì…‹ì„ 10ë°° ì¦ê°•í•˜ë©´ 10TBê°€ ë©ë‹ˆë‹¤. ê°ë‹¹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
\textbf{CPUê°€ í•™ìŠµ ë„ì¤‘ì— ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€í˜•}í•´ì„œ GPUì—ê²Œ ë„˜ê²¨ì£¼ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ë””ìŠ¤í¬ ìš©ëŸ‰ì€ ê·¸ëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤.
\end{tipbox}

\vspace{0.5cm}\hrule\vspace{0.5cm}

\subsection{2. Early Stopping (ì¡°ê¸° ì¢…ë£Œ)}
í•™ìŠµ ê³¡ì„ (Learning Curve)ì„ ë³´ë‹¤ê°€, Train ErrorëŠ” ì¤„ì§€ë§Œ Dev Errorê°€ ë‹¤ì‹œ ì˜¬ë¼ê°€ë ¤ëŠ” ìˆœê°„(ê³¼ëŒ€ì í•© ì‹œì‘ì )ì— ë©ˆì¶¥ë‹ˆë‹¤.



\begin{itemize}
    \item \textbf{ì›ë¦¬:} í•™ìŠµì„ ì˜¤ë˜ í•˜ë©´ ê°€ì¤‘ì¹˜ $W$ê°€ ì ì  ì»¤ì ¸ì„œ ë³µì¡í•œ íŒ¨í„´ì„ ìµíˆê²Œ ë©ë‹ˆë‹¤. Early Stoppingì€ $W$ê°€ ë„ˆë¬´ ì»¤ì§€ê¸° ì „ì— ë©ˆì¶”ë¯€ë¡œ, ìˆ˜í•™ì ìœ¼ë¡œ \textbf{L2 ì •ê·œí™”ì™€ ìœ ì‚¬í•œ íš¨ê³¼}ë¥¼ ëƒ…ë‹ˆë‹¤.
    \item \textbf{ë‹¨ì  (Orthogonalization):} Andrew Ng êµìˆ˜ëŠ” ì´ ë°©ì‹ì´ 'Bias ì¤„ì´ê¸°'ì™€ 'Variance ì¤„ì´ê¸°'ë¥¼ ë™ì‹œì— ê±´ë“œë¦¬ê¸° ë•Œë¬¸ì—(ì§êµí™” ìœ„ë°°), íŠœë‹ì´ ë³µì¡í•´ì§ˆ ìˆ˜ ìˆë‹¤ê³  ì§€ì í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ í¸í•´ì„œ ë§ì´ ì”ë‹ˆë‹¤.
\end{itemize}

% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: On-the-fly Pipeline}

ë°ì´í„° ì¦ê°•ì€ NumPyë¡œ ê°„ë‹¨íˆ, ì¡°ê¸° ì¢…ë£ŒëŠ” í´ë˜ìŠ¤ë¡œ êµ¬í˜„í•˜ì—¬ ì›ë¦¬ë¥¼ íŒŒì•…í•©ë‹ˆë‹¤.

\begin{lstlisting}[language=Python, caption=Data Augmentation \& Early Stopping, breaklines=true]
import numpy as np
import copy

class DataAugmentor:
    @staticmethod
    def random_flip(image, p=0.5):
        """ì¢Œìš° ë°˜ì „"""
        if np.random.rand() < p:
            return np.fliplr(image)
        return image

    @staticmethod
    def random_crop(image, crop_size=(200, 200)):
        """ë¬´ì‘ìœ„ ìœ„ì¹˜ ìë¥´ê¸°"""
        h, w, _ = image.shape
        top = np.random.randint(0, h - crop_size[0])
        left = np.random.randint(0, w - crop_size[1])
        return image[top:top+crop_size[0], left:left+crop_size[1], :]

class EarlyStopping:
    def __init__(self, patience=5, min_delta=0.0):
        self.patience = patience # ì°¸ì„ì„± (íšŸìˆ˜)
        self.min_delta = min_delta # ìµœì†Œ ê°œì„ í­
        self.counter = 0
        self.best_loss = np.inf
        self.best_model = None
        self.stop = False

    def check(self, val_loss, model_params):
        if val_loss < (self.best_loss - self.min_delta):
            # ì„±ëŠ¥ ê°œì„ ! -> ì €ì¥ ë° ì¹´ìš´í„° ì´ˆê¸°í™”
            self.best_loss = val_loss
            self.counter = 0
            # ì¤‘ìš”: deepcopyë¡œ ê°’ ìì²´ë¥¼ ë³µì‚¬í•´ë‘¬ì•¼ í•¨ (ì°¸ì¡° ë³µì‚¬ ê¸ˆì§€)
            self.best_model = copy.deepcopy(model_params)
        else:
            # ì„±ëŠ¥ ì •ì²´/ì•…í™” -> ì¹´ìš´í„° ì¦ê°€
            self.counter += 1
            print(f"EarlyStopping counter: {self.counter}/{self.patience}")
            if self.counter >= self.patience:
                self.stop = True
    
    def restore(self):
        return self.best_model
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\begin{warningbox}{Deep Copyë¥¼ ì•ˆ ì“°ë©´ ìƒê¸°ëŠ” ì¼}
íŒŒì´ì¬ì—ì„œ `best_model = model`ì´ë¼ê³  ì“°ë©´, `best_model`ì€ `model`ì„ ê°€ë¦¬í‚¤ëŠ” ë³„ëª…ì´ ë  ë¿ì…ë‹ˆë‹¤. í•™ìŠµì´ ê³„ì† ì§„í–‰ë˜ì–´ `model`ì´ ë§ê°€ì§€ë©´ `best_model`ë„ ê°™ì´ ë§ê°€ì§‘ë‹ˆë‹¤.
ë°˜ë“œì‹œ `copy.deepcopy(model)`ì„ ì‚¬ìš©í•˜ì—¬ \textbf{ê·¸ ìˆœê°„ì˜ ìŠ¤ëƒ…ìƒ·}ì„ ë©”ëª¨ë¦¬ì— ë”°ë¡œ ì €ì¥í•´ì•¼ í•©ë‹ˆë‹¤.
\end{warningbox}

\textbf{Q. Data Augmentationì„ Test Setì—ë„ ì ìš©í•˜ë‚˜ìš”?} \\
\textbf{A.} ë³´í†µì€ ì•ˆ í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì„±ëŠ¥ì„ ê·¹ëŒ€í™”í•˜ê¸° ìœ„í•´ 'Test Time Augmentation (TTA)'ì´ë¼ëŠ” ê¸°ë²•ì„ ì“°ê¸°ë„ í•©ë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ ì´ë¯¸ì§€ë¥¼ 5ê°€ì§€ë¡œ ë³€í˜•í•´ì„œ ì˜ˆì¸¡í•œ ë’¤ í‰ê· ì„ ë‚´ëŠ” ê²ƒì…ë‹ˆë‹¤. (ëŒ€íšŒìš© í…Œí¬ë‹‰)

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ì´ì œ ìš°ë¦¬ëŠ” ê³¼ëŒ€ì í•©ì„ ë§‰ëŠ” ëª¨ë“  ë¬´ê¸°(L2, Dropout, Augmentation, Early Stopping)ë¥¼ ê°–ì·„ìŠµë‹ˆë‹¤. ë°©ì–´ ì¤€ë¹„ëŠ” ëë‚¬ìŠµë‹ˆë‹¤.

ì´ì œ ê³µê²©(í•™ìŠµ ì†ë„)ì„ ê°•í™”í•  ì°¨ë¡€ì…ë‹ˆë‹¤. ê²½ì‚¬ í•˜ê°•ë²•(Gradient Descent)ì€ ë„ˆë¬´ ì •ì§í•´ì„œ ëŠë¦½ë‹ˆë‹¤.
ë‹¤ìŒ ì‹œê°„ì—ëŠ” \textbf{[Optimization Algorithms]}ìœ¼ë¡œ ë„˜ì–´ê°€ì„œ, ê²½ì‚¬ í•˜ê°•ë²•ì— ê°€ì†ë„ë¥¼ ë¶™ì´ëŠ” \textbf{Momentum}, ë³´í­ì„ ì¡°ì ˆí•˜ëŠ” \textbf{Adam} ë“± ìµœì‹  ìµœì í™” ê¸°ë²•ì„ ë°°ìš°ê² ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{Augmentation:} ë°ì´í„°ë¥¼ ë³€í˜•í•´ ì–‘ì„ ëŠ˜ë¦¬ê³  ë¶ˆë³€ì„±(Invariance)ì„ í•™ìŠµì‹œí‚¨ë‹¤.
    \item \textbf{On-the-fly:} ë””ìŠ¤í¬ ì ˆì•½ì„ ìœ„í•´ í•™ìŠµ ë„ì¤‘ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€í˜•í•œë‹¤.
    \item \textbf{Early Stopping:} Dev Errorê°€ ì˜¤ë¥´ê¸° ì‹œì‘í•˜ë©´ ë©ˆì¶˜ë‹¤. (ê³¼ëŒ€ì í•© ë°©ì§€)
    \item \textbf{Patience:} ì¼ì‹œì ì¸ ì„±ëŠ¥ ì €í•˜ë¥¼ ê²¬ë””ê¸° ìœ„í•´ ì¸ë‚´ì‹¬(Patience) ê°’ì„ ì„¤ì •í•œë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}