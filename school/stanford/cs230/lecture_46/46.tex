\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{architecturebox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ—ï¸ #1 (êµ¬ì¡° ë¶„ì„)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Sequence Models: \\ Sequence-to-Sequence (Seq2Seq)}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-9.] Deep Learning Fundamentals \& CNNs \textit{- Completed}
    \item[\textbf{Chapter 10.}] \textbf{Sequence Models (Current Part)}
    \begin{itemize}
        \item 10.1-10.7 RNN, Embedding, Debiasing \textit{- Completed}
        \item \textbf{10.8 Sequence-to-Sequence (Seq2Seq)}
        \begin{itemize}
            \item The Problem: Different Lengths ($T_x \neq T_y$)
            \item Encoder-Decoder Architecture
            \item Context Vector (The Information Bottleneck)
            \item Teacher Forcing (Training Trick)
        \end{itemize}
        \item 10.9 Beam Search \textit{- Upcoming}
    \end{itemize}
    \item[Chapter 11.] Attention Mechanism \textit{- Next Part}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ê¹Œì§€ ìš°ë¦¬ëŠ” ë‹¨ì–´ë¥¼ ë²¡í„°ë¡œ ë°”ê¾¸ëŠ” ë²•(Embedding)ì„ ë°°ì› ìŠµë‹ˆë‹¤. ì´ì œ ë‹¨ì–´ë“¤ì„ ì¡°ë¦½í•´ ë¬¸ì¥ì„ ë§Œë“¤ê³ , ë²ˆì—­í•˜ëŠ” ì‹œìŠ¤í…œì„ ë§Œë“¤ ì°¨ë¡€ì…ë‹ˆë‹¤.
ê·¸ëŸ°ë° ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.
\textbf{ì…ë ¥:} "I love you" (3ë‹¨ì–´) $\rightarrow$ \textbf{ì¶œë ¥:} "Je t'aime" (2ë‹¨ì–´).
ê¸¸ì´ê°€ ë‹¤ë¦…ë‹ˆë‹¤. ê¸°ì¡´ RNNì€ ì´ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ êµ¬ê¸€ì´ ì œì•ˆí•œ í˜ëª…ì ì¸ ì•„í‚¤í…ì²˜, \textbf{Seq2Seq (Encoder-Decoder)}ë¥¼ ë°°ì›ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ ì…ë ¥ê³¼ ì¶œë ¥ì˜ ê¸¸ì´ê°€ ë‹¤ë¥¸ ì‹œí€€ìŠ¤ ë³€í™˜ ëª¨ë¸ì„ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{êµ¬ì¡°:} ì…ë ¥ ì‹œí€€ìŠ¤ë¥¼ ì••ì¶•í•˜ëŠ” \textbf{ì¸ì½”ë”}ì™€, ì´ë¥¼ í’€ì–´ë‚´ëŠ” \textbf{ë””ì½”ë”} êµ¬ì¡°ë¥¼ ì´í•´í•©ë‹ˆë‹¤.
    \item \textbf{ì••ì¶•:} ì¸ì½”ë”ì˜ ë§ˆì§€ë§‰ ì€ë‹‰ ìƒíƒœê°€ ë¬¸ì¥ ì „ì²´ì˜ ì˜ë¯¸ë¥¼ ë‹´ì€ \textbf{ë¬¸ë§¥ ë²¡í„°(Context Vector)}ê°€ ë¨ì„ íŒŒì•…í•©ë‹ˆë‹¤.
    \item \textbf{ì „ë‹¬:} ë¬¸ë§¥ ë²¡í„°ê°€ ë””ì½”ë”ì˜ ì´ˆê¸° ìƒíƒœë¡œ ì „ë‹¬ë˜ëŠ” íë¦„ì„ ì½”ë“œë¡œ êµ¬í˜„í•©ë‹ˆë‹¤.
    \item \textbf{í•œê³„:} ë¬¸ì¥ì´ ê¸¸ì–´ì§€ë©´ ì •ë³´ê°€ ì†ì‹¤ë˜ëŠ” \textbf{ë³‘ëª©(Bottleneck)} í˜„ìƒì„ ì¸ì§€í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ì—­í• } & \textbf{ë¹„ìœ } \\ \hline
\textbf{Encoder} & ì…ë ¥ ë¬¸ì¥ì„ ì½ê³  ì´í•´í•¨. & ë¬¸ì¥ì„ ì½ëŠ” ë²ˆì—­ê°€. \\ \hline
\textbf{Decoder} & ì´í•´í•œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ë¬¸ì¥ì„ ìƒì„±í•¨. & ë²ˆì—­ë¬¸ì„ ì“°ëŠ” ë²ˆì—­ê°€. \\ \hline
\textbf{Context Vector} & ì¸ì½”ë”ê°€ ë„˜ê²¨ì£¼ëŠ” í•µì‹¬ ì •ë³´ (ë§ˆì§€ë§‰ $h$). & ë¨¸ë¦¿ì†ì— ì •ë¦¬ëœ ë¬¸ì¥ì˜ ì˜ë¯¸. \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ë‹¤ ë“£ê³  ë§í•˜ê¸°}

\subsection{1. The Architecture: Encoder-Decoder}
Seq2SeqëŠ” ë‘ ê°œì˜ RNNì„ ì´ì–´ ë¶™ì¸ êµ¬ì¡°ì…ë‹ˆë‹¤.



\begin{itemize}
    \item \textbf{Encoder:} ë¬¸ì¥ $x^{\langle 1 \rangle} \dots x^{\langle T_x \rangle}$ë¥¼ ìˆœì„œëŒ€ë¡œ ì½ìŠµë‹ˆë‹¤. ì¶œë ¥ì„ ë‚´ì§€ ì•Šê³  ì€ë‹‰ ìƒíƒœ($h$)ë§Œ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. ë§ˆì§€ë§‰ ìƒíƒœ $h^{\langle T_x \rangle}$ì— ëª¨ë“  ì •ë³´ë¥¼ ì••ì¶•í•©ë‹ˆë‹¤.
    \item \textbf{Decoder:} ì¸ì½”ë”ê°€ ì¤€ ë¬¸ë§¥ ë²¡í„°ë¥¼ \textbf{ìì‹ ì˜ ì´ˆê¸° ìƒíƒœ($h^{\langle 0 \rangle}_{dec}$)}ë¡œ ë°›ìŠµë‹ˆë‹¤. ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë²ˆì—­ë¬¸ì„ ìƒì„±í•©ë‹ˆë‹¤.
\end{itemize}

\begin{analogybox}{ë²ˆì—­ê°€ì˜ ì‘ì—… ë°©ì‹}
\begin{itemize}
    \item \textbf{Read (Encoder):} ë¬¸ì¥ì„ ëê¹Œì§€ ë‹¤ ì½ìŠµë‹ˆë‹¤. ì¤‘ê°„ì— ë²ˆì—­í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¨¸ë¦¿ì†ì— í•µì‹¬ ì˜ë¯¸(Context)ë¥¼ ì •ë¦¬í•©ë‹ˆë‹¤.
    \item \textbf{Write (Decoder):} ë¨¸ë¦¿ì† ì˜ë¯¸ë¥¼ ë°”íƒ•ìœ¼ë¡œ í”„ë‘ìŠ¤ì–´ ë¬¸ì¥ì„ ì²˜ìŒë¶€í„° ì¨ ë‚´ë ¤ê°‘ë‹ˆë‹¤.
\end{itemize}
\end{analogybox}

\subsection{2. Training Trick: Teacher Forcing}
í•™ìŠµí•  ë•ŒëŠ” ë””ì½”ë”ê°€ ì‹¤ìˆ˜ë¡œ ì—‰ëš±í•œ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í–ˆë”ë¼ë„, ë‹¤ìŒ ìŠ¤í… ì…ë ¥ìœ¼ë¡œëŠ” \textbf{ì •ë‹µ ë‹¨ì–´(Ground Truth)}ë¥¼ ë„£ì–´ì¤ë‹ˆë‹¤. ì´ë¥¼ \textbf{êµì‚¬ ê°•ìš”(Teacher Forcing)}ë¼ê³  í•©ë‹ˆë‹¤. (ì´ˆë°˜ í•™ìŠµ ì•ˆì •í™”ìš©)

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Implementation: Keras Functional API}

ì¸ì½”ë”ì˜ ìƒíƒœë¥¼ ë””ì½”ë”ë¡œ ë„˜ê²¨ì£¼ëŠ” í•µì‹¬ ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

\begin{lstlisting}[language=Python, caption=Seq2Seq Model Definition, breaklines=true]
import tensorflow as tf
from tensorflow.keras.layers import Input, LSTM, Dense, Embedding
from tensorflow.keras.models import Model

def build_seq2seq(vocab_size, embedding_dim, latent_dim):
    
    # --- 1. Encoder ---
    enc_inputs = Input(shape=(None,))
    enc_emb = Embedding(vocab_size, embedding_dim)(enc_inputs)
    
    # return_state=True: ë§ˆì§€ë§‰ ì€ë‹‰ ìƒíƒœ(h)ì™€ ì…€ ìƒíƒœ(c)ë¥¼ ë°˜í™˜
    encoder_lstm = LSTM(latent_dim, return_state=True)
    _, state_h, state_c = encoder_lstm(enc_emb)
    
    # ë¬¸ë§¥ ë²¡í„° (Context Vector): ë¬¸ì¥ì˜ ëª¨ë“  ì •ë³´ë¥¼ ì••ì¶•í•œ ê²ƒ
    encoder_states = [state_h, state_c]
    
    # --- 2. Decoder ---
    dec_inputs = Input(shape=(None,))
    dec_emb = Embedding(vocab_size, embedding_dim)(dec_inputs)
    
    # return_sequences=True: ëª¨ë“  íƒ€ì„ ìŠ¤í… ì¶œë ¥ (ë²ˆì—­ë¬¸ ìƒì„±)
    decoder_lstm = LSTM(latent_dim, return_sequences=True, return_state=True)
    
    # í•µì‹¬: initial_stateì— ì¸ì½”ë”ì˜ ìƒíƒœë¥¼ ì£¼ì…!
    dec_outputs, _, _ = decoder_lstm(dec_emb, initial_state=encoder_states)
    
    decoder_dense = Dense(vocab_size, activation='softmax')
    dec_outputs = decoder_dense(dec_outputs)
    
    # ëª¨ë¸ ì •ì˜
    model = Model([enc_inputs, dec_inputs], dec_outputs)
    return model
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\begin{warningbox}{The Bottleneck Problem (ë³‘ëª© í˜„ìƒ)}
Seq2Seqì˜ ì¹˜ëª…ì  ë‹¨ì ì€ ì¸ì½”ë”ê°€ ë¬¸ì¥ì´ ê¸¸ë“  ì§§ë“  \textbf{ê³ ì •ëœ í¬ê¸°ì˜ ë²¡í„° í•˜ë‚˜}ì— ëª¨ë“  ì •ë³´ë¥¼ ìš°ê²¨ ë„£ì–´ì•¼ í•œë‹¤ëŠ” ì ì…ë‹ˆë‹¤.
ë¬¸ì¥ì´ ê¸¸ì–´ì§€ë©´(50ë‹¨ì–´ ì´ìƒ) ì •ë³´ ì†ì‹¤ì´ ë°œìƒí•´ ë²ˆì—­ í’ˆì§ˆì´ ê¸‰ê²©íˆ ë–¨ì–´ì§‘ë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ \textbf{Attention Mechanism}ì´ ë“±ì¥í–ˆìŠµë‹ˆë‹¤.
\end{warningbox}

\textbf{Q. ì¶”ë¡ (Inference) ë•ŒëŠ” ì–´ë–»ê²Œ í•˜ë‚˜ìš”?} \\
\textbf{A.} í•™ìŠµ ë•Œì™€ ë‹¬ë¦¬ ì •ë‹µì„ ëª¨ë¥´ë¯€ë¡œ, ë””ì½”ë”ê°€ ë°©ê¸ˆ ì˜ˆì¸¡í•œ ë‹¨ì–´ë¥¼ ë‹¤ìŒ ìŠ¤í…ì˜ ì…ë ¥ìœ¼ë¡œ ë„£ì–´ì£¼ëŠ” ë£¨í”„(Loop)ë¥¼ ì§ì ‘ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤. (Auto-regressive)

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ì´ì œ ëª¨ë¸ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ë””ì½”ë”ê°€ ë‹¨ì–´ë¥¼ ìƒì„±í•  ë•Œ, ë§¤ ìˆœê°„ ê°€ì¥ í™•ë¥  ë†’ì€ ë‹¨ì–´ í•˜ë‚˜ë§Œ(Greedy) ê³ ë¥´ë©´ ìµœê³ ì˜ ë¬¸ì¥ì´ ë ê¹Œìš”?
"The" ë’¤ì— "nice"ê°€ ì˜¬ í™•ë¥ ì´ ë†’ë‹¤ê³  ê³¨ëëŠ”ë°, ë‚˜ì¤‘ì— ë³´ë‹ˆ "The huge building..."ì´ ë” ì¢‹ì€ ë²ˆì—­ì¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒ ì‹œê°„ì—ëŠ” ë²ˆì—­ í’ˆì§ˆì„ ê²°ì •í•˜ëŠ” ê²°ì •ì  íƒìƒ‰ ì•Œê³ ë¦¬ì¦˜, \textbf{[Beam Search]}ì— ëŒ€í•´ ì•Œì•„ë³´ê³ , Seq2Seqì˜ ë³‘ëª© ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” \textbf{[Attention Mechanism]}ìœ¼ë¡œ ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{Structure:} Encoderê°€ ì••ì¶•í•˜ê³  Decoderê°€ í‘¼ë‹¤.
    \item \textbf{Context:} ì¸ì½”ë”ì˜ ë§ˆì§€ë§‰ ìƒíƒœê°€ ë¬¸ì¥ì˜ í•µì‹¬ ì˜ë¯¸ë¥¼ ë‹´ì€ ë§¤ê°œì²´ë‹¤.
    \item \textbf{Transfer:} $h_{enc}$ë¥¼ $h_{dec}$ì˜ `initial_state`ë¡œ ì „ë‹¬í•œë‹¤.
    \item \textbf{Limit:} ê¸´ ë¬¸ì¥ì„ í•˜ë‚˜ì˜ ë²¡í„°ë¡œ ì••ì¶•í•˜ë©´ ì •ë³´ ì†ì‹¤ì´ ë°œìƒí•œë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}