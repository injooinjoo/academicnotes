\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{formulabox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ§® #1 (í•µì‹¬ ìˆ˜ì‹)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Sequence Models: \\ Beam Search (Optimization)}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-9.] Deep Learning Fundamentals \& CNNs \textit{- Completed}
    \item[\textbf{Chapter 10.}] \textbf{Sequence Models (Current Part)}
    \begin{itemize}
        \item 10.1-10.8 RNN, Embedding, Seq2Seq \textit{- Completed}
        \item \textbf{10.9 Beam Search}
        \begin{itemize}
            \item Greedy Search vs Beam Search
            \item Beam Width Parameter ($B$)
            \item Refinements: Log Likelihood \& Length Normalization
        \end{itemize}
    \end{itemize}
    \item[Chapter 11.] Attention Mechanism \textit{- Next Part}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ìš°ë¦¬ëŠ” Seq2Seq ëª¨ë¸ë¡œ ë²ˆì—­ê¸°ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ë§‰ìƒ ëŒë ¤ë³´ë‹ˆ ì—‰ëš±í•œ ë¬¸ì¥ì´ ë‚˜ì˜µë‹ˆë‹¤.
ì´ìœ ëŠ” ìš°ë¦¬ê°€ \textbf{'ë‹¹ì¥ì˜ ìµœì„ (Greedy)'}ë§Œ ì„ íƒí–ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. 1ë“±ë§Œ ë½‘ì•„ì„œ ë¬¸ì¥ì„ ì´ì—ˆë”ë‹ˆ ì „ì²´ ë¬¸ë§¥ì€ ì—‰ë§ì´ ëœ ê²ƒì´ì£ .
ì¸ìƒê³¼ ë§ˆì°¬ê°€ì§€ë¡œ, "ë‹¹ì¥ì˜ ìµœì„ ì´ ê²°ê³¼ì ì¸ ìµœì„ ì€ ì•„ë‹ ìˆ˜" ìˆìŠµë‹ˆë‹¤. ì—¬ëŸ¬ ê°€ëŠ¥ì„±ì„ ë™ì‹œì— íƒìƒ‰í•˜ëŠ” \textbf{ë¹” ì„œì¹˜(Beam Search)}ê°€ í•„ìš”í•©ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ í…ìŠ¤íŠ¸ ìƒì„± ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ê²°ì •ì§“ëŠ” íƒìƒ‰ ì•Œê³ ë¦¬ì¦˜ì„ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{Greedy:} ë§¤ ìˆœê°„ 1ë“±ë§Œ ë½‘ëŠ” ë°©ì‹ì˜ í•œê³„(Local Optima)ë¥¼ ì´í•´í•©ë‹ˆë‹¤.
    \item \textbf{Beam:} ìƒìœ„ $B$ê°œì˜ ê°€ëŠ¥ì„±ì„ ì‚´ë ¤ë‘ë©° íƒìƒ‰í•˜ëŠ” ì›ë¦¬ë¥¼ íŒŒì•…í•©ë‹ˆë‹¤.
    \item \textbf{Refinement:} ë¡œê·¸ ìš°ë„(Log Likelihood)ì™€ ê¸¸ì´ ì •ê·œí™”(Length Normalization)ë¥¼ í†µí•´ ìˆ˜í•™ì  ì•ˆì •ì„±ì„ í™•ë³´í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ì˜ë¯¸} & \textbf{íŠ¹ì§•} \\ \hline
\textbf{Greedy Search} & ë§¤ë²ˆ í™•ë¥  1ë“± ë‹¨ì–´ë§Œ ì„ íƒ. & ë¹ ë¥´ì§€ë§Œ ìµœì í•´ ë³´ì¥ ëª»í•¨. \\ \hline
\textbf{Beam Search} & ë§¤ë²ˆ ìƒìœ„ $B$ê°œë¥¼ ìœ ì§€í•˜ë©° íƒìƒ‰. & ëŠë¦¬ì§€ë§Œ ë” ì¢‹ì€ ë¬¸ì¥ ìƒì„±. \\ \hline
\textbf{Beam Width ($B$)} & ìœ ì§€í•  í›„ë³´ ê°œìˆ˜ (ë³´í†µ 3~10). & $B=1$ì´ë©´ Greedyì™€ ê°™ìŒ. \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ì—¬ëŸ¬ ê¸¸ì„ ë™ì‹œì— ê°€ë¼}

\subsection{1. The Problem: Greedy Search}

ë§¤ ìŠ¤í…ì—ì„œ í™•ë¥ ì´ ê°€ì¥ ë†’ì€ ë‹¨ì–´ 1ê°œë§Œ ê³ ë¥´ê³  ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.
\begin{analogybox}{ë¯¸ë¡œ ì°¾ê¸°}
ê°ˆë¦¼ê¸¸ì—ì„œ ë¬´ì¡°ê±´ "ì¶œêµ¬ì™€ ê°€ê¹Œì›Œ ë³´ì´ëŠ” ìª½"ìœ¼ë¡œë§Œ ê°€ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤. ê°€ë‹¤ ë³´ë‹ˆ ë§‰ë‹¤ë¥¸ ê¸¸ì¼ ìˆ˜ ìˆì§€ë§Œ, ë˜ëŒì•„ê°ˆ ìˆ˜ ì—†ìŠµë‹ˆë‹¤(No Backtracking).
\end{analogybox}

\subsection{2. The Solution: Beam Search}

ë§¤ ìˆœê°„ ìƒìœ„ $B$ê°œì˜ ê°€ëŠ¥ì„±(Hypothesis)ì„ ìœ ì§€í•©ë‹ˆë‹¤. ($B=3$ ê°€ì •)

\begin{itemize}
    \item \textbf{Step 1:} ì²« ë‹¨ì–´ í›„ë³´ ì¤‘ ìƒìœ„ 3ê°œë¥¼ ë½‘ìŠµë‹ˆë‹¤. (ì˜ˆ: "in", "the", "a")
    \item \textbf{Step 2:} ì‚´ì•„ë‚¨ì€ 3ê°œì˜ ë‹¨ì–´ ê°ê°ì— ëŒ€í•´, ë‹¤ìŒ ë‹¨ì–´ í™•ë¥ ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
    \item \textbf{Step 3:} ì´ 30,000ê°œ(3 $\times$ ë‹¨ì–´ì¥) ì¡°í•© ì¤‘ ë‹¤ì‹œ ìƒìœ„ 3ë“±ê¹Œì§€ë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ëŠ” ë²„ë¦½ë‹ˆë‹¤.
    \item \textbf{Repeat:} ë¬¸ì¥ì´ ëë‚  ë•Œê¹Œì§€ ë°˜ë³µí•©ë‹ˆë‹¤.
\end{itemize}

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Deep Dive: Refinements (ì •ë°€í™”)}

ë‹¨ìˆœ í™•ë¥  ê³±ì…ˆì—ëŠ” ìˆ˜í•™ì  ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ë³´ì •í•´ì•¼ í•©ë‹ˆë‹¤.

\subsection{1. Log Likelihood (ë¡œê·¸ ìš°ë„)}
í™•ë¥ (0.1, 0.05...)ì„ ìˆ˜ì‹­ ë²ˆ ê³±í•˜ë©´ ê°’ì´ $0.0000\dots$ì´ ë˜ì–´ ì»´í“¨í„°ê°€ 0ìœ¼ë¡œ ì¸ì‹í•´ë²„ë¦½ë‹ˆë‹¤ (\textbf{Underflow}).
í•´ê²°ì±…ì€ \textbf{ë¡œê·¸($\log$)}ë¥¼ ì·¨í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê³±ì…ˆì´ ë§ì…ˆìœ¼ë¡œ ë³€í•©ë‹ˆë‹¤.

\begin{formulabox}{Score Function}
$$ \sum_{t=1}^{T_y} \log P(y^{\langle t \rangle} | y^{\langle 1 \dots t-1 \rangle}, x) $$
ë¡œê·¸ í•©ì„ ìµœëŒ€í™”í•˜ëŠ” ê²ƒì€ í™•ë¥  ê³±ì„ ìµœëŒ€í™”í•˜ëŠ” ê²ƒê³¼ ìˆ˜í•™ì ìœ¼ë¡œ ë™ì¼í•©ë‹ˆë‹¤.
\end{formulabox}

\subsection{2. Length Normalization (ê¸¸ì´ ì •ê·œí™”)}
ë¡œê·¸ í™•ë¥ (ìŒìˆ˜)ì„ ê³„ì† ë”í•˜ë©´, ë¬¸ì¥ì´ ê¸¸ì–´ì§ˆìˆ˜ë¡ ì ìˆ˜ëŠ” ê³„ì† ë‚®ì•„ì§‘ë‹ˆë‹¤. ëª¨ë¸ì´ \textbf{"ì§§ì€ ë¬¸ì¥"}ì„ ê³¼ë„í•˜ê²Œ ì„ í˜¸í•˜ê²Œ ë©ë‹ˆë‹¤.
í•´ê²°ì±…ì€ ì ìˆ˜ë¥¼ ë¬¸ì¥ ê¸¸ì´($T_y$)ë¡œ ë‚˜ëˆ„ì–´ \textbf{í‰ê· }ì„ ë‚´ëŠ” ê²ƒì…ë‹ˆë‹¤.

\begin{formulabox}{Normalized Score}
$$ \text{Score} = \frac{1}{T_y^\alpha} \sum \log P(\dots) $$
\begin{itemize}
    \item $\alpha$: ë³´ì • ê³„ìˆ˜ (ë³´í†µ 0.7).
    \item ê¸´ ë¬¸ì¥ì— ëŒ€í•œ í˜ë„í‹°ë¥¼ ì™„í™”í•´ì¤ë‹ˆë‹¤.
\end{itemize}
\end{formulabox}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\textbf{Q. $B$ë¥¼ ë¬´ì¡°ê±´ í¬ê²Œ í•˜ë©´ ì¢‹ì€ê°€ìš”?} \\
\textbf{A.} ì•„ë‹™ë‹ˆë‹¤. $B$ê°€ í¬ë©´ ë” ì¢‹ì€ ë¬¸ì¥ì„ ì°¾ì„ í™•ë¥ ì€ ë†’ì§€ë§Œ, ê³„ì‚°ëŸ‰ê³¼ ë©”ëª¨ë¦¬ê°€ $B$ë°°ë¡œ ëŠ˜ì–´ë‚©ë‹ˆë‹¤. ì‹¤ë¬´ì—ì„œëŠ” ë³´í†µ $B=3 \sim 10$ ì •ë„ë¥¼ ì“°ë©°, ì•„ì£¼ ì •ë°€í•œ ë²ˆì—­ì´ í•„ìš”í•  ë•Œë§Œ ë” í‚¤ì›ë‹ˆë‹¤.

\textbf{Q. ë¹” ì„œì¹˜ëŠ” ìµœì í•´(Global Optima)ë¥¼ ë³´ì¥í•˜ë‚˜ìš”?} \\
\textbf{A.} ì•„ë‹ˆìš”. $B$ê°€ ë¬´í•œëŒ€(BFS)ê°€ ì•„ë‹Œ ì´ìƒ, íœ´ë¦¬ìŠ¤í‹± íƒìƒ‰ì´ë¯€ë¡œ ì™„ë²½í•œ ìµœì í•´ë¥¼ ë³´ì¥í•˜ì§„ ì•ŠìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ Greedyë³´ë‹¤ëŠ” í›¨ì”¬ ë‚«ìŠµë‹ˆë‹¤.

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ë¹” ì„œì¹˜ë¡œ ë¬¸ì¥ ìƒì„± ëŠ¥ë ¥ì€ ì¢‹ì•„ì¡ŒìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì—¬ì „íˆ ê·¼ë³¸ì ì¸ ë¬¸ì œê°€ ë‚¨ì•˜ìŠµë‹ˆë‹¤.
Seq2Seqì˜ ì¸ì½”ë”ëŠ” ì•„ë¬´ë¦¬ ê¸´ ë¬¸ì¥ì´ë¼ë„ \textbf{í•˜ë‚˜ì˜ ê³ ì •ëœ ë²¡í„°(Context Vector)}ì— ìš±ì—¬ë„£ì–´ì•¼ í•œë‹¤ëŠ” \textbf{'ë³‘ëª©(Bottleneck)'} í˜„ìƒì…ë‹ˆë‹¤.

\textbf{"ë²ˆì—­í•  ë•Œ ë¬¸ì¥ ì „ì²´ë¥¼ ì™¸ìš°ê³  í•˜ëŠ” ì‚¬ëŒì€ ì—†ìŠµë‹ˆë‹¤. í•„ìš”í•œ ë‹¨ì–´ë¥¼ ê·¸ë•Œê·¸ë•Œ ë‹¤ì‹œ ë³´ë©´ì„œ(Attention) í•˜ì£ ."}
ë‹¤ìŒ ì‹œê°„ì—ëŠ” ë”¥ëŸ¬ë‹ ì—­ì‚¬ìƒ ê°€ì¥ ìœ„ëŒ€í•œ ë°œëª… ì¤‘ í•˜ë‚˜ì¸ \textbf{[Attention Mechanism]}ì„ í†µí•´ ì´ ë³‘ëª©ì„ ë¶€ìˆ˜ê³  Transformerë¡œ ê°€ëŠ” ë¬¸ì„ ì—´ê² ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{Greedy:} ë¹ ë¥´ì§€ë§Œ ì‹œì•¼ê°€ ì¢ì•„ ìµœì  ë¬¸ì¥ì„ ë†“ì¹œë‹¤.
    \item \textbf{Beam Search:} $B$ê°œì˜ ìœ ë§ì£¼ë¥¼ ëê¹Œì§€ í‚¤ìš´ë‹¤.
    \item \textbf{Log:} ì–¸ë”í”Œë¡œìš° ë°©ì§€ë¥¼ ìœ„í•´ í™•ë¥  ê³± ëŒ€ì‹  ë¡œê·¸ í•©ì„ ì“´ë‹¤.
    \item \textbf{Normalize:} ì§§ì€ ë¬¸ì¥ í¸í–¥ì„ ë§‰ê¸° ìœ„í•´ ê¸¸ì´ë¡œ ë‚˜ëˆˆë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}