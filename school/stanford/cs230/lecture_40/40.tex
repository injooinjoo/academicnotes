\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{architecturebox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ—ï¸ #1 (êµ¬ì¡° ë¶„ì„)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Sequence Models: \\ Various RNN Architectures}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-9.] Deep Learning Fundamentals \& CNNs \textit{- Completed}
    \item[\textbf{Chapter 10.}] \textbf{Sequence Models (Current Unit)}
    \begin{itemize}
        \item 10.1 Recurrent Neural Networks (RNN Basics) \textit{- Completed}
        \item \textbf{10.2 Various RNN Architectures}
        \begin{itemize}
            \item One-to-Many (Music Generation)
            \item Many-to-One (Sentiment Analysis)
            \item Many-to-Many (Synced vs Async)
            \item Encoder-Decoder Structure
        \end{itemize}
        \item 10.3 Language Model \& Sequence Generation \textit{- Upcoming}
    \end{itemize}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ì— ìš°ë¦¬ëŠ” RNNì˜ ê¸°ë³¸ êµ¬ì¡°(Basic RNN Cell)ë¥¼ ë°°ì› ìŠµë‹ˆë‹¤. ë‹¹ì‹œì—ëŠ” ì…ë ¥ ê¸¸ì´($T_x$)ì™€ ì¶œë ¥ ê¸¸ì´($T_y$)ê°€ ê°™ì€ ê²½ìš°ë§Œ ê°€ì •í–ˆìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ í˜„ì‹¤ì€ ë‹¤ë¦…ë‹ˆë‹¤. \textbf{"I love you"(3ë‹¨ì–´)}ë¥¼ ë²ˆì—­í•˜ë©´ \textbf{"Je t'aime"(2ë‹¨ì–´)}ê°€ ë©ë‹ˆë‹¤. ìŒì•… ìƒì„±ì€ \textbf{ì¥ë¥´ í•˜ë‚˜(1)}ë¥¼ ì£¼ë©´ \textbf{ê³¡ ì „ì²´(ìˆ˜ë°±)}ë¥¼ ë§Œë“­ë‹ˆë‹¤.
RNNì˜ ê°•ë ¥í•¨ì€ ë°”ë¡œ ì´ \textbf{ì…ì¶œë ¥ êµ¬ì¡°ì˜ ìœ ì—°ì„±(Flexibility)}ì—ì„œ ë‚˜ì˜µë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ ì…ë ¥($T_x$)ê³¼ ì¶œë ¥($T_y$)ì˜ ì¡°í•©ì— ë”°ë¥¸ 5ê°€ì§€ RNN ì•„í‚¤í…ì²˜ë¥¼ ë¶„ë¥˜í•˜ê³  ì´í•´í•©ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{One-to-Many:} í•˜ë‚˜ì˜ ì…ë ¥ìœ¼ë¡œ ì‹œí€€ìŠ¤ë¥¼ ìƒì„± (ìŒì•…, ìº¡ì…”ë‹).
    \item \textbf{Many-to-One:} ì‹œí€€ìŠ¤ë¥¼ í•˜ë‚˜ì˜ ê²°ê³¼ë¡œ ìš”ì•½ (ê°ì„± ë¶„ì„).
    \item \textbf{Many-to-Many (Same):} ì…ë ¥ë§ˆë‹¤ ì¦‰ì‹œ ì¶œë ¥ (ê°œì²´ëª… ì¸ì‹).
    \item \textbf{Many-to-Many (Diff):} ë‹¤ ë“£ê³  ë§í•˜ê¸° (\textbf{ê¸°ê³„ ë²ˆì—­, Encoder-Decoder}).
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|c|l|}
\hline
\textbf{êµ¬ì¡°} & \textbf{ì…ë ¥ : ì¶œë ¥} & \textbf{ëŒ€í‘œ ì˜ˆì‹œ} \\ \hline
\textbf{One-to-One} & 1 : 1 & ì¼ë°˜ì ì¸ ì‹ ê²½ë§ (ì´ë¯¸ì§€ ë¶„ë¥˜). \\ \hline
\textbf{One-to-Many} & 1 : N & ìŒì•… ìƒì„±, ì´ë¯¸ì§€ ìº¡ì…”ë‹. \\ \hline
\textbf{Many-to-One} & N : 1 & ê°ì„± ë¶„ì„ (ë¦¬ë·° $\to$ ë³„ì ). \\ \hline
\textbf{Many-to-Many} & N : N & ê°œì²´ëª… ì¸ì‹ (NER). \\ \hline
\textbf{Seq2Seq} & N : M & ê¸°ê³„ ë²ˆì—­ (ë²ˆì—­ì€ ë¬¸ì¥ ëê¹Œì§€ ë“¤ì–´ì•¼ í•¨). \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: êµ¬ì¡°ì˜ ë‹¤ì–‘ì„±}

\subsection{1. One-to-Many ($T_x=1, T_y>1$)}

í•˜ë‚˜ì˜ ì”¨ì•—(Seed) ì •ë³´ë¥¼ ì£¼ë©´ ê¸´ ì‹œí€€ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ë™ì‘:} ì²« íƒ€ì„ ìŠ¤í…ì—ì„œ ì…ë ¥ $x$ë¥¼ ë°›ìŠµë‹ˆë‹¤. ê·¸ ì´í›„ì—ëŠ” ì „ ë‹¨ê³„ì˜ ì¶œë ¥ $\hat{y}^{\langle t-1 \rangle}$ì„ ë‹¤ìŒ ë‹¨ê³„ì˜ ì…ë ¥ìœ¼ë¡œ ì¬ì‚¬ìš©í•©ë‹ˆë‹¤ (Auto-regressive).
    \item \textbf{ì˜ˆì‹œ:} ìŒì•… ìƒì„± (ì¥ë¥´ $\to$ ë©œë¡œë””), ì´ë¯¸ì§€ ìº¡ì…”ë‹ (ì´ë¯¸ì§€ $\to$ "ê³ ì–‘ì´ê°€ ì”ë‹¤").
\end{itemize}

\subsection{2. Many-to-One ($T_x>1, T_y=1$)}

ê¸´ ì‹œí€€ìŠ¤ë¥¼ ì½ì–´ì„œ í•˜ë‚˜ì˜ ê²°ë¡ ì„ ë‚´ë¦½ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ë™ì‘:} ì‹œí€€ìŠ¤ë¥¼ ëê¹Œì§€ ì½ìœ¼ë©° ì€ë‹‰ ìƒíƒœ($a$)ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. ì¶œë ¥ì€ \textbf{ë§ˆì§€ë§‰ íƒ€ì„ ìŠ¤í…}ì—ì„œë§Œ ë‚˜ì˜µë‹ˆë‹¤.
    \item \textbf{ì˜ˆì‹œ:} ì˜í™” ë¦¬ë·° ê°ì„± ë¶„ì„ (í…ìŠ¤íŠ¸ $\to$ ê¸ì •/ë¶€ì •).
\end{itemize}

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Deep Dive: Many-to-Many (The Tricky Part)}

Many-to-ManyëŠ” ë‹¤ì‹œ ë‘ ê°€ì§€ë¡œ ë‚˜ë‰©ë‹ˆë‹¤. ì´ ì°¨ì´ê°€ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤.

\subsection{1. Synced Many-to-Many ($T_x = T_y$)}

ì…ë ¥ê³¼ ì¶œë ¥ì˜ ê¸¸ì´ê°€ ê°™ê³ , íƒ€ì´ë°ì´ ì¼ì¹˜í•©ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ë™ì‘:} ì…ë ¥ì´ ë“¤ì–´ì˜¬ ë•Œë§ˆë‹¤ ì¦‰ì‹œ ì¶œë ¥ì„ ë±‰ìŠµë‹ˆë‹¤.
    \item \textbf{ì˜ˆì‹œ:} ë¹„ë””ì˜¤ í”„ë ˆì„ ë¶„ë¥˜, ê°œì²´ëª… ì¸ì‹(NER).
\end{itemize}

\subsection{2. Asynchronous Many-to-Many ($T_x \neq T_y$) - Seq2Seq}

ì…ë ¥ê³¼ ì¶œë ¥ì˜ ê¸¸ì´ê°€ ë‹¤ë¦…ë‹ˆë‹¤. ê¸°ê³„ ë²ˆì—­ì˜ í‘œì¤€ì¸ \textbf{Encoder-Decoder} êµ¬ì¡°ì…ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{Encoder (Many-to-One):} ì…ë ¥ ë¬¸ì¥ ì „ì²´ë¥¼ ì½ì–´ì„œ í•˜ë‚˜ì˜ \textbf{ë¬¸ë§¥ ë²¡í„°(Context Vector)}ë¡œ ì••ì¶•í•©ë‹ˆë‹¤.
    \item \textbf{Decoder (One-to-Many):} ì••ì¶•ëœ ë²¡í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë²ˆì—­ ë¬¸ì¥ì„ ìƒì„±í•©ë‹ˆë‹¤.
    \item \textbf{ì´ìœ :} "ë‚˜ëŠ” ë„ˆë¥¼ ì‚¬ë‘í•´"ë¥¼ ë²ˆì—­í•˜ë ¤ë©´ ë¬¸ì¥ ëê¹Œì§€ ë“¤ì–´ë´ì•¼ ì–´ìˆœì„ ë§ì¶œ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
\end{itemize}

% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: Encoder-Decoder Structure}

Kerasë¥¼ ì´ìš©í•´ Seq2Seq ëª¨ë¸ì˜ ê°œë…ì  êµ¬ì¡°ë¥¼ êµ¬í˜„í•´ ë´…ë‹ˆë‹¤.

\begin{lstlisting}[language=Python, caption=Encoder-Decoder Implementation, breaklines=true]
from tensorflow.keras.layers import Input, LSTM, Dense
from tensorflow.keras.models import Model

def build_seq2seq(n_x, n_y, Tx, Ty, n_a):
    """
    n_x, n_y: ì…/ì¶œë ¥ ë‹¨ì–´ ì‚¬ì „ í¬ê¸°
    Tx, Ty: ì…/ì¶œë ¥ ì‹œí€€ìŠ¤ ê¸¸ì´
    n_a: ì€ë‹‰ ìƒíƒœ í¬ê¸°
    """
    
    # --- 1. Encoder (ì…ë ¥ ì••ì¶•) ---
    encoder_inputs = Input(shape=(Tx, n_x))
    
    # return_state=True: ë§ˆì§€ë§‰ ìƒíƒœ(h, c)ë¥¼ ë°˜í™˜ë°›ìŒ
    # return_sequences=False: ì¤‘ê°„ ì¶œë ¥ì€ í•„ìš” ì—†ìŒ (ì••ì¶•ì´ ëª©ì )
    encoder = LSTM(n_a, return_state=True)
    
    _, state_h, state_c = encoder(encoder_inputs)
    
    # ì´ 'encoder_states'ê°€ ì…ë ¥ ë¬¸ì¥ì˜ ëª¨ë“  ì •ë³´ë¥¼ ë‹´ì€ 'ë¬¸ë§¥'
    encoder_states = [state_h, state_c]
    
    # --- 2. Decoder (ë²ˆì—­ ìƒì„±) ---
    decoder_inputs = Input(shape=(Ty, n_y))
    
    # Encoderì˜ ìƒíƒœë¥¼ Decoderì˜ ì´ˆê¸° ìƒíƒœ(initial_state)ë¡œ ì£¼ì…!
    decoder_lstm = LSTM(n_a, return_sequences=True, return_state=True)
    decoder_outputs, _, _ = decoder_lstm(decoder_inputs, 
                                         initial_state=encoder_states)
    
    # ë‹¨ì–´ ì˜ˆì¸¡ (Softmax)
    decoder_dense = Dense(n_y, activation='softmax')
    decoder_outputs = decoder_dense(decoder_outputs)
    
    # ëª¨ë¸ ì •ì˜
    model = Model([encoder_inputs, decoder_inputs], decoder_outputs)
    return model
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\textbf{Q. ì…ë ¥ ë¬¸ì¥ì´ ë„ˆë¬´ ê¸¸ë©´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?} \\
\textbf{A.} Encoderê°€ ë¬¸ì¥ì˜ ëª¨ë“  ì •ë³´ë¥¼ í•˜ë‚˜ì˜ ë²¡í„°ì— ìš±ì—¬ë„£ì–´ì•¼ í•˜ë¯€ë¡œ, ë¬¸ì¥ì´ ê¸¸ì–´ì§€ë©´(ì˜ˆ: 50ë‹¨ì–´ ì´ìƒ) ì •ë³´ ì†ì‹¤ì´ ë°œìƒí•´ ì„±ëŠ¥ì´ ë–¨ì–´ì§‘ë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë‚˜ì¤‘ì— \textbf{Attention Mechanism}ì´ ë“±ì¥í•©ë‹ˆë‹¤.

\textbf{Q. ì´ë¯¸ì§€ ìº¡ì…”ë‹ì€ ì–´ë–¤ êµ¬ì¡°ì¸ê°€ìš”?} \\
\textbf{A.} \textbf{One-to-Many}ì…ë‹ˆë‹¤. ì…ë ¥ì€ ì´ë¯¸ì§€(CNNì„ í†µê³¼í•œ 1ê°œì˜ ë²¡í„°), ì¶œë ¥ì€ í…ìŠ¤íŠ¸ ì‹œí€€ìŠ¤(RNN)ì…ë‹ˆë‹¤. CNNì´ Encoder, RNNì´ Decoder ì—­í• ì„ í•˜ëŠ” ì…ˆì…ë‹ˆë‹¤.

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
RNNì€ ì´ë ‡ê²Œ ë‹¤ì–‘í•œ êµ¬ì¡°ë¡œ ë³€ì‹ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì–´ë–¤ êµ¬ì¡°ë¥¼ ì“°ë“ , ì‹œí€€ìŠ¤ê°€ ê¸¸ì–´ì§€ë©´ ì•ì˜ ë‚´ìš©ì„ ìŠì–´ë²„ë¦¬ëŠ” \textbf{'ê¸°ìš¸ê¸° ì†Œì‹¤'}ì´ë¼ëŠ” ê³ ì§ˆë³‘ì€ ì—¬ì „í•©ë‹ˆë‹¤.

ë‹¤ìŒ ì‹œê°„ì—ëŠ” ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ \textbf{"ê¸°ì–µì„ ì €ì¥í•˜ëŠ” ê¸ˆê³ (Cell State)"}ì™€ \textbf{"ë¬¸ì˜ ì—´ì‡ (Gate)"}ë¥¼ ë„ì…í•œ í˜„ëŒ€ì  RNNì˜ í‘œì¤€, \textbf{[GRU]}ì™€ \textbf{[LSTM]}ì„ í•´ë¶€í•˜ê² ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{Flexibility:} $T_x$ì™€ $T_y$ê°€ ë‹¬ë¼ë„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.
    \item \textbf{Many-to-One:} ê°ì„± ë¶„ì„ (ì •ë³´ ìš”ì•½).
    \item \textbf{Many-to-Many:} ê°œì²´ëª… ì¸ì‹ (ì¦‰ì‹œ ì¶œë ¥) vs ê¸°ê³„ ë²ˆì—­ (ë‹¤ ë“£ê³  ì¶œë ¥).
    \item \textbf{Seq2Seq:} Encoderê°€ ì••ì¶•í•˜ê³  Decoderê°€ ìƒì„±í•œë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}