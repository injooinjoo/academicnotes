\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{formulabox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ§® #1 (ìˆ˜í•™ì  ì›ë¦¬)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Special Applications: \\ Neural Style Transfer (NST)}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-9.] Deep Learning Fundamentals \& CNNs \textit{- Completed}
    \item[\textbf{Chapter 10.}] \textbf{Special Applications (Current Unit)}
    \begin{itemize}
        \item 10.1 Face Recognition \textit{- Completed}
        \item \textbf{10.2 Neural Style Transfer}
        \begin{itemize}
            \item What are we optimizing? (Pixel vs Weights)
            \item Content Cost Function ($J_{content}$)
            \item Style Cost Function ($J_{style}$): Gram Matrix
            \item Implementation Strategy
        \end{itemize}
    \end{itemize}
    \item[Chapter 11.] Sequence Models (RNN) \textit{- Next Part}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ì— ìš°ë¦¬ëŠ” ìƒ´ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ CNNì´ ì´ë¯¸ì§€ì˜ íŠ¹ì§•ì„ ë²¡í„°ë¡œ ì••ì¶•í•˜ëŠ” ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤.
ê·¸ë ‡ë‹¤ë©´, ì´ íŠ¹ì§•ì„ ë¶„ë¦¬í•´ì„œ ì¡°ì‘í•  ìˆ˜ëŠ” ì—†ì„ê¹Œìš”? ì´ë¯¸ì§€ì˜ \textbf{'ë‚´ìš©(Content)'}ì€ ë‚´ ì‚¬ì§„ì¸ë°, \textbf{'í™”í’(Style)'}ì€ ë°˜ ê³ íì˜ ê·¸ë¦¼ì²˜ëŸ¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤ë©´ ì–´ë–¨ê¹Œìš”?
ì´ê²ƒì´ ë°”ë¡œ AI ì˜ˆìˆ ì˜ ì‹œì´ˆ, \textbf{Neural Style Transfer(NST)}ì…ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ CNNì˜ íŠ¹ì„±ì„ í™œìš©í•˜ì—¬ ë‘ ì´ë¯¸ì§€ë¥¼ í•©ì„±í•˜ëŠ” NST ì•Œê³ ë¦¬ì¦˜ì„ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ì „í™˜:} ê°€ì¤‘ì¹˜($W$)ê°€ ì•„ë‹Œ \textbf{ì…ë ¥ ì´ë¯¸ì§€($G$)ì˜ í”½ì…€}ì„ í•™ìŠµí•œë‹¤ëŠ” ì°¨ì´ì ì„ ì´í•´í•©ë‹ˆë‹¤.
    \item \textbf{ì½˜í…ì¸ :} ê¹Šì€ ì¸µì˜ í™œì„±í™” ë§µì„ ë¹„êµí•˜ì—¬ ë‚´ìš©ì˜ ìœ ì‚¬ì„±ì„ ì¸¡ì •í•©ë‹ˆë‹¤.
    \item \textbf{ìŠ¤íƒ€ì¼:} \textbf{ê·¸ëŒ í–‰ë ¬(Gram Matrix)}ì„ í†µí•´ ì´ë¯¸ì§€ì˜ ì§ˆê°ê³¼ ìƒê´€ê´€ê³„ë¥¼ ìˆ˜ì¹˜í™”í•©ë‹ˆë‹¤.
    \item \textbf{í†µí•©:} $J(G) = \alpha J_{content} + \beta J_{style}$ì„ ìµœì†Œí™”í•˜ì—¬ ì˜ˆìˆ  ì‘í’ˆì„ ìƒì„±í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ì´ë¯¸ì§€} & \textbf{ê¸°í˜¸} & \textbf{ì—­í• } \\ \hline
\textbf{Content Image} & $C$ & ë‚´ìš©ì˜ ê¸°ì¤€ (ì˜ˆ: ë‚´ ì‚¬ì§„). \\ \hline
\textbf{Style Image} & $S$ & í™”í’ì˜ ê¸°ì¤€ (ì˜ˆ: ê³ í ê·¸ë¦¼). \\ \hline
\textbf{Generated Image} & $G$ & ìš°ë¦¬ê°€ ë§Œë“¤ ê²°ê³¼ë¬¼ (ì²˜ìŒì—” ë…¸ì´ì¦ˆ). \\ \hline
\textbf{Gram Matrix} & $G_{kk'}$ & íŠ¹ì„±ë§µ ì±„ë„ ê°„ì˜ ìƒê´€ê´€ê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í–‰ë ¬. \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ë¬´ì—‡ì„ í•™ìŠµí•˜ëŠ”ê°€?}

\subsection{1. The Big Picture}
NSTì˜ ê°€ì¥ í° íŠ¹ì§•ì€ í•™ìŠµì˜ ëŒ€ìƒì´ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

\begin{itemize}
    \item \textbf{ê¸°ì¡´ CNN í•™ìŠµ:} ì´ë¯¸ì§€ ê³ ì • $\rightarrow$ ê°€ì¤‘ì¹˜ $W$ ì—…ë°ì´íŠ¸.
    \item \textbf{NST í•™ìŠµ:} ê°€ì¤‘ì¹˜ $W$ ê³ ì •(Pre-trained) $\rightarrow$ \textbf{ìƒì„± ì´ë¯¸ì§€ $G$ì˜ í”½ì…€ê°’ ì—…ë°ì´íŠ¸.}
\end{itemize}

\subsection{2. Content Cost Function ($J_{content}$)}
"ì´ë¯¸ì§€ $G$ê°€ ì´ë¯¸ì§€ $C$ì™€ ë¹„ìŠ·í•œ ë‚´ìš©ì„ ë‹´ê³  ìˆëŠ”ê°€?"
\begin{itemize}
    \item \textbf{ì›ë¦¬:} CNNì˜ ê¹Šì€ ì¸µ(Deep Layer)ì€ ì‚¬ë¬¼ì˜ ë°°ì¹˜ë‚˜ êµ¬ì¡° ê°™ì€ ê³ ì°¨ì› ì •ë³´ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.
    \item \textbf{ìˆ˜ì‹:} íŠ¹ì • ì¸µ $l$ì—ì„œ ë‘ ì´ë¯¸ì§€ì˜ í™œì„±í™” ë§µ($a^{[l]}$) ê°„ì˜ ì°¨ì´(MSE)ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
    $$ J_{content}(C, G) = \frac{1}{2} \| a^{[l](C)} - a^{[l](G)} \|^2 $$
\end{itemize}

\subsection{3. Style Cost Function ($J_{style}$) - [í•µì‹¬]}
"ì´ë¯¸ì§€ $G$ê°€ ì´ë¯¸ì§€ $S$ì˜ í™”í’(ì§ˆê°)ì„ ë‹´ê³  ìˆëŠ”ê°€?"
ìŠ¤íƒ€ì¼ì€ "ì–´ë””ì— ìˆëŠ”ê°€"ê°€ ì•„ë‹ˆë¼ \textbf{"ë¬´ì—‡ì´ í•¨ê»˜ ë‚˜íƒ€ë‚˜ëŠ”ê°€(Correlation)"}ì…ë‹ˆë‹¤.

\begin{analogybox}{ê·¸ëŒ í–‰ë ¬ì˜ ì§ê´€}
ì–´ë–¤ ì¸µì— ë‘ ê°œì˜ í•„í„°(ì±„ë„)ê°€ ìˆë‹¤ê³  ê°€ì •í•©ì‹œë‹¤.
\begin{itemize}
    \item \textbf{í•„í„° A:} ìˆ˜ì§ì„ ì„ ì°¾ìŒ.
    \item \textbf{í•„í„° B:} ì£¼í™©ìƒ‰ì„ ì°¾ìŒ.
\end{itemize}
ì´ ë‘ í•„í„°ê°€ ì´ë¯¸ì§€ì˜ ê°™ì€ ìœ„ì¹˜ì—ì„œ ë™ì‹œì— í™œì„±í™”ëœë‹¤ë©´(ìƒê´€ê´€ê³„ ë†’ìŒ), "ì´ í™”í’ì€ ìˆ˜ì§ì„ ê³¼ ì£¼í™©ìƒ‰ì´ í•¨ê»˜ ë‹¤ë‹ˆëŠ” ìŠ¤íƒ€ì¼ì´ë‹¤"ë¼ê³  ì •ì˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì„ ìˆ˜ì¹˜í™”í•œ ê²ƒì´ \textbf{ê·¸ëŒ í–‰ë ¬(Gram Matrix)}ì…ë‹ˆë‹¤.
\end{analogybox}

\begin{formulabox}{Gram Matrix ($G^{[l]}$)}
$$ G_{kk'}^{[l]} = \sum_{i} \sum_{j} a_{i,j,k}^{[l]} \cdot a_{i,j,k'}^{[l]} $$
(ì±„ë„ $k$ì™€ ì±„ë„ $k'$ì˜ í™œì„±í™” ë§µ ë‚´ì )
\end{formulabox}

ìŠ¤íƒ€ì¼ ë¹„ìš©ì€ ë‘ ì´ë¯¸ì§€ì˜ ê·¸ëŒ í–‰ë ¬ ì°¨ì´ì…ë‹ˆë‹¤.
$$ J_{style}^{[l]}(S, G) = \| G^{[l](S)} - G^{[l](G)} \|^2 $$

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Implementation: Optimization Loop}

TensorFlow/Kerasë¥¼ ì‚¬ìš©í•œ êµ¬í˜„ì˜ í•µì‹¬ êµ¬ì¡°ì…ë‹ˆë‹¤.

\begin{lstlisting}[language=Python, caption=Neural Style Transfer Logic, breaklines=true]
import tensorflow as tf

# 1. ëª¨ë¸ ì¤€ë¹„ (VGG19, ê°€ì¤‘ì¹˜ ê³ ì •)
vgg = tf.keras.applications.VGG19(include_top=False, weights='imagenet')
vgg.trainable = False 

# 2. ìƒì„± ì´ë¯¸ì§€(G) ì´ˆê¸°í™” (í•™ìŠµ ëŒ€ìƒ!)
# ì²˜ìŒì—ëŠ” ëœë¤ ë…¸ì´ì¦ˆë¡œ ì‹œì‘í•˜ê±°ë‚˜ Content ì´ë¯¸ì§€ë¡œ ì‹œì‘
generated_image = tf.Variable(content_image) 

# 3. ìµœì í™” ë£¨í”„
optimizer = tf.optimizers.Adam(learning_rate=0.02)

@tf.function
def train_step(image):
    with tf.GradientTape() as tape:
        # ëª¨ë¸ í†µê³¼ -> í™œì„±í™” ë§µ ì¶”ì¶œ
        outputs = get_vgg_layers(image)
        
        # Loss ê³„ì‚°
        loss_c = calculate_content_loss(outputs, content_targets)
        loss_s = calculate_style_loss(outputs, style_targets) # Gram Matrix ì‚¬ìš©
        
        total_loss = alpha * loss_c + beta * loss_s
        
    # í•µì‹¬: ê°€ì¤‘ì¹˜ê°€ ì•„ë‹Œ 'ì…ë ¥ ì´ë¯¸ì§€'ì— ëŒ€í•œ ê¸°ìš¸ê¸° ê³„ì‚°
    grad = tape.gradient(total_loss, image)
    
    # ì´ë¯¸ì§€ í”½ì…€ ì—…ë°ì´íŠ¸
    optimizer.apply_gradients([(grad, image)])
    
    # í”½ì…€ê°’ í´ë¦¬í•‘ (0~1 ì‚¬ì´ ìœ ì§€)
    image.assign(tf.clip_by_value(image, 0.0, 1.0))
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\begin{warningbox}{ì™œ ê·¸ëŒ í–‰ë ¬ì¸ê°€ìš”?}
ê·¸ëŒ í–‰ë ¬ì€ ê³µê°„ ì •ë³´(Spatial Information)ë¥¼ í•©ì³ë²„ë¦½ë‹ˆë‹¤($\sum_{i,j}$). ì¦‰, "ì–´ë””ì—" ìˆëŠ”ì§€ëŠ” ë¬´ì‹œí•˜ê³  "ì–´ë–¤ íŠ¹ì§•ë“¤ì´ í†µê³„ì ìœ¼ë¡œ ê³µì¡´í•˜ëŠ”ê°€"ë§Œ ë‚¨ê¸°ê¸° ë•Œë¬¸ì— \textbf{ìŠ¤íƒ€ì¼(ì§ˆê°, íŒ¨í„´)}ì„ í‘œí˜„í•˜ê¸°ì— ì í•©í•©ë‹ˆë‹¤.
\end{warningbox}

\textbf{Q. $\alpha$ì™€ $\beta$ëŠ” ì–´ë–»ê²Œ ì •í•˜ë‚˜ìš”?} \\
\textbf{A.} ì·¨í–¥ì…ë‹ˆë‹¤. $\alpha$(ì½˜í…ì¸ )ë¥¼ ë†’ì´ë©´ ì›ë³¸ ì‚¬ì§„ê³¼ ë¹„ìŠ·í•´ì§€ê³ , $\beta$(ìŠ¤íƒ€ì¼)ë¥¼ ë†’ì´ë©´ ê·¸ë¦¼ í™”í’ì´ ê°•í•´ì§‘ë‹ˆë‹¤. ë³´í†µ $\beta$ë¥¼ í›¨ì”¬ í¬ê²Œ ì„¤ì •í•©ë‹ˆë‹¤(ìˆ«ì ìŠ¤ì¼€ì¼ ì°¨ì´ ë•Œë¬¸).

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ìš°ë¦¬ëŠ” CNNì„ ì´ìš©í•´ ì´ë¯¸ì§€ë¥¼ ë¶„ë¥˜í•˜ê³ , íƒì§€í•˜ê³ , ì‹¬ì§€ì–´ ì˜ˆìˆ  ì‘í’ˆìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë°©ë²•ê¹Œì§€ ë°°ì› ìŠµë‹ˆë‹¤. ì´ë¡œì¨ \textbf{ì»´í“¨í„° ë¹„ì „(Computer Vision)} íŒŒíŠ¸ë¥¼ ë§ˆë¬´ë¦¬í•©ë‹ˆë‹¤.

ì´ì œ ì‹œê° ì •ë³´ê°€ ì•„ë‹Œ, \textbf{ì‹œê°„ì˜ íë¦„ì´ ìˆëŠ” ë°ì´í„°(Sequence Data)}ì˜ ì„¸ê³„ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤. 
ë‹¤ìŒ ì‹œê°„ë¶€í„°ëŠ” ìŒì„±, ì–¸ì–´, ì£¼ê°€ ë“± ì—°ì†ì ì¸ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” \textbf{[Part 5. Sequence Models]}ë¥¼ ì‹œì‘í•˜ë©°, ê·¸ ì²« ë²ˆì§¸ ì£¼ìì¸ \textbf{RNN (Recurrent Neural Networks)}ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{NST:} ì‚¬ì „ í•™ìŠµëœ CNNì„ ì´ìš©í•´ ì½˜í…ì¸ ì™€ ìŠ¤íƒ€ì¼ì„ í•©ì„±í•œë‹¤.
    \item \textbf{Learning:} ê°€ì¤‘ì¹˜ëŠ” ê³ ì •í•˜ê³ , \textbf{ì…ë ¥ ì´ë¯¸ì§€ì˜ í”½ì…€}ì„ í•™ìŠµ(ì—…ë°ì´íŠ¸)í•œë‹¤.
    \item \textbf{Content:} ê¹Šì€ ì¸µì˜ í™œì„±í™” ë§µ ì°¨ì´ë¥¼ ì¤„ì¸ë‹¤.
    \item \textbf{Style:} \textbf{ê·¸ëŒ í–‰ë ¬(Gram Matrix)}ì˜ ì°¨ì´ë¥¼ ì¤„ì—¬ ì§ˆê° ìƒê´€ê´€ê³„ë¥¼ ëª¨ë°©í•œë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}