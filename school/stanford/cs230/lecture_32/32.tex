\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{mathbox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ§® #1 (ìˆ˜í•™ì  ì¦ëª…)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Convolutional Neural Networks: \\ ResNet (Residual Networks)}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-8.] Deep Learning Strategy \& Architecture \textit{- Completed}
    \item[\textbf{Chapter 9.}] \textbf{Convolutional Neural Networks (Current Part)}
    \begin{itemize}
        \item 9.1-9.3 CNN Basics \& Classic Networks \textit{- Completed}
        \item \textbf{9.4 ResNet (Residual Networks)}
        \begin{itemize}
            \item The Degradation Problem
            \item Skip Connections: The Shortcut
            \item Why $H(x) = F(x) + x$?
            \item Implementation: Identity \& Conv Blocks
        \end{itemize}
        \item 9.5 Inception Network \textit{- Upcoming}
    \end{itemize}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ì— ë°°ìš´ VGG-16ì€ 16ê°œ ì¸µìœ¼ë¡œ ë›°ì–´ë‚œ ì„±ëŠ¥ì„ ë³´ì˜€ìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì§ˆë¬¸ì´ ìƒê¹ë‹ˆë‹¤.
\textbf{"ì¸µì„ 100ê°œ, 1000ê°œë¡œ ëŠ˜ë¦¬ë©´ ì„±ëŠ¥ì´ ë” ì¢‹ì•„ì§€ì§€ ì•Šì„ê¹Œìš”?"}
ì´ë¡ ì ìœ¼ë¡œëŠ” ê·¸ë˜ì•¼ í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” ì¸µì´ 20ê°œë¥¼ ë„˜ì–´ê°€ë©´ ì„±ëŠ¥ì´ ê¸‰ê²©íˆ ë–¨ì–´ì§€ëŠ” \textbf{í‡´ë³´(Degradation)} í˜„ìƒì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ê¹Šì€ ë§ì„ í•™ìŠµì‹œí‚¤ëŠ” ê²ƒ ìì²´ê°€ ë„ˆë¬´ ì–´ë ¤ì› ë˜ ê²ƒì…ë‹ˆë‹¤.
ì´ ë‚œì œë¥¼ í•´ê²°í•˜ê³  ë”¥ëŸ¬ë‹ ì—­ì‚¬ë¥¼ ìƒˆë¡œ ì“´ ëª¨ë¸ì´ ë°”ë¡œ \textbf{ResNet}ì…ë‹ˆë‹¤. í•µì‹¬ì€ \textbf{"ì§€ë¦„ê¸¸(Shortcut)"}ì„ ëš«ì–´ì£¼ëŠ” ê²ƒì…ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ 152ì¸µ ì´ìƒì˜ ì´ˆì‹¬ì¸µ ì‹ ê²½ë§ í•™ìŠµì„ ê°€ëŠ¥í•˜ê²Œ í•œ ResNetì˜ í•µì‹¬ ì›ë¦¬ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ë¬¸ì œ:} ë§ì´ ê¹Šì–´ì§ˆìˆ˜ë¡ í•™ìŠµì´ ì•ˆ ë˜ëŠ” ì´ìœ (ê¸°ìš¸ê¸° ì†Œì‹¤ ë“±)ë¥¼ ì´í•´í•©ë‹ˆë‹¤.
    \item \textbf{í•´ê²°:} ì…ë ¥ $x$ë¥¼ ì¶œë ¥ì— ë”í•´ì£¼ëŠ” \textbf{Skip Connection} êµ¬ì¡°ë¥¼ íŒŒì•…í•©ë‹ˆë‹¤.
    \item \textbf{ì›ë¦¬:} ì”ì°¨ ë¸”ë¡ì´ ì–´ë–»ê²Œ í•­ë“± ë§¤í•‘($H(x)=x$)ì„ ì‰½ê²Œ í•™ìŠµí•˜ëŠ”ì§€ ìˆ˜ì‹ìœ¼ë¡œ ì¦ëª…í•©ë‹ˆë‹¤.
    \item \textbf{êµ¬í˜„:} Kerasë¡œ Identity Blockê³¼ Convolutional Blockì„ êµ¬í˜„í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ì˜ë¯¸} & \textbf{í•µì‹¬} \\ \hline
\textbf{Skip Connection} & ì…ë ¥ì„ ëª‡ ì¸µ ê±´ë„ˆë›°ì–´ ì¶œë ¥ì— ë”í•˜ëŠ” ì—°ê²°ì„  & ì§€ë¦„ê¸¸ (Shortcut) \\ \hline
\textbf{Residual (ì”ì°¨)} & í•™ìŠµí•´ì•¼ í•  ì°¨ì´ ($F(x)$) & $H(x) - x$ \\ \hline
\textbf{Identity Mapping} & ì…ë ¥ì„ ê·¸ëŒ€ë¡œ ì¶œë ¥í•˜ëŠ” ê²ƒ ($H(x)=x$) & ê¸°ë³¸ì€ í•œë‹¤. \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ì§€ë¦„ê¸¸ì˜ ë§ˆë²•}

\subsection{1. The Degradation Problem (ì„±ëŠ¥ ì €í•˜)}

ì¼ë°˜ì ì¸ ë„¤íŠ¸ì›Œí¬(Plain Network)ì— ì¸µì„ ê³„ì† ì¶”ê°€í•˜ë©´, í•™ìŠµ ë°ì´í„°ì— ëŒ€í•œ ì—ëŸ¬ì¡°ì°¨ ë†’ì•„ì§‘ë‹ˆë‹¤. ê¸°ìš¸ê¸°(Gradient)ê°€ ì…ë ¥ì¸µê¹Œì§€ ë„ë‹¬í•˜ì§€ ëª»í•˜ê³  ì‚¬ë¼ì ¸ë²„ë¦¬ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

\subsection{2. Skip Connection (ì”ì°¨ ì—°ê²°)}


ResNetì˜ ì•„ì´ë””ì–´ëŠ” ê°„ë‹¨í•©ë‹ˆë‹¤. \textbf{"ì •ë³´ê°€ íë¥´ëŠ” ê³ ì†ë„ë¡œë¥¼ ëš«ì–´ì£¼ì."}
\begin{itemize}
    \item \textbf{Main Path:} í•©ì„±ê³± ì¸µì„ í†µê³¼í•˜ì—¬ $F(x)$ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
    \item \textbf{Shortcut:} ì…ë ¥ $x$ë¥¼ ê·¸ëŒ€ë¡œ ê°€ì ¸ì™€ì„œ ë”í•©ë‹ˆë‹¤.
    \item \textbf{Output:} $H(x) = F(x) + x$
\end{itemize}

\begin{analogybox}{êµê³¼ì„œ ì•”ê¸° ë¹„ìœ }
\begin{itemize}
    \item \textbf{Plain:} "ë°±ì§€ìƒíƒœì—ì„œ êµê³¼ì„œ ì „ì²´($H(x)$)ë¥¼ ë‹¤ ì™¸ì›Œë¼." (ì–´ë µë‹¤)
    \item \textbf{ResNet:} "ë„ˆëŠ” ì´ë¯¸ $x$ë§Œí¼ ì•Œê³  ìˆìœ¼ë‹ˆ, êµê³¼ì„œ ë‚´ìš©ê³¼ ë„¤ ì§€ì‹ì˜ \textbf{ì°¨ì´($F(x)$)}ë§Œ ì¶”ê°€ë¡œ ê³µë¶€í•´ë¼." (ì‰½ë‹¤)
\end{itemize}
\end{analogybox}

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Deep Dive: Why does it work?}

\begin{mathbox}{Gradient Superhighway}
ì—­ì „íŒŒ ì‹œ ë¯¸ë¶„ê°’ì´ ì „ë‹¬ë˜ëŠ” ê³¼ì •ì„ ë´…ì‹œë‹¤.
$$ H(x) = F(x) + x $$
$$ \frac{\partial H}{\partial x} = \frac{\partial F(x)}{\partial x} + \mathbf{1} $$
\textbf{ì˜ë¯¸:} ë³µì¡í•œ í•©ì„±ê³± ê²½ë¡œ($F$)ì˜ ë¯¸ë¶„ê°’ì´ 0ì´ ë˜ì–´ë„(Vanishing), ì§€ë¦„ê¸¸ ê²½ë¡œ($+1$)ê°€ ì‚´ì•„ìˆìŠµë‹ˆë‹¤. ê¸°ìš¸ê¸°ê°€ ì†Œì‹¤ë˜ì§€ ì•Šê³  ë„¤íŠ¸ì›Œí¬ ì•ë‹¨ê¹Œì§€ ê·¸ëŒ€ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.
\end{mathbox}

\subsection{3. Dimension Matching (ì°¨ì› ì¼ì¹˜)}
$F(x)$ì™€ $x$ë¥¼ ë”í•˜ë ¤ë©´ ë‘ í–‰ë ¬ì˜ í¬ê¸°ê°€ ê°™ì•„ì•¼ í•©ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{Identity Block:} ì…ì¶œë ¥ í¬ê¸°ê°€ ê°™ì„ ë•Œ. ê·¸ëƒ¥ ë”í•¨.
    \item \textbf{Convolutional Block:} í¬ê¸°ê°€ ë‹¤ë¥¼ ë•Œ(Pooling ë“±). $x$ì—ë„ $1 \times 1$ Convë¥¼ ì ìš©í•´ í¬ê¸°ë¥¼ ë§ì¶°ì¤€ ë’¤ ë”í•¨.
\end{itemize}

% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: ResNet Block}

Keras Functional APIë¥¼ ì‚¬ìš©í•œ êµ¬í˜„ì…ë‹ˆë‹¤.

\begin{lstlisting}[language=Python, caption=ResNet Identity Block, breaklines=true]
from tensorflow.keras import layers, models

def identity_block(X, f, filters):
    """
    X: ì…ë ¥ í…ì„œ
    f: ì»¤ë„ í¬ê¸° (ì¤‘ê°„ì¸µ)
    filters: í•„í„° ê°œìˆ˜ ë¦¬ìŠ¤íŠ¸ [F1, F2, F3]
    """
    F1, F2, F3 = filters
    X_shortcut = X # ì…ë ¥ ì €ì¥ (ì§€ë¦„ê¸¸ìš©)
    
    # --- Main Path (3ê°œì˜ Conv ì¸µ) ---
    # 1. 1x1 Conv (ì°¨ì› ì¶•ì†Œ/í™•ì¥ìš©)
    X = layers.Conv2D(filters=F1, kernel_size=(1, 1), padding='valid')(X)
    X = layers.BatchNormalization()(X)
    X = layers.Activation('relu')(X)
    
    # 2. fxf Conv (ë©”ì¸ ì—°ì‚°)
    X = layers.Conv2D(filters=F2, kernel_size=(f, f), padding='same')(X)
    X = layers.BatchNormalization()(X)
    X = layers.Activation('relu')(X)

    # 3. 1x1 Conv (ì°¨ì› ë³µì›)
    X = layers.Conv2D(filters=F3, kernel_size=(1, 1), padding='valid')(X)
    X = layers.BatchNormalization()(X)
    
    # --- Skip Connection (í•µì‹¬) ---
    # Main Path ê²°ê³¼ì™€ ì§€ë¦„ê¸¸(Original X)ì„ ë”í•¨
    X = layers.Add()([X, X_shortcut])
    
    # ë”í•œ ë’¤ì— ReLU ì ìš© (ì¤‘ìš”!)
    X = layers.Activation('relu')(X)
    
    return X
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\begin{warningbox}{ReLU ìœ„ì¹˜ ì£¼ì˜}
Skip Connectionì„ ë”í•˜ëŠ” `Add()` ì—°ì‚°ì€ ë§ˆì§€ë§‰ ReLU \textbf{ì´ì „}ì— ìˆ˜í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
(X + Shortcut) $\rightarrow$ ReLU. ìˆœì„œê°€ ë°”ë€Œë©´ ì„±ëŠ¥ì´ ë–¨ì–´ì§‘ë‹ˆë‹¤.
\end{warningbox}

\textbf{Q. ResNet-50ì˜ 'Bottleneck' êµ¬ì¡°ê°€ ë­”ê°€ìš”?} \\
\textbf{A.} $1 \times 1$, $3 \times 3$, $1 \times 1$ ìˆœì„œë¡œ ìŒ“ì€ ë¸”ë¡ì…ë‹ˆë‹¤.
$1 \times 1$ë¡œ ì±„ë„ì„ ì¤„ì˜€ë‹¤ê°€(ì••ì¶•), ì—°ì‚°í•˜ê³ , ë‹¤ì‹œ ëŠ˜ë¦½ë‹ˆë‹¤. ì—°ì‚°ëŸ‰ì„ ì¤„ì´ë©´ì„œ ê¹Šì´ë¥¼ ëŠ˜ë¦¬ê¸° ìœ„í•œ í…Œí¬ë‹‰ì…ë‹ˆë‹¤.

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ResNetì„ í†µí•´ ìš°ë¦¬ëŠ” ê¹Šì´ì— ëŒ€í•œ ë‘ë ¤ì›€ì„ ê·¹ë³µí–ˆìŠµë‹ˆë‹¤.
ê·¸ëŸ°ë° ë¹„ìŠ·í•œ ì‹œê¸°ì— êµ¬ê¸€ì—ì„œëŠ” ê¹Šì´ê°€ ì•„ë‹ˆë¼ \textbf{"ë„ˆë¹„(Width)"}ì™€ \textbf{"ë‹¤ì–‘ì„±"}ì— ì§‘ì¤‘í•œ ëª¨ë¸ì„ ë‚´ë†“ì•˜ìŠµë‹ˆë‹¤. $1 \times 1$, $3 \times 3$, $5 \times 5$ í•„í„°ë¥¼ í•œ ì¸µì—ì„œ ë™ì‹œì— ì“´ë‹¤ë©´ ì–´ë–¨ê¹Œìš”?

ë‹¤ìŒ ì‹œê°„ì—ëŠ” \textbf{Network within a Network}ë¼ê³  ë¶ˆë¦¬ëŠ” $1 \times 1$ Convolutionì˜ ë§ˆë²•ê³¼, ì´ë¥¼ í™œìš©í•œ \textbf{[Inception Network]}ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{Problem:} ë„ˆë¬´ ê¹Šìœ¼ë©´ í•™ìŠµì´ ì•ˆ ëœë‹¤ (Degradation).
    \item \textbf{Solution:} Skip Connection ($H(x) = F(x) + x$).
    \item \textbf{Math:} ë¯¸ë¶„ ì‹œ $+1$ í•­ì´ ìƒê²¨ ê¸°ìš¸ê¸° ì†Œì‹¤ì„ ë§‰ëŠ”ë‹¤.
    \item \textbf{Block:} ì°¨ì›ì´ ê°™ìœ¼ë©´ Identity Block, ë‹¤ë¥´ë©´ Conv Blockì„ ì“´ë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}