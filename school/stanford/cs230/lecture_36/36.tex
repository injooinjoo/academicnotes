\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{mathbox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ§® #1 (ìˆ˜í•™ì  ì¦ëª…)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Special Applications: \\ Face Recognition \& One-shot Learning}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-9.] CNN Foundations \& Architectures \textit{- Completed}
    \item[\textbf{Chapter 10.}] \textbf{Special Applications (Current Unit)}
    \begin{itemize}
        \item \textbf{10.1 Face Recognition}
        \begin{itemize}
            \item The One-shot Learning Problem
            \item Siamese Network Architecture
            \item Triplet Loss Function
            \item Binary Classification Alternative
        \end{itemize}
        \item 10.2 Neural Style Transfer \textit{- Upcoming}
    \end{itemize}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ê¹Œì§€ ìš°ë¦¬ëŠ” YOLOë¥¼ í†µí•´ ê°ì²´ì˜ ìœ„ì¹˜ë¥¼ ì°¾ëŠ” ë²•ì„ ë°°ì› ìŠµë‹ˆë‹¤.
ì˜¤ëŠ˜ì€ ê·¸ë³´ë‹¤ ë” ê¹Œë‹¤ë¡œìš´ ë¬¸ì œì¸ \textbf{"ì´ ì‚¬ëŒì´ ëˆ„êµ¬ì¸ê°€?"}ë¥¼ êµ¬ë³„í•˜ëŠ” ì–¼êµ´ ì¸ì‹ì— ë„ì „í•©ë‹ˆë‹¤.
ìš°ë¦¬ëŠ” ìŠ¤ë§ˆíŠ¸í°ì„ ì‚´ ë•Œ ì–¼êµ´ì„ í•œ ë²ˆë§Œ ë“±ë¡í•©ë‹ˆë‹¤. ê·¸ëŸ°ë° ë”¥ëŸ¬ë‹ì€ ë³´í†µ ìˆ˜ì²œ ì¥ì˜ ë°ì´í„°ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì–´ë–»ê²Œ ë‹¨ í•œ ì¥ì˜ ì‚¬ì§„ë§Œìœ¼ë¡œ ì£¼ì¸ì„ ì•Œì•„ë³¼ê¹Œìš”? ê¸°ì¡´ ìƒì‹ì„ ê¹¨ëŠ” \textbf{One-shot Learning}ê³¼ \textbf{Siamese Network}ì˜ ë¹„ë°€ì„ íŒŒí—¤ì³ ë´…ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ ë°ì´í„°ê°€ ê·¹ë„ë¡œ ì ì€ ìƒí™©ì—ì„œ ì‘ë™í•˜ëŠ” ì–¼êµ´ ì¸ì‹ ì‹œìŠ¤í…œì˜ ì›ë¦¬ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{One-shot Learning:} ë‹¨ í•œ ì¥ì˜ ë°ì´í„°ë¡œ í•™ìŠµí•˜ëŠ” ë¬¸ì œë¥¼ 'ë¶„ë¥˜'ê°€ ì•„ë‹Œ 'ìœ ì‚¬ë„ ì¸¡ì •'ìœ¼ë¡œ í’‰ë‹ˆë‹¤.
    \item \textbf{Siamese Network:} ë‘ ì´ë¯¸ì§€ë¥¼ ê°™ì€ ë„¤íŠ¸ì›Œí¬ì— í†µê³¼ì‹œì¼œ ê±°ë¦¬(Distance)ë¥¼ ê³„ì‚°í•˜ëŠ” êµ¬ì¡°ë¥¼ ë°°ì›ë‹ˆë‹¤.
    \item \textbf{Triplet Loss:} Anchor, Positive, Negative ì„¸ ì¥ì˜ ì‚¬ì§„ì„ ì´ìš©í•œ í•™ìŠµ ë°©ë²•ì„ ìˆ˜í•™ì ìœ¼ë¡œ ìœ ë„í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ì˜ë¯¸} & \textbf{í•µì‹¬ ì—­í• } \\ \hline
\textbf{One-shot Learning} & í•œ ë²ˆë§Œ ë³´ê³  ë°°ìš°ê¸° & ë°ì´í„°ê°€ ì ì€ ë¬¸ì œ í•´ê²°. \\ \hline
\textbf{Siamese Network} & ìƒ´ ë„¤íŠ¸ì›Œí¬ & ë‘ ì…ë ¥ì´ ê°™ì€ ê°€ì¤‘ì¹˜($W$)ë¥¼ ê³µìœ í•¨. \\ \hline
\textbf{Encoding} & $f(x)$ & ì´ë¯¸ì§€ë¥¼ 128ì°¨ì› ë“±ì˜ ìˆ«ì ë²¡í„°ë¡œ ë³€í™˜. \\ \hline
\textbf{Triplet Loss} & ì„¸ ìŒ ì†ì‹¤ í•¨ìˆ˜ & A-PëŠ” ê°€ê¹ê²Œ, A-Nì€ ë©€ê²Œ ë§Œë“¦. \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ë¶„ë¥˜ê°€ ì•„ë‹ˆë¼ ë¹„êµë‹¤}

\subsection{1. The Challenge (One-shot Learning)}
ì§ì› 1,000ëª…ì˜ ì¶œì… í†µì œ ì‹œìŠ¤í…œì„ ë§Œë“ ë‹¤ê³  ê°€ì •í•©ì‹œë‹¤.
\begin{itemize}
    \item \textbf{Softmax (ì‹¤íŒ¨):} 1,000ê°œ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜. ì‹ ì… ì‚¬ì›ì´ ì˜¤ë©´ ë„¤íŠ¸ì›Œí¬ ì „ì²´ë¥¼ ì¬í•™ìŠµí•´ì•¼ í•©ë‹ˆë‹¤. (í™•ì¥ì„± 0ì )
    \item \textbf{Similarity (ì„±ê³µ):} ë‘ ì‚¬ì§„ì„ ë¹„êµí•˜ì—¬ \textbf{ê±°ë¦¬(Distance) $d$}ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.
    \begin{itemize}
        \item $d(\text{img1}, \text{img2}) \le \tau$: ê°™ì€ ì‚¬ëŒ (ë¬¸ ì—´ë¦¼)
        \item $d(\text{img1}, \text{img2}) > \tau$: ë‹¤ë¥¸ ì‚¬ëŒ (ê±°ë¶€)
    \end{itemize}
    ì‹ ì… ì‚¬ì›ì´ ì˜¤ë©´ ì‚¬ì§„ë§Œ DBì— ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤. ì¬í•™ìŠµì´ í•„ìš” ì—†ìŠµë‹ˆë‹¤.
\end{itemize}

\subsection{2. Siamese Network (ìƒ´ ë„¤íŠ¸ì›Œí¬)}
[Image of Siamese network architecture with two shared CNNs feeding into distance calculation]

ë‘ ê°œì˜ ë˜‘ê°™ì€ ë„¤íŠ¸ì›Œí¬ê°€ ë¨¸ë¦¬(ê°€ì¤‘ì¹˜)ë¥¼ ê³µìœ í•©ë‹ˆë‹¤.
\begin{enumerate}
    \item ë‘ ì´ë¯¸ì§€ $x^{(1)}, x^{(2)}$ë¥¼ ê°ê° CNNì— ë„£ìŠµë‹ˆë‹¤.
    \item ë§ˆì§€ë§‰ FC ì¸µì—ì„œ ë‚˜ì˜¨ ë²¡í„°(ì¸ì½”ë”©) $f(x^{(1)}), f(x^{(2)})$ë¥¼ ì–»ìŠµë‹ˆë‹¤.
    \item ë‘ ë²¡í„° ì‚¬ì´ì˜ ìœ í´ë¦¬ë“œ ê±°ë¦¬ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
    $$ d(x^{(1)}, x^{(2)}) = || f(x^{(1)}) - f(x^{(2)}) ||^2 $$
\end{enumerate}

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Deep Dive: Triplet Loss (íŠ¸ë¦¬í”Œë › ì†ì‹¤)}

ìƒ´ ë„¤íŠ¸ì›Œí¬ë¥¼ ì–´ë–»ê²Œ í•™ìŠµì‹œí‚¬ê¹Œìš”? ì„¸ ì¥ì˜ ì‚¬ì§„ì„ í•œ ì„¸íŠ¸(Triplet)ë¡œ ë¬¶ì–´ í•™ìŠµí•©ë‹ˆë‹¤.

\begin{itemize}
    \item \textbf{Anchor (A):} ê¸°ì¤€ì´ ë˜ëŠ” ë‚´ ì‚¬ì§„.
    \item \textbf{Positive (P):} ë‚˜ì™€ ê°™ì€ ì‚¬ëŒì˜ ë‹¤ë¥¸ ì‚¬ì§„.
    \item \textbf{Negative (N):} ë‚˜ì™€ ë‹¤ë¥¸ ì‚¬ëŒ(ì˜í¬)ì˜ ì‚¬ì§„.
\end{itemize}

\begin{mathbox}{Loss Function Derivation}
ìš°ë¦¬ì˜ ëª©í‘œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
$$ ||f(A) - f(P)||^2 \le ||f(A) - f(N)||^2 $$
(Aì™€ P ì‚¬ì´ì˜ ê±°ë¦¬ê°€ Aì™€ N ì‚¬ì´ì˜ ê±°ë¦¬ë³´ë‹¤ ì‘ì•„ì•¼ í•œë‹¤.)

í•˜ì§€ë§Œ ì‹ ê²½ë§ì´ $f(x)=0$ (ëª¨ë“  ì¶œë ¥ì„ 0ìœ¼ë¡œ)ìœ¼ë¡œ í•™ìŠµí•´ë²„ë¦¬ë©´, $0 \le 0$ì´ ë˜ì–´ë²„ë¦½ë‹ˆë‹¤(Trivial Solution). ì´ë¥¼ ë§‰ê¸° ìœ„í•´ \textbf{ë§ˆì§„($\alpha$)}ì„ ë‘¡ë‹ˆë‹¤.

$$ ||f(A) - f(P)||^2 - ||f(A) - f(N)||^2 + \alpha \le 0 $$

ìµœì¢… ì†ì‹¤ í•¨ìˆ˜ (ReLU í˜•íƒœ):
$$ L(A, P, N) = \max(0, ||f(A) - f(P)||^2 - ||f(A) - f(N)||^2 + \alpha) $$
\end{mathbox}

% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: Triplet Loss}

TensorFlow/Keras ìŠ¤íƒ€ì¼ì˜ ì†ì‹¤ í•¨ìˆ˜ êµ¬í˜„ì…ë‹ˆë‹¤.

\begin{lstlisting}[language=Python, caption=Triplet Loss Function, breaklines=true]
import tensorflow as tf

def triplet_loss(y_true, y_pred, alpha=0.2):
    """
    y_pred: [Anchor, Positive, Negative] ì„ë² ë”©ì´ ì—°ê²°ëœ í…ì„œ
    """
    # 1. ì„ë² ë”© ë²¡í„° ë¶„ë¦¬ (ì „ì²´ ê¸¸ì´ì˜ 1/3ì”©)
    total_len = y_pred.shape[1]
    emb_size = total_len // 3
    
    anchor = y_pred[:, 0:emb_size]
    positive = y_pred[:, emb_size:2*emb_size]
    negative = y_pred[:, 2*emb_size:]
    
    # 2. ê±°ë¦¬ ê³„ì‚° (ì œê³±í•©)
    # axis=-1: ë²¡í„°ì˜ ê° ì„±ë¶„ë³„ í•©
    pos_dist = tf.reduce_sum(tf.square(anchor - positive), axis=-1)
    neg_dist = tf.reduce_sum(tf.square(anchor - negative), axis=-1)
    
    # 3. Loss ê³„ì‚° (Margin ì¶”ê°€)
    basic_loss = pos_dist - neg_dist + alpha
    
    # 4. max(0, loss)
    loss = tf.maximum(basic_loss, 0.0)
    
    return tf.reduce_mean(loss)
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\begin{warningbox}{Hard Triplet Mining (í•™ìŠµ ë°ì´í„° ì„ ì •)}
ëœë¤í•˜ê²Œ A, P, Nì„ ê³ ë¥´ë©´ í•™ìŠµì´ ì˜ ì•ˆ ë©ë‹ˆë‹¤. ì™œëƒí•˜ë©´ ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ëœë¤í•œ ë‘ ì‚¬ëŒ(A, N)ì€ ì´ë¯¸ ì¶©ë¶„íˆ ë‹¤ë¥´ê²Œ ìƒê²¼ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ($Loss=0$)
í•™ìŠµ íš¨ìœ¨ì„ ìœ„í•´ \textbf{"Aì™€ Nì´ ê½¤ ë‹®ì€ ê²½ìš°(Hard Triplet)"}ë¥¼ ê³¨ë¼ë‚´ì–´ í•™ìŠµì‹œì¼œì•¼ í•©ë‹ˆë‹¤.
\end{warningbox}

\textbf{Q. ì–¼êµ´ ë§ê³  ë‹¤ë¥¸ ê±°ì—ë„ ì“¸ ìˆ˜ ìˆë‚˜ìš”?} \\
\textbf{A.} ë„¤! ì„œëª… ì¸ì‹, ì§€ë¬¸ ì¸ì‹, ì‹¬ì§€ì–´ \textbf{ì´ë¯¸ì§€ ê²€ìƒ‰(ì‡¼í•‘ëª°ì—ì„œ ë¹„ìŠ·í•œ ì˜· ì°¾ê¸°)} ë“± "ìœ ì‚¬í•œ ê²ƒì„ ì°¾ëŠ”" ëª¨ë“  ë¶„ì•¼ì— ì“°ì…ë‹ˆë‹¤.

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ì–¼êµ´ ì¸ì‹ì€ CNNì´ ì¶”ì¶œí•œ \textbf{'ë‚´ìš©(Content)'}ì„ ë¹„êµí•˜ëŠ” ê¸°ìˆ ì´ì—ˆìŠµë‹ˆë‹¤.
ê·¸ë ‡ë‹¤ë©´ CNNì´ ì¶”ì¶œí•œ \textbf{'í™”í’(Style)'}ë§Œ ë”°ë¡œ ë–¼ì–´ë‚¼ ìˆ˜ë„ ìˆì„ê¹Œìš”?

ë‹¤ìŒ ì‹œê°„ì—ëŠ” ë°˜ ê³ íì˜ í™”í’ì„ ë‚´ ì‚¬ì§„ì— ì…íˆëŠ” ì˜ˆìˆ ì ì¸ AI, \textbf{[Neural Style Transfer]}ì— ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤. CNNì˜ ê¹Šì€ ì¸µì´ ë¬´ì—‡ì„ ë³´ê³  ìˆëŠ”ì§€ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆëŠ” í¥ë¯¸ë¡œìš´ ì‹œê°„ì´ ë  ê²ƒì…ë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{Similarity:} ë¶„ë¥˜ê°€ ì•„ë‹Œ ê±°ë¦¬ ì¸¡ì • ë¬¸ì œë¡œ ì ‘ê·¼í•œë‹¤.
    \item \textbf{Siamese Network:} ê°€ì¤‘ì¹˜ë¥¼ ê³µìœ í•˜ëŠ” ìŒë‘¥ì´ ë„¤íŠ¸ì›Œí¬.
    \item \textbf{Triplet Loss:} $(A, P, N)$ êµ¬ì¡°. A-PëŠ” ë‹¹ê¸°ê³ , A-Nì€ ë¯¼ë‹¤.
    \item \textbf{Margin $\alpha$:} ëª¨ë¸ì´ ëª¨ë“  ì¶œë ¥ì„ 0ìœ¼ë¡œ ë§Œë“œëŠ” ê¼¼ìˆ˜ë¥¼ ë°©ì§€í•œë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}