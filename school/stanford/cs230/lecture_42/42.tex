\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{formulabox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ§® #1 (í•µì‹¬ ìˆ˜ì‹)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Sequence Models: \\ LSTM (Long Short-Term Memory)}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-9.] Deep Learning Fundamentals \& CNNs \textit{- Completed}
    \item[\textbf{Chapter 10.}] \textbf{Sequence Models (Current Part)}
    \begin{itemize}
        \item 10.1-10.3 RNN Basics \& GRU \textit{- Completed}
        \item \textbf{10.4 LSTM (Long Short-Term Memory)}
        \begin{itemize}
            \item Difference: Cell State vs Hidden State
            \item The Three Gates (Forget, Update, Output)
            \item Mathematical Equations
            \item GRU vs LSTM Comparison
        \end{itemize}
        \item 10.5 NLP \& Word Embeddings \textit{- Upcoming}
    \end{itemize}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ì— ë°°ìš´ GRUëŠ” \textbf{'ê¸°ìš¸ê¸° ì†Œì‹¤'}ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ê²Œì´íŠ¸ë¥¼ ë„ì…í•œ í›Œë¥­í•œ ëª¨ë¸ì´ì—ˆìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ GRUëŠ” 2014ë…„ì— ë‚˜ì˜¨ ëª¨ë¸ì´ê³ , ê·¸ë³´ë‹¤ í›¨ì”¬ ì „ì¸ 1997ë…„ì— ì œì•ˆë˜ì–´ ì§€ê¸ˆê¹Œì§€ \textbf{ì‹œí€€ìŠ¤ ëª¨ë¸ì˜ ì œì™•(Standard)}ìœ¼ë¡œ êµ°ë¦¼í•˜ê³  ìˆëŠ” ëª¨ë¸ì´ ìˆìŠµë‹ˆë‹¤.
ë°”ë¡œ \textbf{LSTM}ì…ë‹ˆë‹¤. GRUê°€ 2ê°œì˜ ê²Œì´íŠ¸ë¡œ íš¨ìœ¨ì„±ì„ ì¶”êµ¬í–ˆë‹¤ë©´, LSTMì€ 3ê°œì˜ ê²Œì´íŠ¸ë¡œ ê¸°ì–µì„ ë”ìš± ì •êµí•˜ê²Œ ì œì–´í•©ë‹ˆë‹¤. ì•¤ë“œë¥˜ ì‘ êµìˆ˜ë‹˜ì€ ë§í•©ë‹ˆë‹¤.
\textbf{"ë¬´ì—‡ì„ ì“¸ì§€ ëª¨ë¥´ê² ë‹¤ë©´, ì¼ë‹¨ LSTMë¶€í„° ì‹œì‘í•˜ì‹­ì‹œì˜¤."}

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ ì‹œí€€ìŠ¤ ëª¨ë¸ì˜ ì—…ê³„ í‘œì¤€ì¸ LSTMì˜ êµ¬ì¡°ì™€ ë™ì‘ ì›ë¦¬ë¥¼ íŒŒí—¤ì¹©ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{êµ¬ì¡°:} \textbf{Cell State($c$)}ì™€ \textbf{Hidden State($a$)}ê°€ ë¶„ë¦¬ëœ ì´ì¤‘ íŠ¸ë™ êµ¬ì¡°ë¥¼ ì´í•´í•©ë‹ˆë‹¤.
    \item \textbf{ê²Œì´íŠ¸:} Forget, Update, Outputì´ë¼ëŠ” 3ê°œì˜ ê²Œì´íŠ¸ ì—­í• ì„ íŒŒì•…í•©ë‹ˆë‹¤.
    \item \textbf{ìˆ˜ì‹:} ê³¼ê±°ë¥¼ ìŠê³ ($\Gamma_f$) ìƒˆë¡œìš´ ê¸°ì–µì„ ë”í•˜ëŠ”($\Gamma_u$) ë…ë¦½ì  ì œì–´ ê³µì‹ì„ ìµí™ë‹ˆë‹¤.
    \item \textbf{ë¹„êµ:} GRUì™€ LSTMì˜ ì¥ë‹¨ì ì„ ë¹„êµí•˜ê³  ì„ íƒ ê¸°ì¤€ì„ ì„¸ì›ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ê¸°í˜¸} & \textbf{ì—­í• } \\ \hline
\textbf{Cell State} & $c^{\langle t \rangle}$ & \textbf{ì¥ê¸° ê¸°ì–µ ê³ ì†ë„ë¡œ.} ë‚´ë¶€ì—ì„œë§Œ ìˆœí™˜í•˜ë©° ì •ë³´ë¥¼ ë³´ì¡´í•¨. \\ \hline
\textbf{Hidden State} & $a^{\langle t \rangle}$ & \textbf{ë‹¨ê¸° ìƒíƒœ ë° ì¶œë ¥.} Cell Stateë¥¼ ê°€ê³µí•˜ì—¬ ì™¸ë¶€ë¡œ ë‚´ë³´ëƒ„. \\ \hline
\textbf{Forget Gate} & $\Gamma_f$ & ê³¼ê±°ì˜ ê¸°ì–µì„ ì‚­ì œí•˜ëŠ” ë¹„ìœ¨ (0~1). \\ \hline
\textbf{Update Gate} & $\Gamma_u$ & ìƒˆë¡œìš´ ê¸°ì–µì„ ì €ì¥í•˜ëŠ” ë¹„ìœ¨ (0~1). \\ \hline
\textbf{Output Gate} & $\Gamma_o$ & í˜„ì¬ ìƒíƒœë¥¼ ë‹¤ìŒ ì¸µìœ¼ë¡œ ë‚´ë³´ë‚´ëŠ” ë¹„ìœ¨ (0~1). \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ê¸°ì–µì˜ ì •êµí•œ ì œì–´}

\subsection{1. The Key Difference: $c$ and $a$}
GRUëŠ” ê¸°ì–µ($c$)ê³¼ ì¶œë ¥($a$)ì´ í†µí•©ë˜ì–´ ìˆì—ˆìŠµë‹ˆë‹¤. ë°˜ë©´ LSTMì€ ì´ë¥¼ ì—„ê²©íˆ ë¶„ë¦¬í•©ë‹ˆë‹¤.



\begin{itemize}
    \item \textbf{Cell State ($c^{\langle t \rangle}$):} ê¸°ì–µì˜ í•µì‹¬ì…ë‹ˆë‹¤. ê¸°ìš¸ê¸°ê°€ ì†Œì‹¤ë˜ì§€ ì•Šë„ë¡ ë³´í˜¸ë°›ëŠ” ê²½ë¡œì…ë‹ˆë‹¤.
    \item \textbf{Hidden State ($a^{\langle t \rangle}$):} Cell Stateì— $\tanh$ë¥¼ ì”Œìš°ê³  Output Gateë¥¼ í†µê³¼ì‹œì¼œ ë§Œë“ , "ì§€ê¸ˆ ë‹¹ì¥ í•„ìš”í•œ ì •ë³´"ì…ë‹ˆë‹¤.
\end{itemize}

\subsection{2. The Three Gates (3ê°œì˜ ë¬¸ì§€ê¸°)}
LSTMì€ ê¸°ì–µì„ ê´€ë¦¬í•˜ê¸° ìœ„í•´ 3ë‹¨ê³„ ê²€ë¬¸ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

\begin{analogybox}{LSTMì˜ ê¸°ì–µ ê´€ë¦¬ ì‹œìŠ¤í…œ}
\begin{itemize}
    \item \textbf{Forget Gate ($\Gamma_f$): [ì“°ë ˆê¸°í†µ]} "ì´ì „ ê¸°ì–µ ì¤‘ ì“¸ëª¨ì—†ëŠ” ê±´ ë²„ë ¤ë¼." (ì˜ˆ: ë¬¸ë‹¨ì´ ë°”ë€Œì—ˆìœ¼ë‹ˆ ì´ì „ ì£¼ì œ ì‚­ì œ)
    \item \textbf{Update Gate ($\Gamma_u$): [ê¸°ë¡ì¥]} "ìƒˆë¡œìš´ ì •ë³´ ì¤‘ ì¤‘ìš”í•œ ê²ƒë§Œ ì ì–´ë¼." (ì˜ˆ: ìƒˆë¡œìš´ ì£¼ì–´ ë“±ë¡)
    \item \textbf{Output Gate ($\Gamma_o$): [ìŠ¤í”¼ì»¤]} "ì§€ê¸ˆ ë‹¹ì¥ í•„ìš”í•œ ì •ë³´ë§Œ ë§í•´ë¼." (ì˜ˆ: ë‹¤ìŒ ë‹¨ì–´ ì˜ˆì¸¡ì— í•„ìš”í•œ ì •ë³´ë§Œ ë°œì„¤)
\end{itemize}
\end{analogybox}

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Deep Dive: LSTM Equations}

ì´ ìˆ˜ì‹ë“¤ì´ LSTMì˜ ì‘ë™ ì›ë¦¬ë¥¼ ë³´ì—¬ì£¼ëŠ” ì§€ë„ì…ë‹ˆë‹¤.


\subsection{1. Gate Calculation}
ì´ì „ ìƒíƒœ($a^{\langle t-1 \rangle}$)ì™€ í˜„ì¬ ì…ë ¥($x^{\langle t \rangle}$)ì„ ë³´ê³  ê²Œì´íŠ¸ë¥¼ ì–¼ë§ˆë‚˜ ì—´ì§€ ê²°ì •í•©ë‹ˆë‹¤.
$$ \Gamma_f = \sigma(W_f[a^{\langle t-1 \rangle}, x^{\langle t \rangle}] + b_f) $$
$$ \Gamma_u = \sigma(W_u[a^{\langle t-1 \rangle}, x^{\langle t \rangle}] + b_u) $$
$$ \Gamma_o = \sigma(W_o[a^{\langle t-1 \rangle}, x^{\langle t \rangle}] + b_o) $$

\subsection{2. Memory Update (í•µì‹¬)}
\begin{formulabox}{Cell State Update}
$$ c^{\langle t \rangle} = \underbrace{\Gamma_f \cdot c^{\langle t-1 \rangle}}_{\text{ê³¼ê±° ê¸°ì–µ ì‚­ì œ}} + \underbrace{\Gamma_u \cdot \tilde{c}^{\langle t \rangle}}_{\text{ìƒˆ ê¸°ì–µ ì¶”ê°€}} $$
\begin{itemize}
    \item \textbf{GRUì™€ì˜ ì°¨ì´:} GRUëŠ” $\Gamma_u$ í•˜ë‚˜ë¡œ ê³¼ê±°ì™€ í˜„ì¬ì˜ ë¹„ìœ¨ì„ ì‹œì†Œì²˜ëŸ¼ ì¡°ì ˆí–ˆìŠµë‹ˆë‹¤ ($1-\Gamma_u$).
    \item \textbf{LSTM:} $\Gamma_f$ì™€ $\Gamma_u$ê°€ \textbf{ë…ë¦½ì }ì…ë‹ˆë‹¤. ê³¼ê±°ë¥¼ ê¸°ì–µí•˜ë©´ì„œ($\Gamma_f=1$) ë™ì‹œì— ìƒˆë¡œìš´ ì¤‘ìš”í•œ ì •ë³´ë„ ì¶”ê°€($\Gamma_u=1$)í•  ìˆ˜ ìˆì–´ í‘œí˜„ë ¥ì´ ë” í’ë¶€í•©ë‹ˆë‹¤.
\end{itemize}
\end{formulabox}

\subsection{3. Output Generation}
$$ a^{\langle t \rangle} = \Gamma_o \cdot \tanh(c^{\langle t \rangle}) $$

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Comparison: GRU vs LSTM}

\begin{center}
\begin{tabular}{|c|c|c|}
\hline
\textbf{íŠ¹ì§•} & \textbf{GRU} & \textbf{LSTM} \\ \hline
\textbf{ê²Œì´íŠ¸ ìˆ˜} & 2ê°œ (Update, Reset) & 3ê°œ (Forget, Update, Output) \\ \hline
\textbf{ë³µì¡ë„} & ë‹¨ìˆœí•¨ (Simpler) & ë³µì¡í•¨ (Powerful) \\ \hline
\textbf{ë°ì´í„° ì–‘} & ì ì„ ë•Œ ìœ ë¦¬ & ë§ì„ ë•Œ ìœ ë¦¬ (ëŒ€ìš©ëŸ‰ í•™ìŠµ) \\ \hline
\textbf{ìœ„ìƒ} & ê²½ëŸ‰í™” ëª¨ë¸ & \textbf{ì—…ê³„ í‘œì¤€ (Default Choice)} \\ \hline
\end{tabular}
\end{center}

% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: LSTM Cell}

\begin{lstlisting}[language=Python, caption=LSTM Cell Forward Implementation, breaklines=true]
import numpy as np

def sigmoid(x):
    return 1 / (1 + np.exp(-x))

def lstm_cell_forward(xt, a_prev, c_prev, parameters):
    """
    xt: í˜„ì¬ ì…ë ¥
    a_prev: ì´ì „ ì€ë‹‰ ìƒíƒœ (ë‹¨ê¸°)
    c_prev: ì´ì „ ì…€ ìƒíƒœ (ì¥ê¸°)
    """
    # íŒŒë¼ë¯¸í„° ë¡œë“œ (Wf, Wu, Wc, Wo ë“±)
    concat = np.concatenate((a_prev, xt), axis=0)
    
    # 1. Gates ê³„ì‚°
    ft = sigmoid(np.dot(parameters["Wf"], concat) + parameters["bf"]) # Forget
    it = sigmoid(np.dot(parameters["Wu"], concat) + parameters["bu"]) # Update(Input)
    ot = sigmoid(np.dot(parameters["Wo"], concat) + parameters["bo"]) # Output
    
    # 2. ìƒˆë¡œìš´ ê¸°ì–µ í›„ë³´ (Candidate)
    c_tilde = np.tanh(np.dot(parameters["Wc"], concat) + parameters["bc"])
    
    # 3. Cell State ì—…ë°ì´íŠ¸ (í•µì‹¬!)
    # ê³¼ê±°ë¥¼ ìŠì„ ê±´ ìŠê³ (ft), ìƒˆê²ƒì„ ë”í•¨(it)
    c_next = ft * c_prev + it * c_tilde
    
    # 4. Hidden State ì—…ë°ì´íŠ¸ (ì¶œë ¥)
    a_next = ot * np.tanh(c_next)
    
    return a_next, c_next
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\textbf{Q. Peephole Connectionì´ë€ ë­”ê°€ìš”?} \\
\textbf{A.} ê¸°ë³¸ LSTMì—ì„œ ê²Œì´íŠ¸($\Gamma$)ëŠ” $a^{\langle t-1 \rangle}$ì™€ $x^{\langle t \rangle}$ë§Œ ë´…ë‹ˆë‹¤. Peephole ë³€í˜•ì€ ê²Œì´íŠ¸ê°€ \textbf{Cell State($c^{\langle t-1 \rangle}$)ë„ í›”ì³ë³´ê³ (Peep)} ê²°ì •ì„ ë‚´ë¦¬ê²Œ í•©ë‹ˆë‹¤. "ê¸°ì–µí†µì´ ì–¼ë§ˆë‚˜ ì°¼ëŠ”ì§€ ë³´ê³  ë¬¸ì„ ì—´ì§€ ë§ì§€ ì •í•œë‹¤"ëŠ” ê°œë…ì…ë‹ˆë‹¤.

\textbf{Q. ì™œ LSTMì´ ê¸°ìš¸ê¸° ì†Œì‹¤ì— ê°•í•œê°€ìš”?} \\
\textbf{A.} $c^{\langle t \rangle} = c^{\langle t-1 \rangle} + \dots$ í˜•íƒœì˜ \textbf{ë§ì…ˆ ì—°ì‚°} ë•Œë¬¸ì…ë‹ˆë‹¤. ì—­ì „íŒŒ ì‹œ ë§ì…ˆì€ ê¸°ìš¸ê¸°ë¥¼ ê·¸ëŒ€ë¡œ($\times 1$) ì „ë‹¬í•˜ëŠ” íŠ¹ì„±ì´ ìˆì–´, ê¹Šì€ ì‹œê°„ê¹Œì§€ ì˜¤ì°¨ê°€ ì˜ ì „ë‹¬ë©ë‹ˆë‹¤. (ResNetê³¼ ìœ ì‚¬ ì›ë¦¬)

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
ì´ì œ ìš°ë¦¬ëŠ” ì‹œí€€ìŠ¤ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê°€ì¥ ê°•ë ¥í•œ ì—”ì§„(LSTM)ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ì´ ì—”ì§„ì— ë„£ì„ \textbf{ì—°ë£Œ(ë°ì´í„°)}ë¥¼ ê°€ê³µí•  ì°¨ë¡€ì…ë‹ˆë‹¤.

ì»´í“¨í„°ëŠ” 'ì‚¬ê³¼', 'ë°”ë‚˜ë‚˜'ë¥¼ ì´í•´í•˜ì§€ ëª»í•©ë‹ˆë‹¤. ìˆ«ìë¡œ ë°”ê¿”ì•¼ í•˜ëŠ”ë°, ë‹¨ìˆœíˆ $1, 2$ë¡œ ë°”ê¾¸ë©´ ë‹¨ì–´ ê°„ ì˜ë¯¸ ê´€ê³„ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.
ë‹¤ìŒ ì‹œê°„ì—ëŠ” ë‹¨ì–´ì˜ ì˜ë¯¸ë¥¼ ë²¡í„° ê³µê°„ì— ë§¤í•‘í•˜ì—¬ \textbf{"ì™• - ë‚¨ì + ì—¬ì = ì—¬ì™•"}ì´ë¼ëŠ” ì—°ì‚°ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ë§ˆë²•, \textbf{[Word Embedding (Word2Vec, GloVe)]}ì— ëŒ€í•´ ë‹¤ë£¨ê² ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{LSTM:} 3ê°œì˜ ê²Œì´íŠ¸ë¡œ ê¸°ì–µì„ ê´€ë¦¬í•˜ëŠ” ì‹œí€€ìŠ¤ ëª¨ë¸ì˜ í‘œì¤€.
    \item \textbf{Structure:} ì¥ê¸° ê¸°ì–µ($c$)ê³¼ ë‹¨ê¸° ìƒíƒœ($a$)ë¥¼ ë¶„ë¦¬í•˜ì—¬ ìš´ì˜í•œë‹¤.
    \item \textbf{Gates:} Forget(ì‚­ì œ), Update(ì¶”ê°€), Output(ì¶œë ¥).
    \item \textbf{Strategy:} ì¼ë‹¨ LSTMì„ ê¸°ë³¸ìœ¼ë¡œ ì“°ê³ , ê²½ëŸ‰í™”ê°€ í•„ìš”í•˜ë©´ GRUë¥¼ ê³ ë ¤í•˜ë¼.
\end{enumerate}
\end{summarybox}

\end{document}