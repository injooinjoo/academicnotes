\documentclass[a4paper, 11pt]{article}

% --- íŒ¨í‚¤ì§€ ì„¤ì • ---
\usepackage{kotex} % í•œê¸€ ì§€ì›
\usepackage{geometry} % ì—¬ë°± ì„¤ì •
\geometry{left=25mm, right=25mm, top=25mm, bottom=25mm}
\usepackage{amsmath, amssymb, amsfonts} % ìˆ˜ì‹ íŒ¨í‚¤ì§€
\usepackage{graphicx}
\usepackage{adjustbox}  % í‘œ/ë°•ìŠ¤ í¬ê¸° ì¡°ì ˆ % ì´ë¯¸ì§€ ì‚½ì…
\usepackage{hyperref} % í•˜ì´í¼ë§í¬
\usepackage{xcolor} % ìƒ‰ìƒ ì§€ì›
\usepackage{listings} % ì½”ë“œ ë¸”ë¡
\usepackage[most]{tcolorbox}
\tcbuselibrary{breakable} % ë°•ìŠ¤ ë””ìì¸
\usepackage{enumitem} % ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼
\usepackage{booktabs} % í‘œ ë””ìì¸
\usepackage{array} % í‘œ ì •ë ¬

% --- ìƒ‰ìƒ ì •ì˜ ---
\definecolor{conceptblue}{RGB}{60, 100, 160}
\definecolor{analogygreen}{RGB}{80, 160, 100}
\definecolor{alertred}{RGB}{200, 60, 60}
\definecolor{exampleorange}{RGB}{230, 120, 30}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{backcolour}{rgb}{0.96,0.96,0.96}

% --- ì½”ë“œ ìŠ¤íƒ€ì¼ ì„¤ì • ---
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{analogygreen},
    keywordstyle=\color{conceptblue},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{exampleorange},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4,
    frame=single
}
\lstset{style=mystyle}

% --- ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì •ì˜ ---
\newtcolorbox{summarybox}[1]{
    colback=conceptblue!5!white,
    colframe=conceptblue!80!black,
    fonttitle=\bfseries,
    title=ğŸ“Œ #1
}

\newtcolorbox{analogybox}[1]{
    colback=analogygreen!5!white,
    colframe=analogygreen!80!black,
    fonttitle=\bfseries,
    title=ğŸ’¡ #1 (ì§ê´€ì  ë¹„ìœ )
}

\newtcolorbox{warningbox}[1]{
    colback=alertred!5!white,
    colframe=alertred!80!black,
    fonttitle=\bfseries,
    title=âš ï¸ #1 (ì˜¤í•´ ë°©ì§€ ê°€ì´ë“œ)
}

\newtcolorbox{formulabox}[1]{
    colback=exampleorange!5!white,
    colframe=exampleorange!80!black,
    fonttitle=\bfseries,
    title=ğŸ§® #1 (í•µì‹¬ ìˆ˜ì‹)
}

% --- ë¬¸ì„œ ì •ë³´ ---
\title{\textbf{[CS230] Sequence Models: \\ Vanishing Gradients \& GRU}}
\author{Lecturer: Gemini (Integrated Editor)}
\date{}

\begin{document}

\maketitle

% --- 1. ì „ì²´ ëª©ì°¨ (TOC) ---
\section*{ğŸ“š Course Table of Contents}
\begin{itemize}
    \item[Chapter 1-9.] Deep Learning Fundamentals \& CNNs \textit{- Completed}
    \item[\textbf{Chapter 10.}] \textbf{Sequence Models (Current Part)}
    \begin{itemize}
        \item 10.1 RNN Basics \textit{- Completed}
        \item 10.2 Various RNN Architectures \textit{- Completed}
        \item \textbf{10.3 Vanishing Gradients \& Gated Units}
        \begin{itemize}
            \item The Problem: Vanishing Gradients
            \item The Solution: Gating Mechanism
            \item GRU (Gated Recurrent Unit)
            \item Implementation: Update \& Reset Gates
        \end{itemize}
        \item 10.4 LSTM (Long Short-Term Memory) \textit{- Upcoming}
    \end{itemize}
\end{itemize}

\vspace{0.5cm}
\hrule
\vspace{0.5cm}

% --- 3. ì´ì „ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ì§€ë‚œ ì‹œê°„ ë³µìŠµ ë° ì—°ê²°}
ì§€ë‚œ ì‹œê°„ì— ë°°ìš´ ê¸°ë³¸ RNNì€ ì´ë¡ ì ìœ¼ë¡œëŠ” ì™„ë²½í•´ ë³´ì…ë‹ˆë‹¤. ê³¼ê±° ì •ë³´ë¥¼ í˜„ì¬ë¡œ ì „ë‹¬í•˜ë‹ˆê¹Œìš”.
í•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” ë¬¸ì¥ì´ 10ë‹¨ì–´ë§Œ ë„˜ì–´ê°€ë„ ì•ë¶€ë¶„ ë‚´ìš©ì„ ê¹Œë§£ê²Œ ìŠì–´ë²„ë¦½ë‹ˆë‹¤.
\textbf{"The cat, which ate ..., was full."}
RNNì€ ì¤‘ê°„ ìˆ˜ì‹ì–´ê°€ ê¸¸ì–´ì§€ë©´ ì£¼ì–´ 'cat(ë‹¨ìˆ˜)'ì„ ìŠì–´ë²„ë¦¬ê³  ë™ì‚¬ 'was'ë¥¼ ì˜ˆì¸¡í•˜ì§€ ëª»í•©ë‹ˆë‹¤.
ì´ê²ƒì´ ë°”ë¡œ \textbf{ê¸°ìš¸ê¸° ì†Œì‹¤(Vanishing Gradient)} ë¬¸ì œì…ë‹ˆë‹¤. ì˜¤ëŠ˜ì€ ì´ ë‚œì œë¥¼ í•´ê²°í•œ \textbf{GRU}ë¥¼ ë°°ì›ë‹ˆë‹¤.

% --- 4. ê°œìš” ---
\section{Unit Overview}
\begin{summarybox}{í•µì‹¬ ëª©í‘œ}
ì´ ë‹¨ì›ì€ RNNì˜ ì¥ê¸° ì˜ì¡´ì„± ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ê²Œì´íŠ¸(Gate) ë©”ì»¤ë‹ˆì¦˜ì„ ë‹¤ë£¹ë‹ˆë‹¤.
\begin{itemize}
    \item \textbf{ì›ì¸:} ì—­ì „íŒŒ ì‹œ ê¸°ìš¸ê¸°ê°€ ì§€ìˆ˜ì ìœ¼ë¡œ ì‘ì•„ì ¸ì„œ ì´ˆê¸° ê¸°ì–µì´ ì‚¬ë¼ì§€ëŠ” ìˆ˜í•™ì  ì›ë¦¬ë¥¼ ì´í•´í•©ë‹ˆë‹¤.
    \item \textbf{í•´ê²°:} ì •ë³´ë¥¼ "ì–¼ë§ˆë‚˜ ìœ ì§€í•˜ê³  ë²„ë¦´ì§€" ê²°ì •í•˜ëŠ” \textbf{ê²Œì´íŠ¸(Gate)} ê°œë…ì„ ë„ì…í•©ë‹ˆë‹¤.
    \item \textbf{ëª¨ë¸:} LSTMì˜ ê°„ì†Œí™” ë²„ì „ì¸ \textbf{GRU}ì˜ êµ¬ì¡°ì™€ ìˆ˜ì‹ì„ ë§ˆìŠ¤í„°í•©ë‹ˆë‹¤.
\end{itemize}
\end{summarybox}

% --- 5. ìš©ì–´ ì •ë¦¬ ---
\section{Essential Terminology}
\begin{center}
\begin{tabular}{|c|l|l|}
\hline
\textbf{ìš©ì–´} & \textbf{ì˜ë¯¸} & \textbf{ì—­í• } \\ \hline
\textbf{Vanishing Gradient} & ê¸°ìš¸ê¸° ì†Œì‹¤ & ê¹Šì€ ì‹ ê²½ë§ í•™ìŠµì„ ë°©í•´í•˜ëŠ” ì£¼ë²”. \\ \hline
\textbf{Gate ($\Gamma$)} & ë¬¸ì§€ê¸° (0~1) & ì •ë³´ íë¦„ì„ ì œì–´í•˜ëŠ” ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜. \\ \hline
\textbf{Update Gate ($\Gamma_u$)} & ì—…ë°ì´íŠ¸ ê²Œì´íŠ¸ & ê³¼ê±° ê¸°ì–µì„ ì–¼ë§ˆë‚˜ ìœ ì§€í• ì§€ ê²°ì •. \\ \hline
\textbf{Reset Gate ($\Gamma_r$)} & ë¦¬ì…‹ ê²Œì´íŠ¸ & ê³¼ê±° ê¸°ì–µì„ ì–¼ë§ˆë‚˜ ë¬´ì‹œí• ì§€ ê²°ì •. \\ \hline
\end{tabular}
\end{center}

% --- 6. í•µì‹¬ ê°œë… ìƒì„¸ ì„¤ëª… ---
\section{Core Concepts: ê¸°ì–µì˜ ë³´ì¡´}

\subsection{1. The Problem: Vanishing Gradients}
RNNì—ì„œ $t=100$ ì‹œì ì˜ ì˜¤ì°¨ë¥¼ $t=1$ ì‹œì ê¹Œì§€ ì „íŒŒí•˜ë ¤ë©´ ê°€ì¤‘ì¹˜ í–‰ë ¬ $W$ë¥¼ 100ë²ˆ ê³±í•´ì•¼ í•©ë‹ˆë‹¤.

\begin{analogybox}{ë³µì‚¬ë³¸ì˜ ë³µì‚¬ë³¸}
ë¬¸ì„œë¥¼ ë³µì‚¬í•˜ê³ , ê·¸ ë³µì‚¬ë³¸ì„ ë˜ ë³µì‚¬í•˜ëŠ” ê³¼ì •ì„ 100ë²ˆ ë°˜ë³µí•œë‹¤ê³  ìƒìƒí•´ ë³´ì„¸ìš”.
ì¡°ê¸ˆì´ë¼ë„ íë¦¿í•´ì§€ë©´($W < 1$), 100ë²ˆì§¸ ë³µì‚¬ë³¸ì€ ë°±ì§€ê°€ ë˜ì–´ë²„ë¦½ë‹ˆë‹¤.
ë°˜ëŒ€ë¡œ ì§„í•´ì§€ë©´($W > 1$), ê²€ì€ìƒ‰ ì‰í¬ ë©ì–´ë¦¬ê°€ ë©ë‹ˆë‹¤(Exploding).
\end{analogybox}

\subsection{2. The Solution: Gated Recurrent Unit (GRU)}
í•µì‹¬ ì•„ì´ë””ì–´ëŠ” \textbf{"ê¸°ì–µì„ ìœ„í•œ ì „ìš© ê¸ˆê³ (Memory Cell)ë¥¼ ë§Œë“¤ê³  ë¬¸ì§€ê¸°ë¥¼ ì„¸ìš°ì"}ëŠ” ê²ƒì…ë‹ˆë‹¤.

\begin{formulabox}{GRUì˜ í•µì‹¬ ìˆ˜ì‹}
$$ c^{\langle t \rangle} = \Gamma_u \cdot \tilde{c}^{\langle t \rangle} + (1 - \Gamma_u) \cdot c^{\langle t-1 \rangle} $$
\begin{itemize}
    \item $\Gamma_u$ (Update Gate): 0ì´ë©´ ë¬¸ì„ ë‹«ìŠµë‹ˆë‹¤.
    \item $\Gamma_u \approx 0$ ì¼ ë•Œ: $c^{\langle t \rangle} \approx c^{\langle t-1 \rangle}$.
    \item \textbf{ì˜ë¯¸:} ê³¼ê±°ì˜ ê¸°ì–µ($c^{\langle t-1 \rangle}$)ì´ ì•„ë¬´ëŸ° ë³€í˜• ì—†ì´(í–‰ë ¬ ê³±ì…ˆ ì—†ì´) ê·¸ëŒ€ë¡œ ë³µì‚¬ë˜ì–´ ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤. \textbf{ê¸°ìš¸ê¸° ì†Œì‹¤ ì—†ì´ ê³ ì†ë„ë¡œì²˜ëŸ¼ ì „ë‹¬}ë©ë‹ˆë‹¤.
\end{itemize}
\end{formulabox}

\vspace{0.5cm}\hrule\vspace{0.5cm}

\section{Deep Dive: GRU Gates Detail}

GRUëŠ” ë‘ ê°œì˜ ê²Œì´íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

\begin{enumerate}
    \item \textbf{Update Gate ($\Gamma_u$):} "ì´ ê¸°ì–µì„ ê³„ì† ê°€ì ¸ê°ˆê¹Œ?" (ë‹¨ìˆ˜/ë³µìˆ˜ ì •ë³´ ìœ ì§€)
    $$ \Gamma_u = \sigma(W_u[c^{\langle t-1 \rangle}, x^{\langle t \rangle}] + b_u) $$
    
    \item \textbf{Reset Gate ($\Gamma_r$):} "ì´ì œ ê³¼ê±°ëŠ” ìŠì„ê¹Œ?" (ë¬¸ì¹¨í‘œê°€ ë‚˜ì˜¤ë©´ ë¦¬ì…‹)
    $$ \Gamma_r = \sigma(W_r[c^{\langle t-1 \rangle}, x^{\langle t \rangle}] + b_r) $$
    
    \item \textbf{Candidate Memory ($\tilde{c}$):} ìƒˆë¡œìš´ ê¸°ì–µ í›„ë³´
    $$ \tilde{c}^{\langle t \rangle} = \tanh(W_c[\Gamma_r \cdot c^{\langle t-1 \rangle}, x^{\langle t \rangle}] + b_c) $$
\end{enumerate}

% --- 7. êµ¬í˜„ ì½”ë“œ ---
\section{Implementation: GRU Cell}

\begin{lstlisting}[language=Python, caption=GRU Cell Forward Implementation, breaklines=true]
import numpy as np

def sigmoid(x):
    return 1 / (1 + np.exp(-x))

def gru_cell_forward(xt, a_prev, parameters):
    """
    xt: í˜„ì¬ ì…ë ¥
    a_prev: ê³¼ê±° ì€ë‹‰ ìƒíƒœ (GRUì—ì„  Memory Cell cì™€ ë™ì¼)
    """
    # íŒŒë¼ë¯¸í„° ë¡œë“œ
    W_u = parameters["Wu"] # Update Gate Weights
    W_r = parameters["Wr"] # Reset Gate Weights
    W_c = parameters["Wc"] # Candidate Memory Weights
    
    # ì…ë ¥ ê²°í•© (Concatenate)
    concat = np.concatenate((a_prev, xt), axis=0)
    
    # 1. Update Gate (Gamma_u)
    Gamma_u = sigmoid(np.dot(W_u, concat) + parameters["bu"])
    
    # 2. Reset Gate (Gamma_r)
    Gamma_r = sigmoid(np.dot(W_r, concat) + parameters["br"])
    
    # 3. Candidate Memory (c_tilde)
    # ê³¼ê±° ê¸°ì–µì— Reset Gate ì ìš©
    concat_reset = np.concatenate((Gamma_r * a_prev, xt), axis=0)
    c_candidate = np.tanh(np.dot(W_c, concat_reset) + parameters["bc"])
    
    # 4. Final Memory Update (The Magic Formula)
    # uê°€ 0ì´ë©´ ê³¼ê±° ê¸°ì–µ ë³´ì¡´, 1ì´ë©´ ìƒˆ ê¸°ì–µìœ¼ë¡œ ë®ì–´ì”€
    c_next = Gamma_u * c_candidate + (1 - Gamma_u) * a_prev
    
    return c_next
\end{lstlisting}

% --- 8. FAQ ---
\section{FAQ \& Pitfalls}

\begin{warningbox}{Gradient Clipping (ê¸°ìš¸ê¸° ìë¥´ê¸°)}
ê¸°ìš¸ê¸° ì†Œì‹¤ì˜ ë°˜ëŒ€ëŠ” \textbf{ê¸°ìš¸ê¸° í­ë°œ(Exploding Gradient)}ì…ë‹ˆë‹¤. ìˆ«ìê°€ ë„ˆë¬´ ì»¤ì ¸ì„œ `NaN`ì´ ëœ¹ë‹ˆë‹¤.
í•´ê²°ì±…ì€ ê°„ë‹¨í•©ë‹ˆë‹¤. ê¸°ìš¸ê¸° ë²¡í„°ì˜ í¬ê¸°(Norm)ê°€ íŠ¹ì • ê°’(ì˜ˆ: 5)ì„ ë„˜ìœ¼ë©´ ê°•ì œë¡œ ì¤„ì—¬ë²„ë¦¬ëŠ” \textbf{Gradient Clipping}ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
\end{warningbox}

\textbf{Q. GRUì™€ LSTM ì¤‘ ë­ê°€ ë” ì¢‹ë‚˜ìš”?} \\
\textbf{A.} \textbf{ì •ë‹µì€ ì—†ìŠµë‹ˆë‹¤.} GRUëŠ” êµ¬ì¡°ê°€ ë‹¨ìˆœí•´ì„œ(ê²Œì´íŠ¸ 2ê°œ) ì—°ì‚°ì´ ë¹ ë¥´ê³  ë°ì´í„°ê°€ ì ì„ ë•Œ ìœ ë¦¬í•©ë‹ˆë‹¤. LSTMì€ êµ¬ì¡°ê°€ ë³µì¡í•˜ì§€ë§Œ(ê²Œì´íŠ¸ 3ê°œ) í‘œí˜„ë ¥ì´ ë” ì¢‹ìŠµë‹ˆë‹¤. ë³´í†µ LSTMì„ ê¸°ë³¸ìœ¼ë¡œ ì“°ê³ , ì†ë„ê°€ ì¤‘ìš”í•˜ë©´ GRUë¥¼ ì”ë‹ˆë‹¤.

% --- 9. ë‹¤ìŒ ë‹¨ì› ì—°ê²° ---
\section*{ğŸ”— ë‹¤ìŒ ë‹¨ê³„ (Next Step)}
GRUëŠ” í›Œë¥­í•˜ê³  ë‹¨ìˆœí•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ë•Œë¡œëŠ” ë” ì„¬ì„¸í•œ ì œì–´ê°€ í•„ìš”í•©ë‹ˆë‹¤. GRUë³´ë‹¤ ì¡°ê¸ˆ ë” ë³µì¡í•˜ì§€ë§Œ, ë” ê°•ë ¥í•˜ê³  ë„ë¦¬ ì“°ì´ëŠ” í˜•ë‹˜ì´ ìˆìŠµë‹ˆë‹¤.

ë‹¤ìŒ ì‹œê°„ì—ëŠ” GRUì˜ í™•ì¥íŒì´ì RNNì˜ ì‚¬ì‹¤ìƒ í‘œì¤€(De facto Standard), \textbf{[LSTM (Long Short-Term Memory)]}ì— ëŒ€í•´ ë‹¤ë£¨ê² ìŠµë‹ˆë‹¤. 3ê°œì˜ ê²Œì´íŠ¸(Forget, Input, Output)ê°€ ì–´ë–»ê²Œ ê¸°ì–µì„ ìˆ˜ìˆ í•˜ë“¯ ì •êµí•˜ê²Œ ë‹¤ë£¨ëŠ”ì§€ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

\vspace{0.5cm}

\begin{summarybox}{ë‹¨ì› ìš”ì•½ (Cheat Sheet)}
\begin{enumerate}
    \item \textbf{Vanishing Gradient:} ì‹œí€€ìŠ¤ê°€ ê¸¸ì–´ì§€ë©´ ì´ˆê¸° ì •ë³´ê°€ ì‚¬ë¼ì§€ëŠ” ë¬¸ì œ.
    \item \textbf{Gate:} ì‹œê·¸ëª¨ì´ë“œë¥¼ ì‚¬ìš©í•´ ì •ë³´ì˜ í†µê³¼ ì—¬ë¶€(0~1)ë¥¼ ê²°ì •í•˜ëŠ” ë°¸ë¸Œ.
    \item \textbf{GRU:} Update/Reset ê²Œì´íŠ¸ë¥¼ ì‚¬ìš©í•´ ê¸°ì–µì„ ë³´ì¡´í•˜ê±°ë‚˜ ê°±ì‹ í•œë‹¤.
    \item \textbf{Key:} $\Gamma_u=0$ì¼ ë•Œ ê³¼ê±° ê¸°ì–µì´ ì†ì‹¤ ì—†ì´ ê·¸ëŒ€ë¡œ ì „ë‹¬ëœë‹¤.
\end{enumerate}
\end{summarybox}

\end{document}